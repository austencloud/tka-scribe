export class SequenceCardImageGenerationService {
  constructor(pictographService, svgCompositionService, metadataService) {
    this.pictographService = pictographService;
    this.svgCompositionService = svgCompositionService;
    this.metadataService = metadataService;
  }
  /**
   * Generate image for a single sequence
   */
  async generateSequenceImage(sequence, dimensions) {
    try {
      console.log(`üé® Generating image for sequence: ${sequence.name}`);
      if (!this.validateSequenceData(sequence)) {
        throw new Error("Invalid sequence data provided");
      }
      console.log(`üìä Rendering ${sequence.beats.length} beats...`);
      const beatSVGs = await this.renderBeats([...sequence.beats]);
      console.log("üîß Composing sequence layout...");
      const sequenceSVG = await this.svgCompositionService.createSequenceLayout(
        beatSVGs,
        dimensions
      );
      console.log("üè∑Ô∏è Adding metadata overlays...");
      const finalSVG = await this.metadataService.addMetadataOverlays(
        sequenceSVG,
        sequence,
        {
          title: sequence.name,
          author: sequence.metadata?.author,
          beatNumbers: true,
          timestamp: false,
          backgroundColor: "#ffffff"
        },
        dimensions
      );
      console.log("üñºÔ∏è Converting SVG to canvas...");
      const canvas = await this.svgToCanvas(finalSVG, dimensions);
      console.log(
        `‚úÖ Successfully generated image for sequence: ${sequence.name}`
      );
      return canvas;
    } catch (error) {
      console.error(
        `‚ùå Failed to generate image for sequence ${sequence.name}:`,
        error
      );
      return this.createErrorCanvas(
        `Failed to generate image: ${error instanceof Error ? error.message : "Unknown error"}`,
        dimensions
      );
    }
  }
  /**
   * Validate sequence data for image generation
   */
  validateSequenceData(sequence) {
    try {
      if (!sequence) {
        console.error("‚ùå Sequence data is null or undefined");
        return false;
      }
      if (!sequence.beats || !Array.isArray(sequence.beats)) {
        console.error("‚ùå Sequence beats is not an array");
        return false;
      }
      if (sequence.beats.length === 0) {
        console.error("‚ùå Sequence has no beats");
        return false;
      }
      for (let i = 0; i < sequence.beats.length; i++) {
        const beat = sequence.beats[i];
        if (!beat) {
          console.error(`‚ùå Beat ${i} is null or undefined`);
          return false;
        }
        if (!beat.blue || !beat.red) {
          console.error(`‚ùå Beat ${i} missing required motion data`);
          return false;
        }
      }
      console.log(
        `‚úÖ Sequence validation passed: ${sequence.beats.length} beats`
      );
      return true;
    } catch (error) {
      console.error("‚ùå Sequence validation failed:", error);
      return false;
    }
  }
  /**
   * Get recommended dimensions for sequence
   */
  getRecommendedDimensions(beatCount) {
    try {
      let width = 800;
      let height = 600;
      if (beatCount <= 3) {
        width = 900;
        height = 400;
      } else if (beatCount <= 6) {
        width = 800;
        height = 600;
      } else if (beatCount <= 12) {
        width = 800;
        height = 800;
      } else {
        width = 600;
        height = 1e3;
      }
      const dimensions = {
        width,
        height,
        scale: 1
      };
      console.log(
        `üìè Recommended dimensions for ${beatCount} beats:`,
        dimensions
      );
      return dimensions;
    } catch (error) {
      console.error("‚ùå Failed to calculate recommended dimensions:", error);
      return {
        width: 800,
        height: 600,
        scale: 1
      };
    }
  }
  // ============================================================================
  // PRIVATE METHODS
  // ============================================================================
  async renderBeats(beats) {
    const beatSVGs = [];
    for (let i = 0; i < beats.length; i++) {
      try {
        const beat = beats[i];
        console.log(`üéØ Rendering beat ${i + 1}/${beats.length}`);
        const beatSVGElement = await this.pictographService.renderBeat(beat);
        const beatSVG = this.svgElementToString(beatSVGElement);
        beatSVGs.push(beatSVG);
      } catch (error) {
        console.error(`‚ùå Failed to render beat ${i + 1}:`, error);
        const fallbackSVG = this.createFallbackBeatSVG(i + 1);
        beatSVGs.push(fallbackSVG);
      }
    }
    return beatSVGs;
  }
  async svgToCanvas(svgString, dimensions) {
    return new Promise((resolve, reject) => {
      try {
        const canvas = document.createElement("canvas");
        const ctx = canvas.getContext("2d");
        if (!ctx) {
          reject(new Error("Could not get 2D context"));
          return;
        }
        const scale = dimensions.scale || 1;
        canvas.width = dimensions.width * scale;
        canvas.height = dimensions.height * scale;
        const img = new Image();
        const svgBlob = new Blob([svgString], { type: "image/svg+xml" });
        const url = URL.createObjectURL(svgBlob);
        img.onload = () => {
          try {
            ctx.imageSmoothingEnabled = true;
            ctx.imageSmoothingQuality = "high";
            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
            URL.revokeObjectURL(url);
            resolve(canvas);
          } catch (error) {
            URL.revokeObjectURL(url);
            reject(new Error(`Failed to draw SVG to canvas: ${error}`));
          }
        };
        img.onerror = () => {
          URL.revokeObjectURL(url);
          reject(new Error("Failed to load SVG image"));
        };
        img.src = url;
      } catch (error) {
        reject(new Error(`SVG to Canvas conversion failed: ${error}`));
      }
    });
  }
  svgElementToString(svgElement) {
    try {
      const serializer = new XMLSerializer();
      return serializer.serializeToString(svgElement);
    } catch (error) {
      console.error("‚ùå Failed to serialize SVG element:", error);
      return this.createFallbackBeatSVG(0);
    }
  }
  createFallbackBeatSVG(beatNumber) {
    return `
      <svg width="120" height="120" xmlns="http://www.w3.org/2000/svg">
        <rect width="100%" height="100%" fill="#f5f5f5" stroke="#ddd" stroke-width="2" rx="8"/>
        <text x="60" y="60" text-anchor="middle" dominant-baseline="central" 
              font-family="sans-serif" font-size="14" fill="#666">
          Beat ${beatNumber}
        </text>
        <text x="60" y="80" text-anchor="middle" dominant-baseline="central" 
              font-family="sans-serif" font-size="10" fill="#999">
          (Error)
        </text>
      </svg>`;
  }
  createErrorCanvas(errorMessage, dimensions) {
    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");
    if (!ctx) {
      return canvas;
    }
    canvas.width = dimensions.width;
    canvas.height = dimensions.height;
    ctx.fillStyle = "#f8f9fa";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.strokeStyle = "#dee2e6";
    ctx.lineWidth = 2;
    ctx.strokeRect(1, 1, canvas.width - 2, canvas.height - 2);
    ctx.strokeStyle = "#dc3545";
    ctx.lineWidth = 4;
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
    const size = 30;
    ctx.beginPath();
    ctx.moveTo(centerX - size, centerY - size);
    ctx.lineTo(centerX + size, centerY + size);
    ctx.moveTo(centerX + size, centerY - size);
    ctx.lineTo(centerX - size, centerY + size);
    ctx.stroke();
    ctx.fillStyle = "#6c757d";
    ctx.font = "16px system-ui, sans-serif";
    ctx.textAlign = "center";
    ctx.fillText("Generation Failed", centerX, centerY + 60);
    ctx.font = "12px system-ui, sans-serif";
    const truncatedMessage = errorMessage.length > 50 ? errorMessage.substring(0, 47) + "..." : errorMessage;
    ctx.fillText(truncatedMessage, centerX, centerY + 80);
    return canvas;
  }
}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiQzovVEtBL3dlYi9zcmMvbGliL3NlcnZpY2VzL2ltcGxlbWVudGF0aW9ucy9leHBvcnQvc2VxdWVuY2UtY2FyZC9TZXF1ZW5jZUNhcmRJbWFnZUdlbmVyYXRpb25TZXJ2aWNlLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyIvKipcbiAqIFNlcXVlbmNlIENhcmQgSW1hZ2UgR2VuZXJhdGlvbiBTZXJ2aWNlXG4gKlxuICogSGFuZGxlcyBnZW5lcmF0aW9uIG9mIHNlcXVlbmNlIGNhcmQgaW1hZ2VzIGZyb20gc2VxdWVuY2UgZGF0YS5cbiAqIFNpbmdsZSByZXNwb25zaWJpbGl0eTogQ29udmVydGluZyBzZXF1ZW5jZSBkYXRhIHRvIGltYWdlcyB2aWEgU1ZHIGNvbXBvc2l0aW9uLlxuICovXG5cbmltcG9ydCB0eXBlIHsgQmVhdERhdGEsIFNlcXVlbmNlRGF0YSB9IGZyb20gXCIuLi8uLi8uLi9pbnRlcmZhY2VzL2RvbWFpbi10eXBlc1wiO1xuaW1wb3J0IHR5cGUgeyBJUGljdG9ncmFwaFJlbmRlcmluZ1NlcnZpY2UgfSBmcm9tIFwiLi4vLi4vLi4vaW50ZXJmYWNlcy9waWN0b2dyYXBoLWludGVyZmFjZXNcIjtcbmltcG9ydCB0eXBlIHtcbiAgSVNlcXVlbmNlQ2FyZEltYWdlR2VuZXJhdGlvblNlcnZpY2UsXG4gIElTZXF1ZW5jZUNhcmRNZXRhZGF0YU92ZXJsYXlTZXJ2aWNlLFxuICBJU2VxdWVuY2VDYXJkU1ZHQ29tcG9zaXRpb25TZXJ2aWNlLFxuICBTZXF1ZW5jZUNhcmREaW1lbnNpb25zLFxufSBmcm9tIFwiLi4vLi4vLi4vaW50ZXJmYWNlcy9zZXF1ZW5jZS1jYXJkLWV4cG9ydC1pbnRlcmZhY2VzXCI7XG5cbmV4cG9ydCBjbGFzcyBTZXF1ZW5jZUNhcmRJbWFnZUdlbmVyYXRpb25TZXJ2aWNlXG4gIGltcGxlbWVudHMgSVNlcXVlbmNlQ2FyZEltYWdlR2VuZXJhdGlvblNlcnZpY2VcbntcbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSByZWFkb25seSBwaWN0b2dyYXBoU2VydmljZTogSVBpY3RvZ3JhcGhSZW5kZXJpbmdTZXJ2aWNlLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgc3ZnQ29tcG9zaXRpb25TZXJ2aWNlOiBJU2VxdWVuY2VDYXJkU1ZHQ29tcG9zaXRpb25TZXJ2aWNlLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgbWV0YWRhdGFTZXJ2aWNlOiBJU2VxdWVuY2VDYXJkTWV0YWRhdGFPdmVybGF5U2VydmljZVxuICApIHt9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGltYWdlIGZvciBhIHNpbmdsZSBzZXF1ZW5jZVxuICAgKi9cbiAgYXN5bmMgZ2VuZXJhdGVTZXF1ZW5jZUltYWdlKFxuICAgIHNlcXVlbmNlOiBTZXF1ZW5jZURhdGEsXG4gICAgZGltZW5zaW9uczogU2VxdWVuY2VDYXJkRGltZW5zaW9uc1xuICApOiBQcm9taXNlPEhUTUxDYW52YXNFbGVtZW50PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKGDwn46oIEdlbmVyYXRpbmcgaW1hZ2UgZm9yIHNlcXVlbmNlOiAke3NlcXVlbmNlLm5hbWV9YCk7XG5cbiAgICAgIC8vIFZhbGlkYXRlIHNlcXVlbmNlIGRhdGFcbiAgICAgIGlmICghdGhpcy52YWxpZGF0ZVNlcXVlbmNlRGF0YShzZXF1ZW5jZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBzZXF1ZW5jZSBkYXRhIHByb3ZpZGVkXCIpO1xuICAgICAgfVxuXG4gICAgICAvLyBTdGVwIDE6IEdlbmVyYXRlIFNWRyBmb3IgZWFjaCBiZWF0XG4gICAgICBjb25zb2xlLmxvZyhg8J+TiiBSZW5kZXJpbmcgJHtzZXF1ZW5jZS5iZWF0cy5sZW5ndGh9IGJlYXRzLi4uYCk7XG4gICAgICBjb25zdCBiZWF0U1ZHcyA9IGF3YWl0IHRoaXMucmVuZGVyQmVhdHMoWy4uLnNlcXVlbmNlLmJlYXRzXSk7XG5cbiAgICAgIC8vIFN0ZXAgMjogQ29tcG9zZSBiZWF0cyBpbnRvIHNlcXVlbmNlIGxheW91dFxuICAgICAgY29uc29sZS5sb2coXCLwn5SnIENvbXBvc2luZyBzZXF1ZW5jZSBsYXlvdXQuLi5cIik7XG4gICAgICBjb25zdCBzZXF1ZW5jZVNWRyA9IGF3YWl0IHRoaXMuc3ZnQ29tcG9zaXRpb25TZXJ2aWNlLmNyZWF0ZVNlcXVlbmNlTGF5b3V0KFxuICAgICAgICBiZWF0U1ZHcyxcbiAgICAgICAgZGltZW5zaW9uc1xuICAgICAgKTtcblxuICAgICAgLy8gU3RlcCAzOiBBZGQgbWV0YWRhdGEgb3ZlcmxheXNcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+Pt++4jyBBZGRpbmcgbWV0YWRhdGEgb3ZlcmxheXMuLi5cIik7XG4gICAgICBjb25zdCBmaW5hbFNWRyA9IGF3YWl0IHRoaXMubWV0YWRhdGFTZXJ2aWNlLmFkZE1ldGFkYXRhT3ZlcmxheXMoXG4gICAgICAgIHNlcXVlbmNlU1ZHLFxuICAgICAgICBzZXF1ZW5jZSxcbiAgICAgICAge1xuICAgICAgICAgIHRpdGxlOiBzZXF1ZW5jZS5uYW1lLFxuICAgICAgICAgIGF1dGhvcjogc2VxdWVuY2UubWV0YWRhdGE/LmF1dGhvciBhcyBzdHJpbmcsXG4gICAgICAgICAgYmVhdE51bWJlcnM6IHRydWUsXG4gICAgICAgICAgdGltZXN0YW1wOiBmYWxzZSxcbiAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwiI2ZmZmZmZlwiLFxuICAgICAgICB9LFxuICAgICAgICBkaW1lbnNpb25zXG4gICAgICApO1xuXG4gICAgICAvLyBTdGVwIDQ6IENvbnZlcnQgU1ZHIHRvIENhbnZhc1xuICAgICAgY29uc29sZS5sb2coXCLwn5a877iPIENvbnZlcnRpbmcgU1ZHIHRvIGNhbnZhcy4uLlwiKTtcbiAgICAgIGNvbnN0IGNhbnZhcyA9IGF3YWl0IHRoaXMuc3ZnVG9DYW52YXMoZmluYWxTVkcsIGRpbWVuc2lvbnMpO1xuXG4gICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgYOKchSBTdWNjZXNzZnVsbHkgZ2VuZXJhdGVkIGltYWdlIGZvciBzZXF1ZW5jZTogJHtzZXF1ZW5jZS5uYW1lfWBcbiAgICAgICk7XG4gICAgICByZXR1cm4gY2FudmFzO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFxuICAgICAgICBg4p2MIEZhaWxlZCB0byBnZW5lcmF0ZSBpbWFnZSBmb3Igc2VxdWVuY2UgJHtzZXF1ZW5jZS5uYW1lfTpgLFxuICAgICAgICBlcnJvclxuICAgICAgKTtcblxuICAgICAgLy8gUmV0dXJuIGZhbGxiYWNrIGNhbnZhcyB3aXRoIGVycm9yIG1lc3NhZ2VcbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUVycm9yQ2FudmFzKFxuICAgICAgICBgRmFpbGVkIHRvIGdlbmVyYXRlIGltYWdlOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCJ9YCxcbiAgICAgICAgZGltZW5zaW9uc1xuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgc2VxdWVuY2UgZGF0YSBmb3IgaW1hZ2UgZ2VuZXJhdGlvblxuICAgKi9cbiAgdmFsaWRhdGVTZXF1ZW5jZURhdGEoc2VxdWVuY2U6IFNlcXVlbmNlRGF0YSk6IGJvb2xlYW4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBDaGVjayBiYXNpYyBzdHJ1Y3R1cmVcbiAgICAgIGlmICghc2VxdWVuY2UpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBTZXF1ZW5jZSBkYXRhIGlzIG51bGwgb3IgdW5kZWZpbmVkXCIpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGlmICghc2VxdWVuY2UuYmVhdHMgfHwgIUFycmF5LmlzQXJyYXkoc2VxdWVuY2UuYmVhdHMpKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgU2VxdWVuY2UgYmVhdHMgaXMgbm90IGFuIGFycmF5XCIpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGlmIChzZXF1ZW5jZS5iZWF0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBTZXF1ZW5jZSBoYXMgbm8gYmVhdHNcIik7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgZWFjaCBiZWF0IGhhcyByZXF1aXJlZCBkYXRhXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlcXVlbmNlLmJlYXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGJlYXQgPSBzZXF1ZW5jZS5iZWF0c1tpXTtcbiAgICAgICAgaWYgKCFiZWF0KSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihg4p2MIEJlYXQgJHtpfSBpcyBudWxsIG9yIHVuZGVmaW5lZGApO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJhc2ljIGJlYXQgdmFsaWRhdGlvbiAtIGFkanVzdCBiYXNlZCBvbiB5b3VyIEJlYXREYXRhIHN0cnVjdHVyZVxuICAgICAgICBpZiAoIWJlYXQuYmx1ZSB8fCAhYmVhdC5yZWQpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGDinYwgQmVhdCAke2l9IG1pc3NpbmcgcmVxdWlyZWQgbW90aW9uIGRhdGFgKTtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIGDinIUgU2VxdWVuY2UgdmFsaWRhdGlvbiBwYXNzZWQ6ICR7c2VxdWVuY2UuYmVhdHMubGVuZ3RofSBiZWF0c2BcbiAgICAgICk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBTZXF1ZW5jZSB2YWxpZGF0aW9uIGZhaWxlZDpcIiwgZXJyb3IpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgcmVjb21tZW5kZWQgZGltZW5zaW9ucyBmb3Igc2VxdWVuY2VcbiAgICovXG4gIGdldFJlY29tbWVuZGVkRGltZW5zaW9ucyhiZWF0Q291bnQ6IG51bWJlcik6IFNlcXVlbmNlQ2FyZERpbWVuc2lvbnMge1xuICAgIHRyeSB7XG4gICAgICAvLyBCYXNlIGRpbWVuc2lvbnNcbiAgICAgIGxldCB3aWR0aCA9IDgwMDtcbiAgICAgIGxldCBoZWlnaHQgPSA2MDA7XG5cbiAgICAgIC8vIEFkanVzdCBiYXNlZCBvbiBiZWF0IGNvdW50XG4gICAgICBpZiAoYmVhdENvdW50IDw9IDMpIHtcbiAgICAgICAgLy8gV2lkZSBmb3JtYXQgZm9yIGZldyBiZWF0c1xuICAgICAgICB3aWR0aCA9IDkwMDtcbiAgICAgICAgaGVpZ2h0ID0gNDAwO1xuICAgICAgfSBlbHNlIGlmIChiZWF0Q291bnQgPD0gNikge1xuICAgICAgICAvLyBTdGFuZGFyZCBmb3JtYXRcbiAgICAgICAgd2lkdGggPSA4MDA7XG4gICAgICAgIGhlaWdodCA9IDYwMDtcbiAgICAgIH0gZWxzZSBpZiAoYmVhdENvdW50IDw9IDEyKSB7XG4gICAgICAgIC8vIFNxdWFyZSBmb3JtYXQgZm9yIG1hbnkgYmVhdHNcbiAgICAgICAgd2lkdGggPSA4MDA7XG4gICAgICAgIGhlaWdodCA9IDgwMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFRhbGwgZm9ybWF0IGZvciBsb3RzIG9mIGJlYXRzXG4gICAgICAgIHdpZHRoID0gNjAwO1xuICAgICAgICBoZWlnaHQgPSAxMDAwO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkaW1lbnNpb25zOiBTZXF1ZW5jZUNhcmREaW1lbnNpb25zID0ge1xuICAgICAgICB3aWR0aCxcbiAgICAgICAgaGVpZ2h0LFxuICAgICAgICBzY2FsZTogMSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICBg8J+TjyBSZWNvbW1lbmRlZCBkaW1lbnNpb25zIGZvciAke2JlYXRDb3VudH0gYmVhdHM6YCxcbiAgICAgICAgZGltZW5zaW9uc1xuICAgICAgKTtcbiAgICAgIHJldHVybiBkaW1lbnNpb25zO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwi4p2MIEZhaWxlZCB0byBjYWxjdWxhdGUgcmVjb21tZW5kZWQgZGltZW5zaW9uczpcIiwgZXJyb3IpO1xuXG4gICAgICAvLyBGYWxsYmFjayBkaW1lbnNpb25zXG4gICAgICByZXR1cm4ge1xuICAgICAgICB3aWR0aDogODAwLFxuICAgICAgICBoZWlnaHQ6IDYwMCxcbiAgICAgICAgc2NhbGU6IDEsXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gUFJJVkFURSBNRVRIT0RTXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBwcml2YXRlIGFzeW5jIHJlbmRlckJlYXRzKGJlYXRzOiBCZWF0RGF0YVtdKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgIGNvbnN0IGJlYXRTVkdzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiZWF0cy5sZW5ndGg7IGkrKykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgYmVhdCA9IGJlYXRzW2ldO1xuICAgICAgICBjb25zb2xlLmxvZyhg8J+OryBSZW5kZXJpbmcgYmVhdCAke2kgKyAxfS8ke2JlYXRzLmxlbmd0aH1gKTtcblxuICAgICAgICAvLyBVc2UgcGljdG9ncmFwaCBzZXJ2aWNlIHRvIHJlbmRlciB0aGUgYmVhdFxuICAgICAgICBjb25zdCBiZWF0U1ZHRWxlbWVudCA9IGF3YWl0IHRoaXMucGljdG9ncmFwaFNlcnZpY2UucmVuZGVyQmVhdChiZWF0KTtcbiAgICAgICAgY29uc3QgYmVhdFNWRyA9IHRoaXMuc3ZnRWxlbWVudFRvU3RyaW5nKGJlYXRTVkdFbGVtZW50KTtcbiAgICAgICAgYmVhdFNWR3MucHVzaChiZWF0U1ZHKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBGYWlsZWQgdG8gcmVuZGVyIGJlYXQgJHtpICsgMX06YCwgZXJyb3IpO1xuXG4gICAgICAgIC8vIENyZWF0ZSBmYWxsYmFjayBTVkcgZm9yIGZhaWxlZCBiZWF0XG4gICAgICAgIGNvbnN0IGZhbGxiYWNrU1ZHID0gdGhpcy5jcmVhdGVGYWxsYmFja0JlYXRTVkcoaSArIDEpO1xuICAgICAgICBiZWF0U1ZHcy5wdXNoKGZhbGxiYWNrU1ZHKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gYmVhdFNWR3M7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHN2Z1RvQ2FudmFzKFxuICAgIHN2Z1N0cmluZzogc3RyaW5nLFxuICAgIGRpbWVuc2lvbnM6IFNlcXVlbmNlQ2FyZERpbWVuc2lvbnNcbiAgKTogUHJvbWlzZTxIVE1MQ2FudmFzRWxlbWVudD4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xuICAgICAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xuXG4gICAgICAgIGlmICghY3R4KSB7XG4gICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihcIkNvdWxkIG5vdCBnZXQgMkQgY29udGV4dFwiKSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc2NhbGUgPSBkaW1lbnNpb25zLnNjYWxlIHx8IDE7XG4gICAgICAgIGNhbnZhcy53aWR0aCA9IGRpbWVuc2lvbnMud2lkdGggKiBzY2FsZTtcbiAgICAgICAgY2FudmFzLmhlaWdodCA9IGRpbWVuc2lvbnMuaGVpZ2h0ICogc2NhbGU7XG5cbiAgICAgICAgLy8gQ3JlYXRlIGltYWdlIGZyb20gU1ZHXG4gICAgICAgIGNvbnN0IGltZyA9IG5ldyBJbWFnZSgpO1xuICAgICAgICBjb25zdCBzdmdCbG9iID0gbmV3IEJsb2IoW3N2Z1N0cmluZ10sIHsgdHlwZTogXCJpbWFnZS9zdmcreG1sXCIgfSk7XG4gICAgICAgIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoc3ZnQmxvYik7XG5cbiAgICAgICAgaW1nLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gSGlnaCBxdWFsaXR5IHJlbmRlcmluZ1xuICAgICAgICAgICAgY3R4LmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICBjdHguaW1hZ2VTbW9vdGhpbmdRdWFsaXR5ID0gXCJoaWdoXCI7XG5cbiAgICAgICAgICAgIC8vIERyYXcgdG8gY2FudmFzXG4gICAgICAgICAgICBjdHguZHJhd0ltYWdlKGltZywgMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcblxuICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTCh1cmwpO1xuICAgICAgICAgICAgcmVzb2x2ZShjYW52YXMpO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKGBGYWlsZWQgdG8gZHJhdyBTVkcgdG8gY2FudmFzOiAke2Vycm9yfWApKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgaW1nLm9uZXJyb3IgPSAoKSA9PiB7XG4gICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTCh1cmwpO1xuICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoXCJGYWlsZWQgdG8gbG9hZCBTVkcgaW1hZ2VcIikpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGltZy5zcmMgPSB1cmw7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZWplY3QobmV3IEVycm9yKGBTVkcgdG8gQ2FudmFzIGNvbnZlcnNpb24gZmFpbGVkOiAke2Vycm9yfWApKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgc3ZnRWxlbWVudFRvU3RyaW5nKHN2Z0VsZW1lbnQ6IFNWR0VsZW1lbnQpOiBzdHJpbmcge1xuICAgIHRyeSB7XG4gICAgICAvLyBDcmVhdGUgYSB0ZW1wb3JhcnkgY29udGFpbmVyXG4gICAgICBjb25zdCBzZXJpYWxpemVyID0gbmV3IFhNTFNlcmlhbGl6ZXIoKTtcbiAgICAgIHJldHVybiBzZXJpYWxpemVyLnNlcmlhbGl6ZVRvU3RyaW5nKHN2Z0VsZW1lbnQpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwi4p2MIEZhaWxlZCB0byBzZXJpYWxpemUgU1ZHIGVsZW1lbnQ6XCIsIGVycm9yKTtcbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUZhbGxiYWNrQmVhdFNWRygwKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGNyZWF0ZUZhbGxiYWNrQmVhdFNWRyhiZWF0TnVtYmVyOiBudW1iZXIpOiBzdHJpbmcge1xuICAgIHJldHVybiBgXG4gICAgICA8c3ZnIHdpZHRoPVwiMTIwXCIgaGVpZ2h0PVwiMTIwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPlxuICAgICAgICA8cmVjdCB3aWR0aD1cIjEwMCVcIiBoZWlnaHQ9XCIxMDAlXCIgZmlsbD1cIiNmNWY1ZjVcIiBzdHJva2U9XCIjZGRkXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHJ4PVwiOFwiLz5cbiAgICAgICAgPHRleHQgeD1cIjYwXCIgeT1cIjYwXCIgdGV4dC1hbmNob3I9XCJtaWRkbGVcIiBkb21pbmFudC1iYXNlbGluZT1cImNlbnRyYWxcIiBcbiAgICAgICAgICAgICAgZm9udC1mYW1pbHk9XCJzYW5zLXNlcmlmXCIgZm9udC1zaXplPVwiMTRcIiBmaWxsPVwiIzY2NlwiPlxuICAgICAgICAgIEJlYXQgJHtiZWF0TnVtYmVyfVxuICAgICAgICA8L3RleHQ+XG4gICAgICAgIDx0ZXh0IHg9XCI2MFwiIHk9XCI4MFwiIHRleHQtYW5jaG9yPVwibWlkZGxlXCIgZG9taW5hbnQtYmFzZWxpbmU9XCJjZW50cmFsXCIgXG4gICAgICAgICAgICAgIGZvbnQtZmFtaWx5PVwic2Fucy1zZXJpZlwiIGZvbnQtc2l6ZT1cIjEwXCIgZmlsbD1cIiM5OTlcIj5cbiAgICAgICAgICAoRXJyb3IpXG4gICAgICAgIDwvdGV4dD5cbiAgICAgIDwvc3ZnPmA7XG4gIH1cblxuICBwcml2YXRlIGNyZWF0ZUVycm9yQ2FudmFzKFxuICAgIGVycm9yTWVzc2FnZTogc3RyaW5nLFxuICAgIGRpbWVuc2lvbnM6IFNlcXVlbmNlQ2FyZERpbWVuc2lvbnNcbiAgKTogSFRNTENhbnZhc0VsZW1lbnQge1xuICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG4gICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcblxuICAgIGlmICghY3R4KSB7XG4gICAgICByZXR1cm4gY2FudmFzO1xuICAgIH1cblxuICAgIGNhbnZhcy53aWR0aCA9IGRpbWVuc2lvbnMud2lkdGg7XG4gICAgY2FudmFzLmhlaWdodCA9IGRpbWVuc2lvbnMuaGVpZ2h0O1xuXG4gICAgLy8gRHJhdyBlcnJvciBzdGF0ZVxuICAgIGN0eC5maWxsU3R5bGUgPSBcIiNmOGY5ZmFcIjtcbiAgICBjdHguZmlsbFJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcblxuICAgIC8vIEJvcmRlclxuICAgIGN0eC5zdHJva2VTdHlsZSA9IFwiI2RlZTJlNlwiO1xuICAgIGN0eC5saW5lV2lkdGggPSAyO1xuICAgIGN0eC5zdHJva2VSZWN0KDEsIDEsIGNhbnZhcy53aWR0aCAtIDIsIGNhbnZhcy5oZWlnaHQgLSAyKTtcblxuICAgIC8vIEVycm9yIGljb24gKHNpbXBsZSBYKVxuICAgIGN0eC5zdHJva2VTdHlsZSA9IFwiI2RjMzU0NVwiO1xuICAgIGN0eC5saW5lV2lkdGggPSA0O1xuICAgIGNvbnN0IGNlbnRlclggPSBjYW52YXMud2lkdGggLyAyO1xuICAgIGNvbnN0IGNlbnRlclkgPSBjYW52YXMuaGVpZ2h0IC8gMjtcbiAgICBjb25zdCBzaXplID0gMzA7XG5cbiAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgY3R4Lm1vdmVUbyhjZW50ZXJYIC0gc2l6ZSwgY2VudGVyWSAtIHNpemUpO1xuICAgIGN0eC5saW5lVG8oY2VudGVyWCArIHNpemUsIGNlbnRlclkgKyBzaXplKTtcbiAgICBjdHgubW92ZVRvKGNlbnRlclggKyBzaXplLCBjZW50ZXJZIC0gc2l6ZSk7XG4gICAgY3R4LmxpbmVUbyhjZW50ZXJYIC0gc2l6ZSwgY2VudGVyWSArIHNpemUpO1xuICAgIGN0eC5zdHJva2UoKTtcblxuICAgIC8vIEVycm9yIHRleHRcbiAgICBjdHguZmlsbFN0eWxlID0gXCIjNmM3NTdkXCI7XG4gICAgY3R4LmZvbnQgPSBcIjE2cHggc3lzdGVtLXVpLCBzYW5zLXNlcmlmXCI7XG4gICAgY3R4LnRleHRBbGlnbiA9IFwiY2VudGVyXCI7XG4gICAgY3R4LmZpbGxUZXh0KFwiR2VuZXJhdGlvbiBGYWlsZWRcIiwgY2VudGVyWCwgY2VudGVyWSArIDYwKTtcblxuICAgIC8vIEVycm9yIG1lc3NhZ2UgKHRydW5jYXRlZCBpZiB0b28gbG9uZylcbiAgICBjdHguZm9udCA9IFwiMTJweCBzeXN0ZW0tdWksIHNhbnMtc2VyaWZcIjtcbiAgICBjb25zdCB0cnVuY2F0ZWRNZXNzYWdlID1cbiAgICAgIGVycm9yTWVzc2FnZS5sZW5ndGggPiA1MFxuICAgICAgICA/IGVycm9yTWVzc2FnZS5zdWJzdHJpbmcoMCwgNDcpICsgXCIuLi5cIlxuICAgICAgICA6IGVycm9yTWVzc2FnZTtcbiAgICBjdHguZmlsbFRleHQodHJ1bmNhdGVkTWVzc2FnZSwgY2VudGVyWCwgY2VudGVyWSArIDgwKTtcblxuICAgIHJldHVybiBjYW52YXM7XG4gIH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICJBQWdCTyxhQUFNLG1DQUViO0FBQUEsRUFDRSxZQUNtQixtQkFDQSx1QkFDQSxpQkFDakI7QUFIaUI7QUFDQTtBQUNBO0FBQUEsRUFDaEI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtILE1BQU0sc0JBQ0osVUFDQSxZQUM0QjtBQUM1QixRQUFJO0FBQ0YsY0FBUSxJQUFJLHFDQUFxQyxTQUFTLElBQUksRUFBRTtBQUdoRSxVQUFJLENBQUMsS0FBSyxxQkFBcUIsUUFBUSxHQUFHO0FBQ3hDLGNBQU0sSUFBSSxNQUFNLGdDQUFnQztBQUFBLE1BQ2xEO0FBR0EsY0FBUSxJQUFJLGdCQUFnQixTQUFTLE1BQU0sTUFBTSxXQUFXO0FBQzVELFlBQU0sV0FBVyxNQUFNLEtBQUssWUFBWSxDQUFDLEdBQUcsU0FBUyxLQUFLLENBQUM7QUFHM0QsY0FBUSxJQUFJLGlDQUFpQztBQUM3QyxZQUFNLGNBQWMsTUFBTSxLQUFLLHNCQUFzQjtBQUFBLFFBQ25EO0FBQUEsUUFDQTtBQUFBLE1BQ0Y7QUFHQSxjQUFRLElBQUksaUNBQWlDO0FBQzdDLFlBQU0sV0FBVyxNQUFNLEtBQUssZ0JBQWdCO0FBQUEsUUFDMUM7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFVBQ0UsT0FBTyxTQUFTO0FBQUEsVUFDaEIsUUFBUSxTQUFTLFVBQVU7QUFBQSxVQUMzQixhQUFhO0FBQUEsVUFDYixXQUFXO0FBQUEsVUFDWCxpQkFBaUI7QUFBQSxRQUNuQjtBQUFBLFFBQ0E7QUFBQSxNQUNGO0FBR0EsY0FBUSxJQUFJLGlDQUFpQztBQUM3QyxZQUFNLFNBQVMsTUFBTSxLQUFLLFlBQVksVUFBVSxVQUFVO0FBRTFELGNBQVE7QUFBQSxRQUNOLGdEQUFnRCxTQUFTLElBQUk7QUFBQSxNQUMvRDtBQUNBLGFBQU87QUFBQSxJQUNULFNBQVMsT0FBTztBQUNkLGNBQVE7QUFBQSxRQUNOLDJD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
