import { GridMode } from "/src/lib/domain/enums.ts";
export class ConstructTabCoordinationService {
  constructor(sequenceService, startPositionService, workbenchBeatOperations) {
    this.sequenceService = sequenceService;
    this.startPositionService = startPositionService;
    this.workbenchBeatOperations = workbenchBeatOperations;
  }
  components = {};
  isHandlingSequenceModification = false;
  eventListenersSetup = false;
  boundEventHandlers = null;
  /**
   * Clean up resources when service is destroyed
   */
  destroy() {
    this.disconnectComponentSignals();
    this.components = {};
  }
  setupComponentCoordination(components) {
    this.components = components;
    if (!this.eventListenersSetup) {
      this.connectComponentSignals();
      this.eventListenersSetup = true;
    }
  }
  async handleSequenceModified(sequence) {
    if (this.isHandlingSequenceModification) {
      return;
    }
    try {
      this.isHandlingSequenceModification = true;
      await this.updateUIBasedOnSequence(sequence);
      this.notifyComponents("sequence_modified", { sequence });
    } catch (error) {
      console.error("❌ Error handling sequence modification:", error);
    } finally {
      this.isHandlingSequenceModification = false;
    }
  }
  async handleStartPositionSet(startPosition) {
    try {
      await this.startPositionService.setStartPosition(startPosition);
      const newSequence = await this.sequenceService.createSequence({
        name: `Sequence ${(/* @__PURE__ */ new Date()).toLocaleTimeString()}`,
        length: 0,
        // Start with 0 beats - beats will be added progressively
        gridMode: GridMode.DIAMOND,
        // Default grid mode
        propType: "staff"
        // Default prop type
      });
      const updatedSequence = await this.workbenchBeatOperations.setConstructionStartPosition(
        newSequence.id,
        startPosition
      );
      if (updatedSequence) {
        this.notifyComponents("sequenceCreated", {
          sequence: updatedSequence,
          startPosition
        });
      } else {
        console.error("❌ Failed to reload updated sequence");
        return;
      }
      this.notifyComponents("start_position_set", { startPosition });
      this.notifyComponents("ui_state_update_requested", {
        action: "hide_start_position_picker"
      });
      await this.handleUITransitionRequest("option_picker");
    } catch (error) {
      console.error("❌ Error handling start position set:", error);
    }
  }
  async handleBeatAdded(beatData) {
    try {
      const currentSequence = null;
      if (!currentSequence) {
        console.error("❌ No current sequence available for adding beat");
        return;
      }
      this.notifyComponents("beat_added", { beatData });
    } catch (error) {
      console.error("❌ Error handling beat added:", error);
    }
  }
  async handleGenerationRequest(config) {
    try {
      this.notifyComponents("generation_requested", { config });
      setTimeout(() => {
        this.notifyComponents("generation_completed", {
          success: true,
          message: "Generation completed"
        });
      }, 1e3);
    } catch (error) {
      console.error("❌ Error handling generation request:", error);
    }
  }
  async handleUITransitionRequest(targetPanel) {
    try {
      const transitionEvent = new CustomEvent("construct-tab-transition", {
        detail: { targetPanel },
        bubbles: true
      });
      if (typeof window !== "undefined") {
        document.dispatchEvent(transitionEvent);
      }
      this.notifyComponents("ui_transition", { targetPanel });
    } catch (error) {
      console.error("❌ Error handling UI transition:", error);
    }
  }
  connectComponentSignals() {
    if (typeof window !== "undefined") {
      this.boundEventHandlers = {
        startPositionSelected: (event) => {
          this.handleStartPositionSet(event.detail.startPosition);
        },
        optionSelected: (event) => {
          this.handleBeatAdded(event.detail.beatData);
        },
        sequenceModified: (event) => {
          this.handleSequenceModified(event.detail.sequence);
        }
      };
      document.addEventListener(
        "start-position-selected",
        this.boundEventHandlers.startPositionSelected
      );
      document.addEventListener(
        "option-selected",
        this.boundEventHandlers.optionSelected
      );
      document.addEventListener(
        "sequence-modified",
        this.boundEventHandlers.sequenceModified
      );
    }
  }
  /**
   * Clean up event listeners to prevent memory leaks and duplicate handlers
   */
  disconnectComponentSignals() {
    if (typeof window !== "undefined" && this.boundEventHandlers) {
      document.removeEventListener(
        "start-position-selected",
        this.boundEventHandlers.startPositionSelected
      );
      document.removeEventListener(
        "option-selected",
        this.boundEventHandlers.optionSelected
      );
      document.removeEventListener(
        "sequence-modified",
        this.boundEventHandlers.sequenceModified
      );
      this.boundEventHandlers = null;
      this.eventListenersSetup = false;
    }
  }
  async updateUIBasedOnSequence(sequence) {
    try {
      const hasStartPosition = sequence?.startingPositionBeat != null;
      const hasBeats = sequence && sequence.beats && sequence.beats.length > 0;
      let targetPanel;
      if (hasStartPosition || hasBeats) {
        targetPanel = "option_picker";
      } else {
        targetPanel = "start_position_picker";
      }
      await this.handleUITransitionRequest(targetPanel);
    } catch (error) {
      console.error("❌ Error updating UI based on sequence:", error);
    }
  }
  hasStartPosition(sequence) {
    return sequence?.startingPositionBeat != null;
  }
  notifyComponents(eventType, data) {
    Object.entries(this.components).forEach(([name, component]) => {
      if (component && typeof component.handleEvent === "function") {
        try {
          component.handleEvent(eventType, data);
        } catch (error) {
          console.error(`❌ Error notifying component ${name}:`, error);
        }
      }
    });
    if (typeof window !== "undefined") {
      const event = new CustomEvent(`construct-coordination-${eventType}`, {
        detail: data,
        bubbles: true
      });
      document.dispatchEvent(event);
    }
  }
}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiQzovVEtBL3dlYi9zcmMvbGliL3NlcnZpY2VzL2ltcGxlbWVudGF0aW9ucy9jb25zdHJ1Y3QvQ29uc3RydWN0VGFiQ29vcmRpbmF0aW9uU2VydmljZS50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiLyoqXG4gKiBDb25zdHJ1Y3QgVGFiIENvb3JkaW5hdGlvbiBTZXJ2aWNlIC0gSW1wbGVtZW50YXRpb25cbiAqXG4gKiBDb29yZGluYXRlcyBiZXR3ZWVuIGNvbnN0cnVjdCB0YWIgY29tcG9uZW50cyAoc3RhcnQgcG9zaXRpb24gcGlja2VyLCBvcHRpb24gcGlja2VyLCB3b3JrYmVuY2gpLlxuICogQmFzZWQgb24gZGVza3RvcCBDb25zdHJ1Y3RUYWJDb29yZGluYXRpb25TZXJ2aWNlIGJ1dCBzaW1wbGlmaWVkIGZvciB3ZWIgd2l0aCBydW5lcy5cbiAqXG4gKiBGSVhFRDogQWRkZWQgcHJvcGVyIHN0YXRlIHN5bmNocm9uaXphdGlvbiB0byByZXNvbHZlIHN0YXJ0IHBvc2l0aW9uIHNlbGVjdGlvbiBnZXR0aW5nIHN0dWNrXG4gKi9cblxuaW1wb3J0IHsgR3JpZE1vZGUgfSBmcm9tIFwiJGxpYi9kb21haW4vZW51bXNcIjtcbmltcG9ydCB0eXBlIHtcbiAgSUNvbnN0cnVjdFRhYkNvb3JkaW5hdGlvblNlcnZpY2UsXG4gIElTdGFydFBvc2l0aW9uU2VydmljZSxcbn0gZnJvbSBcIi4uLy4uL2ludGVyZmFjZXMvYXBwbGljYXRpb24taW50ZXJmYWNlc1wiO1xuaW1wb3J0IHR5cGUgeyBCZWF0RGF0YSwgU2VxdWVuY2VEYXRhIH0gZnJvbSBcIi4uLy4uL2ludGVyZmFjZXMvZG9tYWluLXR5cGVzXCI7XG5pbXBvcnQgdHlwZSB7XG4gIElTZXF1ZW5jZVNlcnZpY2UsXG4gIElXb3JrYmVuY2hCZWF0T3BlcmF0aW9uc1NlcnZpY2UsXG59IGZyb20gXCIuLi8uLi9pbnRlcmZhY2VzL3NlcXVlbmNlLWludGVyZmFjZXNcIjtcblxuLy8gTm90ZTogVGhpcyBzZXJ2aWNlIHdpbGwgbmVlZCB0byBiZSB1cGRhdGVkIHRvIHVzZSB0aGUgbmV3IERJIHBhdHRlcm5cbi8vIEZvciBub3csIHdlJ2xsIGNvbW1lbnQgb3V0IHRoZSBkaXJlY3QgaW1wb3J0IHRvIGF2b2lkIGJ1aWxkIGVycm9yc1xuLy8gaW1wb3J0IHsgc2VxdWVuY2VTdGF0ZVNlcnZpY2UgfSBmcm9tIFwiLi4vLi4vU2VxdWVuY2VTdGF0ZVNlcnZpY2Uuc3ZlbHRlXCI7XG5cbmludGVyZmFjZSBDb21wb25lbnRXaXRoRXZlbnRIYW5kbGVyIHtcbiAgaGFuZGxlRXZlbnQ/OiAoZXZlbnRUeXBlOiBzdHJpbmcsIGRhdGE6IHVua25vd24pID0+IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBDb25zdHJ1Y3RUYWJDb29yZGluYXRpb25TZXJ2aWNlXG4gIGltcGxlbWVudHMgSUNvbnN0cnVjdFRhYkNvb3JkaW5hdGlvblNlcnZpY2VcbntcbiAgcHJpdmF0ZSBjb21wb25lbnRzOiBSZWNvcmQ8c3RyaW5nLCBDb21wb25lbnRXaXRoRXZlbnRIYW5kbGVyPiA9IHt9O1xuICBwcml2YXRlIGlzSGFuZGxpbmdTZXF1ZW5jZU1vZGlmaWNhdGlvbiA9IGZhbHNlO1xuICBwcml2YXRlIGV2ZW50TGlzdGVuZXJzU2V0dXAgPSBmYWxzZTtcbiAgcHJpdmF0ZSBib3VuZEV2ZW50SGFuZGxlcnM6IHtcbiAgICBzdGFydFBvc2l0aW9uU2VsZWN0ZWQ6IChldmVudDogQ3VzdG9tRXZlbnQpID0+IHZvaWQ7XG4gICAgb3B0aW9uU2VsZWN0ZWQ6IChldmVudDogQ3VzdG9tRXZlbnQpID0+IHZvaWQ7XG4gICAgc2VxdWVuY2VNb2RpZmllZDogKGV2ZW50OiBDdXN0b21FdmVudCkgPT4gdm9pZDtcbiAgfSB8IG51bGwgPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgc2VxdWVuY2VTZXJ2aWNlOiBJU2VxdWVuY2VTZXJ2aWNlLFxuICAgIHByaXZhdGUgc3RhcnRQb3NpdGlvblNlcnZpY2U6IElTdGFydFBvc2l0aW9uU2VydmljZSxcbiAgICBwcml2YXRlIHdvcmtiZW5jaEJlYXRPcGVyYXRpb25zOiBJV29ya2JlbmNoQmVhdE9wZXJhdGlvbnNTZXJ2aWNlXG4gICkge31cblxuICAvKipcbiAgICogQ2xlYW4gdXAgcmVzb3VyY2VzIHdoZW4gc2VydmljZSBpcyBkZXN0cm95ZWRcbiAgICovXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy5kaXNjb25uZWN0Q29tcG9uZW50U2lnbmFscygpO1xuICAgIHRoaXMuY29tcG9uZW50cyA9IHt9O1xuICB9XG5cbiAgc2V0dXBDb21wb25lbnRDb29yZGluYXRpb24oXG4gICAgY29tcG9uZW50czogUmVjb3JkPHN0cmluZywgQ29tcG9uZW50V2l0aEV2ZW50SGFuZGxlcj5cbiAgKTogdm9pZCB7XG4gICAgdGhpcy5jb21wb25lbnRzID0gY29tcG9uZW50cztcblxuICAgIC8vIFNldCB1cCBhbnkgY3Jvc3MtY29tcG9uZW50IGNvbW11bmljYXRpb24gaGVyZSAob25seSBvbmNlKVxuICAgIGlmICghdGhpcy5ldmVudExpc3RlbmVyc1NldHVwKSB7XG4gICAgICB0aGlzLmNvbm5lY3RDb21wb25lbnRTaWduYWxzKCk7XG4gICAgICB0aGlzLmV2ZW50TGlzdGVuZXJzU2V0dXAgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGhhbmRsZVNlcXVlbmNlTW9kaWZpZWQoc2VxdWVuY2U6IFNlcXVlbmNlRGF0YSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0aGlzLmlzSGFuZGxpbmdTZXF1ZW5jZU1vZGlmaWNhdGlvbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICB0aGlzLmlzSGFuZGxpbmdTZXF1ZW5jZU1vZGlmaWNhdGlvbiA9IHRydWU7XG5cbiAgICAgIC8vICoqQ1JJVElDQUw6IFVwZGF0ZSBzaW5nbGV0b24gc3RhdGUgdG8ga2VlcCBVSSBpbiBzeW5jKipcbiAgICAgIC8vIFRPRE86IFVwZGF0ZSB0byB1c2UgbmV3IERJIHBhdHRlcm5cbiAgICAgIC8vIHNlcXVlbmNlU3RhdGVTZXJ2aWNlLnNldEN1cnJlbnRTZXF1ZW5jZShzZXF1ZW5jZSk7XG5cbiAgICAgIC8vIFVwZGF0ZSBVSSBiYXNlZCBvbiBzZXF1ZW5jZSBzdGF0ZVxuICAgICAgYXdhaXQgdGhpcy51cGRhdGVVSUJhc2VkT25TZXF1ZW5jZShzZXF1ZW5jZSk7XG5cbiAgICAgIC8vIE5vdGlmeSBjb21wb25lbnRzIGFib3V0IHNlcXVlbmNlIGNoYW5nZVxuICAgICAgdGhpcy5ub3RpZnlDb21wb25lbnRzKFwic2VxdWVuY2VfbW9kaWZpZWRcIiwgeyBzZXF1ZW5jZSB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBFcnJvciBoYW5kbGluZyBzZXF1ZW5jZSBtb2RpZmljYXRpb246XCIsIGVycm9yKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5pc0hhbmRsaW5nU2VxdWVuY2VNb2RpZmljYXRpb24gPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBoYW5kbGVTdGFydFBvc2l0aW9uU2V0KHN0YXJ0UG9zaXRpb246IEJlYXREYXRhKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFNldCBsb2FkaW5nIHN0YXRlIHRvIHNob3cgdXNlciBzb21ldGhpbmcgaXMgaGFwcGVuaW5nXG4gICAgICAvLyBUT0RPOiBVcGRhdGUgdG8gdXNlIG5ldyBESSBwYXR0ZXJuXG4gICAgICAvLyBzZXF1ZW5jZVN0YXRlU2VydmljZS5zZXRMb2FkaW5nKHRydWUpO1xuICAgICAgLy8gc2VxdWVuY2VTdGF0ZVNlcnZpY2UuY2xlYXJFcnJvcigpO1xuXG4gICAgICAvLyBTZXQgdGhlIHN0YXJ0IHBvc2l0aW9uIHVzaW5nIHRoZSBzZXJ2aWNlXG4gICAgICBhd2FpdCB0aGlzLnN0YXJ0UG9zaXRpb25TZXJ2aWNlLnNldFN0YXJ0UG9zaXRpb24oc3RhcnRQb3NpdGlvbik7XG5cbiAgICAgIC8vICoqQ1JJVElDQUw6IENyZWF0ZSBhIHNlcXVlbmNlIHdpdGggdGhlIHN0YXJ0IHBvc2l0aW9uIHN0b3JlZCBzZXBhcmF0ZWx5KipcbiAgICAgIC8vIENyZWF0ZSBhIG5ldyBzZXF1ZW5jZSB3aXRoIE5PIGJlYXRzIGluaXRpYWxseSAocHJvZ3Jlc3NpdmUgY3JlYXRpb24pXG4gICAgICBjb25zdCBuZXdTZXF1ZW5jZSA9IGF3YWl0IHRoaXMuc2VxdWVuY2VTZXJ2aWNlLmNyZWF0ZVNlcXVlbmNlKHtcbiAgICAgICAgbmFtZTogYFNlcXVlbmNlICR7bmV3IERhdGUoKS50b0xvY2FsZVRpbWVTdHJpbmcoKX1gLFxuICAgICAgICBsZW5ndGg6IDAsIC8vIFN0YXJ0IHdpdGggMCBiZWF0cyAtIGJlYXRzIHdpbGwgYmUgYWRkZWQgcHJvZ3Jlc3NpdmVseVxuICAgICAgICBncmlkTW9kZTogR3JpZE1vZGUuRElBTU9ORCwgLy8gRGVmYXVsdCBncmlkIG1vZGVcbiAgICAgICAgcHJvcFR5cGU6IFwic3RhZmZcIiwgLy8gRGVmYXVsdCBwcm9wIHR5cGVcbiAgICAgIH0pO1xuXG4gICAgICAvLyAqKkNSSVRJQ0FMOiBTZXQgdGhlIHN0YXJ0IHBvc2l0aW9uIGluIHRoZSBzZXF1ZW5jZSdzIHN0YXJ0UG9zaXRpb24gZmllbGQsIE5PVCBhcyBiZWF0IDAqKlxuICAgICAgY29uc3QgdXBkYXRlZFNlcXVlbmNlID1cbiAgICAgICAgYXdhaXQgdGhpcy53b3JrYmVuY2hCZWF0T3BlcmF0aW9ucy5zZXRDb25zdHJ1Y3Rpb25TdGFydFBvc2l0aW9uKFxuICAgICAgICAgIG5ld1NlcXVlbmNlLmlkLFxuICAgICAgICAgIHN0YXJ0UG9zaXRpb25cbiAgICAgICAgKTtcblxuICAgICAgaWYgKHVwZGF0ZWRTZXF1ZW5jZSkge1xuICAgICAgICAvLyAqKkNSSVRJQ0FMIEZJWDogVXBkYXRlIHRoZSBzaW5nbGV0b24gc3RhdGUgdGhhdCBVSSBjb21wb25lbnRzIHdhdGNoKipcbiAgICAgICAgLy8gVE9ETzogVXBkYXRlIHRvIHVzZSBuZXcgREkgcGF0dGVyblxuICAgICAgICAvLyBzZXF1ZW5jZVN0YXRlU2VydmljZS5zZXRDdXJyZW50U2VxdWVuY2UodXBkYXRlZFNlcXVlbmNlKTtcblxuICAgICAgICAvLyBBbHNvIGNsZWFyIGxvYWRpbmcgc3RhdGVcbiAgICAgICAgLy8gc2VxdWVuY2VTdGF0ZVNlcnZpY2Uuc2V0TG9hZGluZyhmYWxzZSk7XG5cbiAgICAgICAgLy8gU2VydmljZSBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5IC0gbGV0IGNvbXBvbmVudHMgaGFuZGxlIGFkZGl0aW9uYWwgc3RhdGUgdXBkYXRlc1xuICAgICAgICB0aGlzLm5vdGlmeUNvbXBvbmVudHMoXCJzZXF1ZW5jZUNyZWF0ZWRcIiwge1xuICAgICAgICAgIHNlcXVlbmNlOiB1cGRhdGVkU2VxdWVuY2UsXG4gICAgICAgICAgc3RhcnRQb3NpdGlvbjogc3RhcnRQb3NpdGlvbixcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwi4p2MIEZhaWxlZCB0byByZWxvYWQgdXBkYXRlZCBzZXF1ZW5jZVwiKTtcbiAgICAgICAgLy8gVE9ETzogVXBkYXRlIHRvIHVzZSBuZXcgREkgcGF0dGVyblxuICAgICAgICAvLyBzZXF1ZW5jZVN0YXRlU2VydmljZS5zZXRMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgLy8gc2VxdWVuY2VTdGF0ZVNlcnZpY2Uuc2V0RXJyb3IoXG4gICAgICAgIC8vICAgXCJGYWlsZWQgdG8gY3JlYXRlIHNlcXVlbmNlIHdpdGggc3RhcnQgcG9zaXRpb25cIlxuICAgICAgICAvLyApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIE5vdGlmeSBjb21wb25lbnRzXG4gICAgICB0aGlzLm5vdGlmeUNvbXBvbmVudHMoXCJzdGFydF9wb3NpdGlvbl9zZXRcIiwgeyBzdGFydFBvc2l0aW9uIH0pO1xuXG4gICAgICAvLyAqKkNSSVRJQ0FMOiBOb3RpZnkgY29tcG9uZW50cyB0byB1cGRhdGUgVUkgc3RhdGUqKlxuICAgICAgLy8gVGhlIHNob3VsZFNob3dTdGFydFBvc2l0aW9uUGlja2VyIGxvZ2ljIHNob3VsZCBub3cgYXV0b21hdGljYWxseSByZXR1cm4gZmFsc2VcbiAgICAgIC8vIGJlY2F1c2Ugd2UndmUgc2V0IGEgY3VycmVudCBzZXF1ZW5jZSB3aXRoIGEgc3RhcnRQb3NpdGlvblxuICAgICAgdGhpcy5ub3RpZnlDb21wb25lbnRzKFwidWlfc3RhdGVfdXBkYXRlX3JlcXVlc3RlZFwiLCB7XG4gICAgICAgIGFjdGlvbjogXCJoaWRlX3N0YXJ0X3Bvc2l0aW9uX3BpY2tlclwiLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFRyYW5zaXRpb24gdG8gb3B0aW9uIHBpY2tlclxuICAgICAgYXdhaXQgdGhpcy5oYW5kbGVVSVRyYW5zaXRpb25SZXF1ZXN0KFwib3B0aW9uX3BpY2tlclwiKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBFcnJvciBoYW5kbGluZyBzdGFydCBwb3NpdGlvbiBzZXQ6XCIsIGVycm9yKTtcbiAgICAgIC8vIFRPRE86IFVwZGF0ZSB0byB1c2UgbmV3IERJIHBhdHRlcm5cbiAgICAgIC8vIHNlcXVlbmNlU3RhdGVTZXJ2aWNlLnNldExvYWRpbmcoZmFsc2UpO1xuICAgICAgLy8gc2VxdWVuY2VTdGF0ZVNlcnZpY2Uuc2V0RXJyb3IoXG4gICAgICAvLyAgIGBGYWlsZWQgdG8gc2V0IHN0YXJ0IHBvc2l0aW9uOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCJ9YFxuICAgICAgLy8gKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBoYW5kbGVCZWF0QWRkZWQoYmVhdERhdGE6IEJlYXREYXRhKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEdldCBjdXJyZW50IHNlcXVlbmNlIGZyb20gc2luZ2xldG9uIHN0YXRlXG4gICAgICAvLyBUT0RPOiBVcGRhdGUgdG8gdXNlIG5ldyBESSBwYXR0ZXJuXG4gICAgICBjb25zdCBjdXJyZW50U2VxdWVuY2UgPSBudWxsOyAvLyBzZXF1ZW5jZVN0YXRlU2VydmljZS5jdXJyZW50U2VxdWVuY2U7XG5cbiAgICAgIGlmICghY3VycmVudFNlcXVlbmNlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgTm8gY3VycmVudCBzZXF1ZW5jZSBhdmFpbGFibGUgZm9yIGFkZGluZyBiZWF0XCIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vICoqQ1JJVElDQUw6IFVzZSB0aGUgd29ya2JlbmNoIHNlcnZpY2UgdG8gYWRkIHRoZSBiZWF0KipcbiAgICAgIC8vIFRPRE86IEZpeCB3aGVuIGN1cnJlbnRTZXF1ZW5jZSBpcyBwcm9wZXJseSBpbXBsZW1lbnRlZFxuICAgICAgLy8gY29uc3QgdXBkYXRlZFNlcXVlbmNlID0gYXdhaXQgdGhpcy53b3JrYmVuY2hCZWF0T3BlcmF0aW9ucy5hZGRCZWF0KFxuICAgICAgLy8gICBjdXJyZW50U2VxdWVuY2UuaWQsXG4gICAgICAvLyAgIGJlYXREYXRhXG4gICAgICAvLyApO1xuXG4gICAgICAvLyAqKkNSSVRJQ0FMOiBVcGRhdGUgc2luZ2xldG9uIHN0YXRlKipcbiAgICAgIC8vIFRPRE86IFVwZGF0ZSB0byB1c2UgbmV3IERJIHBhdHRlcm5cbiAgICAgIC8vIHNlcXVlbmNlU3RhdGVTZXJ2aWNlLnNldEN1cnJlbnRTZXF1ZW5jZSh1cGRhdGVkU2VxdWVuY2UpO1xuXG4gICAgICAvLyBOb3RpZnkgY29tcG9uZW50c1xuICAgICAgdGhpcy5ub3RpZnlDb21wb25lbnRzKFwiYmVhdF9hZGRlZFwiLCB7IGJlYXREYXRhIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwi4p2MIEVycm9yIGhhbmRsaW5nIGJlYXQgYWRkZWQ6XCIsIGVycm9yKTtcbiAgICAgIC8vIFRPRE86IFVwZGF0ZSB0byB1c2UgbmV3IERJIHBhdHRlcm5cbiAgICAgIC8vIHNlcXVlbmNlU3RhdGVTZXJ2aWNlLnNldEVycm9yKFxuICAgICAgLy8gICBgRmFpbGVkIHRvIGFkZCBiZWF0OiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCJ9YFxuICAgICAgLy8gKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBoYW5kbGVHZW5lcmF0aW9uUmVxdWVzdChcbiAgICBjb25maWc6IFJlY29yZDxzdHJpbmcsIHVua25vd24+XG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBUT0RPOiBJbXBsZW1lbnQgc2VxdWVuY2UgZ2VuZXJhdGlvblxuICAgICAgLy8gRm9yIG5vdywganVzdCBub3RpZnkgY29tcG9uZW50c1xuICAgICAgdGhpcy5ub3RpZnlDb21wb25lbnRzKFwiZ2VuZXJhdGlvbl9yZXF1ZXN0ZWRcIiwgeyBjb25maWcgfSk7XG5cbiAgICAgIC8vIFNpbXVsYXRlIGdlbmVyYXRpb24gY29tcGxldGlvblxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRoaXMubm90aWZ5Q29tcG9uZW50cyhcImdlbmVyYXRpb25fY29tcGxldGVkXCIsIHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIG1lc3NhZ2U6IFwiR2VuZXJhdGlvbiBjb21wbGV0ZWRcIixcbiAgICAgICAgfSk7XG4gICAgICB9LCAxMDAwKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBFcnJvciBoYW5kbGluZyBnZW5lcmF0aW9uIHJlcXVlc3Q6XCIsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBoYW5kbGVVSVRyYW5zaXRpb25SZXF1ZXN0KHRhcmdldFBhbmVsOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgLy8gRW1pdCBjdXN0b20gZXZlbnRzIGZvciBVSSB0cmFuc2l0aW9ucyAoc2ltaWxhciB0byBsZWdhY3kgaW1wbGVtZW50YXRpb24pXG4gICAgICBjb25zdCB0cmFuc2l0aW9uRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoXCJjb25zdHJ1Y3QtdGFiLXRyYW5zaXRpb25cIiwge1xuICAgICAgICBkZXRhaWw6IHsgdGFyZ2V0UGFuZWwgfSxcbiAgICAgICAgYnViYmxlczogdHJ1ZSxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KHRyYW5zaXRpb25FdmVudCk7XG4gICAgICB9XG5cbiAgICAgIC8vIE5vdGlmeSBjb21wb25lbnRzIGFib3V0IHRoZSB0cmFuc2l0aW9uXG4gICAgICB0aGlzLm5vdGlmeUNvbXBvbmVudHMoXCJ1aV90cmFuc2l0aW9uXCIsIHsgdGFyZ2V0UGFuZWwgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgRXJyb3IgaGFuZGxpbmcgVUkgdHJhbnNpdGlvbjpcIiwgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY29ubmVjdENvbXBvbmVudFNpZ25hbHMoKTogdm9pZCB7XG4gICAgLy8gU2V0IHVwIGV2ZW50IGxpc3RlbmVycyBmb3IgY29tcG9uZW50IGNvb3JkaW5hdGlvblxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAvLyBDcmVhdGUgYm91bmQgZXZlbnQgaGFuZGxlcnMgdG8gYWxsb3cgcHJvcGVyIGNsZWFudXBcbiAgICAgIHRoaXMuYm91bmRFdmVudEhhbmRsZXJzID0ge1xuICAgICAgICBzdGFydFBvc2l0aW9uU2VsZWN0ZWQ6ICgoZXZlbnQ6IEN1c3RvbUV2ZW50KSA9PiB7XG4gICAgICAgICAgdGhpcy5oYW5kbGVTdGFydFBvc2l0aW9uU2V0KGV2ZW50LmRldGFpbC5zdGFydFBvc2l0aW9uKTtcbiAgICAgICAgfSkgYXMgKGV2ZW50OiBDdXN0b21FdmVudCkgPT4gdm9pZCxcblxuICAgICAgICBvcHRpb25TZWxlY3RlZDogKChldmVudDogQ3VzdG9tRXZlbnQpID0+IHtcbiAgICAgICAgICB0aGlzLmhhbmRsZUJlYXRBZGRlZChldmVudC5kZXRhaWwuYmVhdERhdGEpO1xuICAgICAgICB9KSBhcyAoZXZlbnQ6IEN1c3RvbUV2ZW50KSA9PiB2b2lkLFxuXG4gICAgICAgIHNlcXVlbmNlTW9kaWZpZWQ6ICgoZXZlbnQ6IEN1c3RvbUV2ZW50KSA9PiB7XG4gICAgICAgICAgdGhpcy5oYW5kbGVTZXF1ZW5jZU1vZGlmaWVkKGV2ZW50LmRldGFpbC5zZXF1ZW5jZSk7XG4gICAgICAgIH0pIGFzIChldmVudDogQ3VzdG9tRXZlbnQpID0+IHZvaWQsXG4gICAgICB9O1xuXG4gICAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJzXG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICBcInN0YXJ0LXBvc2l0aW9uLXNlbGVjdGVkXCIsXG4gICAgICAgIHRoaXMuYm91bmRFdmVudEhhbmRsZXJzLnN0YXJ0UG9zaXRpb25TZWxlY3RlZCBhcyBFdmVudExpc3RlbmVyXG4gICAgICApO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgXCJvcHRpb24tc2VsZWN0ZWRcIixcbiAgICAgICAgdGhpcy5ib3VuZEV2ZW50SGFuZGxlcnMub3B0aW9uU2VsZWN0ZWQgYXMgRXZlbnRMaXN0ZW5lclxuICAgICAgKTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgIFwic2VxdWVuY2UtbW9kaWZpZWRcIixcbiAgICAgICAgdGhpcy5ib3VuZEV2ZW50SGFuZGxlcnMuc2VxdWVuY2VNb2RpZmllZCBhcyBFdmVudExpc3RlbmVyXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbiB1cCBldmVudCBsaXN0ZW5lcnMgdG8gcHJldmVudCBtZW1vcnkgbGVha3MgYW5kIGR1cGxpY2F0ZSBoYW5kbGVyc1xuICAgKi9cbiAgcHJpdmF0ZSBkaXNjb25uZWN0Q29tcG9uZW50U2lnbmFscygpOiB2b2lkIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0aGlzLmJvdW5kRXZlbnRIYW5kbGVycykge1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgXCJzdGFydC1wb3NpdGlvbi1zZWxlY3RlZFwiLFxuICAgICAgICB0aGlzLmJvdW5kRXZlbnRIYW5kbGVycy5zdGFydFBvc2l0aW9uU2VsZWN0ZWQgYXMgRXZlbnRMaXN0ZW5lclxuICAgICAgKTtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgIFwib3B0aW9uLXNlbGVjdGVkXCIsXG4gICAgICAgIHRoaXMuYm91bmRFdmVudEhhbmRsZXJzLm9wdGlvblNlbGVjdGVkIGFzIEV2ZW50TGlzdGVuZXJcbiAgICAgICk7XG4gICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgICAgICBcInNlcXVlbmNlLW1vZGlmaWVkXCIsXG4gICAgICAgIHRoaXMuYm91bmRFdmVudEhhbmRsZXJzLnNlcXVlbmNlTW9kaWZpZWQgYXMgRXZlbnRMaXN0ZW5lclxuICAgICAgKTtcbiAgICAgIHRoaXMuYm91bmRFdmVudEhhbmRsZXJzID0gbnVsbDtcbiAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnNTZXR1cCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgdXBkYXRlVUlCYXNlZE9uU2VxdWVuY2Uoc2VxdWVuY2U6IFNlcXVlbmNlRGF0YSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBEZXRlcm1pbmUgd2hpY2ggcGFuZWwgdG8gc2hvdyBiYXNlZCBvbiBzZXF1ZW5jZSBzdGF0ZVxuICAgICAgY29uc3QgaGFzU3RhcnRQb3NpdGlvbiA9IHNlcXVlbmNlPy5zdGFydGluZ1Bvc2l0aW9uQmVhdCAhPSBudWxsO1xuICAgICAgY29uc3QgaGFzQmVhdHMgPSBzZXF1ZW5jZSAmJiBzZXF1ZW5jZS5iZWF0cyAmJiBzZXF1ZW5jZS5iZWF0cy5sZW5ndGggPiAwO1xuXG4gICAgICBsZXQgdGFyZ2V0UGFuZWw6IHN0cmluZztcblxuICAgICAgaWYgKGhhc1N0YXJ0UG9zaXRpb24gfHwgaGFzQmVhdHMpIHtcbiAgICAgICAgdGFyZ2V0UGFuZWwgPSBcIm9wdGlvbl9waWNrZXJcIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRhcmdldFBhbmVsID0gXCJzdGFydF9wb3NpdGlvbl9waWNrZXJcIjtcbiAgICAgIH1cblxuICAgICAgLy8gVHJhbnNpdGlvbiB0byBhcHByb3ByaWF0ZSBwYW5lbFxuICAgICAgYXdhaXQgdGhpcy5oYW5kbGVVSVRyYW5zaXRpb25SZXF1ZXN0KHRhcmdldFBhbmVsKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBFcnJvciB1cGRhdGluZyBVSSBiYXNlZCBvbiBzZXF1ZW5jZTpcIiwgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgaGFzU3RhcnRQb3NpdGlvbihzZXF1ZW5jZTogU2VxdWVuY2VEYXRhKTogYm9vbGVhbiB7XG4gICAgLy8gKipGSVhFRDogQ2hlY2sgdGhlIHN0YXJ0UG9zaXRpb24gZmllbGQgaW5zdGVhZCBvZiBjaGVja2luZyBiZWF0c1swXSoqXG4gICAgLy8gVGhpcyBhbGlnbnMgd2l0aCB0aGUgbW9kZXJuIGFyY2hpdGVjdHVyZSB3aGVyZSBzdGFydCBwb3NpdGlvbiBpcyBzZXBhcmF0ZVxuICAgIHJldHVybiBzZXF1ZW5jZT8uc3RhcnRpbmdQb3NpdGlvbkJlYXQgIT0gbnVsbDtcbiAgfVxuXG4gIHByaXZhdGUgbm90aWZ5Q29tcG9uZW50cyhldmVudFR5cGU6IHN0cmluZywgZGF0YTogdW5rbm93bik6IHZvaWQge1xuICAgIC8vIE5vdGlmeSBpbmRpdmlkdWFsIGNvbXBvbmVudHMgaWYgdGhleSBoYXZlIGhhbmRsZXJzXG4gICAgT2JqZWN0LmVudHJpZXModGhpcy5jb21wb25lbnRzKS5mb3JFYWNoKChbbmFtZSwgY29tcG9uZW50XSkgPT4ge1xuICAgICAgaWYgKGNvbXBvbmVudCAmJiB0eXBlb2YgY29tcG9uZW50LmhhbmRsZUV2ZW50ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb21wb25lbnQuaGFuZGxlRXZlbnQoZXZlbnRUeXBlLCBkYXRhKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGDinYwgRXJyb3Igbm90aWZ5aW5nIGNvbXBvbmVudCAke25hbWV9OmAsIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gRW1pdCBnbG9iYWwgZXZlbnQgZm9yIGFueSBsaXN0ZW5lcnNcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgY29uc3QgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoYGNvbnN0cnVjdC1jb29yZGluYXRpb24tJHtldmVudFR5cGV9YCwge1xuICAgICAgICBkZXRhaWw6IGRhdGEsXG4gICAgICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgICB9KTtcbiAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgIH1cbiAgfVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIkFBU0EsU0FBUyxnQkFBZ0I7QUFtQmxCLGFBQU0sZ0NBRWI7QUFBQSxFQVVFLFlBQ1UsaUJBQ0Esc0JBQ0EseUJBQ1I7QUFIUTtBQUNBO0FBQ0E7QUFBQSxFQUNQO0FBQUEsRUFiSyxhQUF3RCxDQUFDO0FBQUEsRUFDekQsaUNBQWlDO0FBQUEsRUFDakMsc0JBQXNCO0FBQUEsRUFDdEIscUJBSUc7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQVdYLFVBQWdCO0FBQ2QsU0FBSywyQkFBMkI7QUFDaEMsU0FBSyxhQUFhLENBQUM7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
