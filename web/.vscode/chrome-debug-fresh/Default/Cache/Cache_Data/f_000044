export class PageImageExportService {
  abortController = null;
  currentProgress = null;
  async exportPageAsImage(pageElement, options) {
    const startTime = performance.now();
    try {
      const validation = this.validateExportOptions(options);
      if (!validation) {
        throw new Error(`Invalid export options`);
      }
      const html2canvas = await this.loadHtml2Canvas();
      const preparedElement = this.prepareElementForCapture(pageElement);
      const dimensions = this.calculateCaptureDimensions(
        preparedElement,
        options
      );
      const canvas = await html2canvas(preparedElement, {
        width: dimensions.width,
        height: dimensions.height,
        scale: options.scale,
        backgroundColor: options.backgroundColor || "#ffffff",
        useCORS: true,
        allowTaint: false,
        removeContainer: true,
        logging: false,
        // High quality rendering
        scrollX: 0,
        scrollY: 0,
        windowWidth: dimensions.width,
        windowHeight: dimensions.height
      });
      const blob = await this.canvasToBlob(canvas, options);
      const processingTime = performance.now() - startTime;
      return {
        sequenceId: "page-export",
        success: true,
        blob,
        filename: this.generateFilename(options.format),
        metrics: {
          processingTime,
          fileSize: blob.size,
          resolution: { width: canvas.width, height: canvas.height }
        },
        metadata: {
          format: options.format,
          size: blob.size,
          dimensions: {
            width: canvas.width,
            height: canvas.height
          },
          processingTime
        }
      };
    } catch (error) {
      const processingTime = performance.now() - startTime;
      return {
        sequenceId: "page-export",
        success: false,
        filename: this.generateFilename(options.format),
        error,
        metrics: {
          processingTime,
          fileSize: 0,
          resolution: { width: 0, height: 0 }
        },
        metadata: {
          format: options.format,
          size: 0,
          processingTime
        }
      };
    }
  }
  async exportPagesAsImages(pageElements, options, onProgress) {
    const startTime = performance.now();
    const results = [];
    const errors = [];
    let successCount = 0;
    let failureCount = 0;
    this.abortController = new AbortController();
    try {
      const html2canvas = await this.loadHtml2Canvas();
      for (let i = 0; i < pageElements.length; i++) {
        if (this.abortController.signal.aborted) {
          break;
        }
        const progress = {
          current: i + 1,
          total: pageElements.length,
          currentItem: i + 1,
          totalItems: pageElements.length,
          percentage: (i + 1) / pageElements.length * 100,
          currentPage: i + 1,
          currentOperation: `Exporting page ${i + 1} of ${pageElements.length}`,
          estimatedTimeRemaining: this.estimateTimeRemaining(
            i + 1,
            pageElements.length,
            performance.now() - startTime
          ),
          isComplete: i + 1 === pageElements.length
        };
        this.currentProgress = progress;
        onProgress?.(progress);
        try {
          const result = await this.exportSinglePageWithCanvas(
            pageElements[i],
            html2canvas,
            options,
            i + 1
          );
          results.push(result);
          if (result.success) {
            successCount++;
          } else {
            failureCount++;
            if (result.error) {
              errors.push(result.error);
            }
          }
        } catch (error) {
          failureCount++;
          const err = error;
          errors.push(err);
          results.push({
            sequenceId: `page-${i + 1}`,
            success: false,
            filename: this.generateFilename(options.format, i + 1),
            error: err,
            metrics: {
              processingTime: 0,
              fileSize: 0,
              resolution: { width: 0, height: 0 }
            },
            metadata: {
              format: options.format,
              size: 0,
              processingTime: 0
            }
          });
        }
        await this.pauseForUI();
      }
    } catch (error) {
      errors.push(error);
    } finally {
      this.abortController = null;
      this.currentProgress = null;
    }
    const totalProcessingTime = performance.now() - startTime;
    return {
      success: errors.length === 0,
      totalPages: pageElements.length,
      successCount,
      failureCount,
      results,
      totalProcessingTime,
      errors
    };
  }
  calculateOptimalDimensions(pageElement, targetDPI) {
    const rect = pageElement.getBoundingClientRect();
    const scaleFactor = targetDPI / 96;
    return {
      width: Math.round(rect.width * scaleFactor),
      height: Math.round(rect.height * scaleFactor)
    };
  }
  validateExportOptions(options) {
    if (!["PNG", "JPEG", "WebP"].includes(options.format)) {
      return false;
    }
    if (options.quality < 0 || options.quality > 1) {
      return false;
    }
    if (options.scale <= 0) {
      return false;
    }
    if (options.width && options.width <= 0) {
      return false;
    }
    if (options.height && options.height <= 0) {
      return false;
    }
    return true;
  }
  getSupportedFormats() {
    return ["PNG", "JPEG", "WebP"];
  }
  getRecommendedSettings(useCase) {
    const baseOptions = {
      quality: 0.9,
      scale: 1,
      backgroundColor: "#ffffff"
    };
    switch (useCase) {
      case "print":
        return {
          ...baseOptions,
          format: "PNG",
          scale: 2,
          quality: 1
        };
      case "web":
        return {
          ...baseOptions,
          format: "JPEG",
          scale: 1,
          quality: 0.8
        };
      case "archive":
        return {
          ...baseOptions,
          format: "PNG",
          scale: 1.5,
          quality: 1
        };
      default:
        return {
          ...baseOptions,
          format: "PNG"
        };
    }
  }
  // Cancel ongoing export
  cancelExport() {
    if (this.abortController) {
      this.abortController.abort();
    }
  }
  // Get current progress
  getCurrentProgress() {
    return this.currentProgress;
  }
  // Private helper methods
  async loadHtml2Canvas() {
    try {
      if (typeof window !== "undefined" && !window.html2canvas) {
        const script = document.createElement("script");
        script.src = "https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js";
        await new Promise((resolve, reject) => {
          script.onload = resolve;
          script.onerror = reject;
          document.head.appendChild(script);
        });
      }
      const html2canvas = window.html2canvas;
      if (!html2canvas) {
        throw new Error("html2canvas failed to load");
      }
      return html2canvas;
    } catch (error) {
      throw new Error(
        "Failed to load html2canvas library. Check internet connection."
      );
    }
  }
  prepareElementForCapture(element) {
    const clonedElement = element.cloneNode(true);
    clonedElement.style.position = "static";
    clonedElement.style.transform = "none";
    clonedElement.style.margin = "0";
    clonedElement.style.padding = "0";
    const images = clonedElement.querySelectorAll("img");
    images.forEach((img) => {
      if (!img.complete) {
        img.src = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHg9IjUwIiB5PSI1MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEyIiBmaWxsPSIjOTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+SW1hZ2U8L3RleHQ+PC9zdmc+";
      }
    });
    return clonedElement;
  }
  calculateCaptureDimensions(element, options) {
    const rect = element.getBoundingClientRect();
    if (options.width && options.height) {
      return { width: options.width, height: options.height };
    }
    if (options.width) {
      const aspectRatio = rect.height / rect.width;
      return { width: options.width, height: options.width * aspectRatio };
    }
    if (options.height) {
      const aspectRatio = rect.width / rect.height;
      return { width: options.height * aspectRatio, height: options.height };
    }
    return { width: rect.width, height: rect.height };
  }
  async canvasToBlob(canvas, options) {
    return new Promise((resolve, reject) => {
      const mimeType = this.getMimeType(options.format);
      const quality = options.format === "PNG" ? void 0 : options.quality;
      canvas.toBlob(
        (blob) => {
          if (blob) {
            resolve(blob);
          } else {
            reject(new Error("Failed to create blob from canvas"));
          }
        },
        mimeType,
        quality
      );
    });
  }
  getMimeType(format) {
    switch (format) {
      case "PNG":
        return "image/png";
      case "JPEG":
        return "image/jpeg";
      case "WebP":
        return "image/webp";
      default:
        return "image/png";
    }
  }
  generateFilename(format, pageNumber) {
    const timestamp = (/* @__PURE__ */ new Date()).toISOString().slice(0, 19).replace(/:/g, "-");
    const page = pageNumber ? `-page-${pageNumber}` : "";
    const ext = format.toLowerCase();
    return `sequence-cards${page}-${timestamp}.${ext}`;
  }
  async exportSinglePageWithCanvas(pageElement, html2canvas, options, pageNumber) {
    const startTime = performance.now();
    try {
      const preparedElement = this.prepareElementForCapture(pageElement);
      const dimensions = this.calculateCaptureDimensions(
        preparedElement,
        options
      );
      const canvas = await html2canvas(preparedElement, {
        width: dimensions.width,
        height: dimensions.height,
        scale: options.scale,
        backgroundColor: options.backgroundColor || "#ffffff",
        useCORS: true,
        allowTaint: false,
        removeContainer: true,
        logging: false,
        scrollX: 0,
        scrollY: 0,
        windowWidth: dimensions.width,
        windowHeight: dimensions.height
      });
      const blob = await this.canvasToBlob(canvas, options);
      const processingTime = performance.now() - startTime;
      return {
        sequenceId: `page-${pageNumber}`,
        success: true,
        blob,
        filename: this.generateFilename(options.format, pageNumber),
        metrics: {
          processingTime,
          fileSize: blob.size,
          resolution: { width: canvas.width, height: canvas.height }
        },
        metadata: {
          format: options.format,
          size: blob.size,
          dimensions: {
            width: canvas.width,
            height: canvas.height
          },
          processingTime
        }
      };
    } catch (error) {
      const processingTime = performance.now() - startTime;
      return {
        sequenceId: `page-${pageNumber}`,
        success: false,
        filename: this.generateFilename(options.format, pageNumber),
        error,
        metrics: {
          processingTime,
          fileSize: 0,
          resolution: { width: 0, height: 0 }
        },
        metadata: {
          format: options.format,
          size: 0,
          processingTime
        }
      };
    }
  }
  estimateTimeRemaining(current, total, elapsedTime) {
    if (current === 0) return 0;
    const averageTimePerItem = elapsedTime / current;
    const remainingItems = total - current;
    return remainingItems * averageTimePerItem;
  }
  async pauseForUI() {
    return new Promise((resolve) => setTimeout(resolve, 10));
  }
}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiQzovVEtBL3dlYi9zcmMvbGliL3NlcnZpY2VzL2ltcGxlbWVudGF0aW9ucy9leHBvcnQvUGFnZUltYWdlRXhwb3J0U2VydmljZS50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiLyoqXG4gKiBQYWdlIEltYWdlIEV4cG9ydCBTZXJ2aWNlIEltcGxlbWVudGF0aW9uXG4gKlxuICogSGFuZGxlcyBleHBvcnRpbmcgcGFnZSBlbGVtZW50cyBhcyBpbWFnZXMgdXNpbmcgaHRtbDJjYW52YXMuXG4gKiBTdXBwb3J0cyBQTkcsIEpQRUcsIGFuZCBXZWJQIGZvcm1hdHMgd2l0aCBxdWFsaXR5IGFuZCBzY2FsaW5nIG9wdGlvbnMuXG4gKi9cblxuLy8gSHRtbDJDYW52YXMgaW50ZXJmYWNlIGZvciB0eXBlIHNhZmV0eVxuaW50ZXJmYWNlIEh0bWwyQ2FudmFzRnVuY3Rpb24ge1xuICAoXG4gICAgZWxlbWVudDogSFRNTEVsZW1lbnQsXG4gICAgb3B0aW9ucz86IEh0bWwyQ2FudmFzT3B0aW9uc1xuICApOiBQcm9taXNlPEhUTUxDYW52YXNFbGVtZW50Pjtcbn1cblxuaW50ZXJmYWNlIEh0bWwyQ2FudmFzT3B0aW9ucyB7XG4gIHNjYWxlPzogbnVtYmVyO1xuICBiYWNrZ3JvdW5kQ29sb3I/OiBzdHJpbmc7XG4gIHVzZUNPUlM/OiBib29sZWFuO1xuICBhbGxvd1RhaW50PzogYm9vbGVhbjtcbiAgd2lkdGg/OiBudW1iZXI7XG4gIGhlaWdodD86IG51bWJlcjtcbiAgcmVtb3ZlQ29udGFpbmVyPzogYm9vbGVhbjtcbiAgW2tleTogc3RyaW5nXTogdW5rbm93bjsgLy8gQWxsb3cgYWRkaXRpb25hbCBodG1sMmNhbnZhcyBvcHRpb25zXG59XG5cbmludGVyZmFjZSBXaW5kb3dXaXRoSHRtbDJDYW52YXMgZXh0ZW5kcyBXaW5kb3cge1xuICBodG1sMmNhbnZhcz86IEh0bWwyQ2FudmFzRnVuY3Rpb247XG59XG5cbmltcG9ydCB0eXBlIHtcbiAgQmF0Y2hFeHBvcnRSZXN1bHQsXG4gIEV4cG9ydFByb2dyZXNzLFxuICBJUGFnZUltYWdlRXhwb3J0U2VydmljZSxcbiAgSW1hZ2VFeHBvcnRPcHRpb25zLFxuICBTZXJ2aWNlRXhwb3J0UmVzdWx0LFxufSBmcm9tIFwiLi4vLi4vaW50ZXJmYWNlcy9leHBvcnQtaW50ZXJmYWNlc1wiO1xuXG5leHBvcnQgY2xhc3MgUGFnZUltYWdlRXhwb3J0U2VydmljZSBpbXBsZW1lbnRzIElQYWdlSW1hZ2VFeHBvcnRTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBhYm9ydENvbnRyb2xsZXI6IEFib3J0Q29udHJvbGxlciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGN1cnJlbnRQcm9ncmVzczogRXhwb3J0UHJvZ3Jlc3MgfCBudWxsID0gbnVsbDtcblxuICBhc3luYyBleHBvcnRQYWdlQXNJbWFnZShcbiAgICBwYWdlRWxlbWVudDogSFRNTEVsZW1lbnQsXG4gICAgb3B0aW9uczogSW1hZ2VFeHBvcnRPcHRpb25zXG4gICk6IFByb21pc2U8U2VydmljZUV4cG9ydFJlc3VsdD4ge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFZhbGlkYXRlIG9wdGlvbnNcbiAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLnZhbGlkYXRlRXhwb3J0T3B0aW9ucyhvcHRpb25zKTtcbiAgICAgIGlmICghdmFsaWRhdGlvbikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgZXhwb3J0IG9wdGlvbnNgKTtcbiAgICAgIH1cblxuICAgICAgLy8gRHluYW1pYyBpbXBvcnQgb2YgaHRtbDJjYW52YXMgKG9ubHkgbG9hZCB3aGVuIG5lZWRlZClcbiAgICAgIGNvbnN0IGh0bWwyY2FudmFzID0gYXdhaXQgdGhpcy5sb2FkSHRtbDJDYW52YXMoKTtcblxuICAgICAgLy8gUHJlcGFyZSBlbGVtZW50IGZvciBjYXB0dXJlXG4gICAgICBjb25zdCBwcmVwYXJlZEVsZW1lbnQgPSB0aGlzLnByZXBhcmVFbGVtZW50Rm9yQ2FwdHVyZShwYWdlRWxlbWVudCk7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBkaW1lbnNpb25zXG4gICAgICBjb25zdCBkaW1lbnNpb25zID0gdGhpcy5jYWxjdWxhdGVDYXB0dXJlRGltZW5zaW9ucyhcbiAgICAgICAgcHJlcGFyZWRFbGVtZW50LFxuICAgICAgICBvcHRpb25zXG4gICAgICApO1xuXG4gICAgICAvLyBDYXB0dXJlIHRoZSBlbGVtZW50XG4gICAgICBjb25zdCBjYW52YXMgPSBhd2FpdCBodG1sMmNhbnZhcyhwcmVwYXJlZEVsZW1lbnQsIHtcbiAgICAgICAgd2lkdGg6IGRpbWVuc2lvbnMud2lkdGgsXG4gICAgICAgIGhlaWdodDogZGltZW5zaW9ucy5oZWlnaHQsXG4gICAgICAgIHNjYWxlOiBvcHRpb25zLnNjYWxlLFxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IG9wdGlvbnMuYmFja2dyb3VuZENvbG9yIHx8IFwiI2ZmZmZmZlwiLFxuICAgICAgICB1c2VDT1JTOiB0cnVlLFxuICAgICAgICBhbGxvd1RhaW50OiBmYWxzZSxcbiAgICAgICAgcmVtb3ZlQ29udGFpbmVyOiB0cnVlLFxuICAgICAgICBsb2dnaW5nOiBmYWxzZSxcbiAgICAgICAgLy8gSGlnaCBxdWFsaXR5IHJlbmRlcmluZ1xuICAgICAgICBzY3JvbGxYOiAwLFxuICAgICAgICBzY3JvbGxZOiAwLFxuICAgICAgICB3aW5kb3dXaWR0aDogZGltZW5zaW9ucy53aWR0aCxcbiAgICAgICAgd2luZG93SGVpZ2h0OiBkaW1lbnNpb25zLmhlaWdodCxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDb252ZXJ0IGNhbnZhcyB0byBibG9iXG4gICAgICBjb25zdCBibG9iID0gYXdhaXQgdGhpcy5jYW52YXNUb0Jsb2IoY2FudmFzLCBvcHRpb25zKTtcblxuICAgICAgY29uc3QgcHJvY2Vzc2luZ1RpbWUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc2VxdWVuY2VJZDogXCJwYWdlLWV4cG9ydFwiLFxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBibG9iLFxuICAgICAgICBmaWxlbmFtZTogdGhpcy5nZW5lcmF0ZUZpbGVuYW1lKG9wdGlvbnMuZm9ybWF0KSxcbiAgICAgICAgbWV0cmljczoge1xuICAgICAgICAgIHByb2Nlc3NpbmdUaW1lLFxuICAgICAgICAgIGZpbGVTaXplOiBibG9iLnNpemUsXG4gICAgICAgICAgcmVzb2x1dGlvbjogeyB3aWR0aDogY2FudmFzLndpZHRoLCBoZWlnaHQ6IGNhbnZhcy5oZWlnaHQgfSxcbiAgICAgICAgfSxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBmb3JtYXQ6IG9wdGlvbnMuZm9ybWF0LFxuICAgICAgICAgIHNpemU6IGJsb2Iuc2l6ZSxcbiAgICAgICAgICBkaW1lbnNpb25zOiB7XG4gICAgICAgICAgICB3aWR0aDogY2FudmFzLndpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiBjYW52YXMuaGVpZ2h0LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcHJvY2Vzc2luZ1RpbWUsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBwcm9jZXNzaW5nVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzZXF1ZW5jZUlkOiBcInBhZ2UtZXhwb3J0XCIsXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBmaWxlbmFtZTogdGhpcy5nZW5lcmF0ZUZpbGVuYW1lKG9wdGlvbnMuZm9ybWF0KSxcbiAgICAgICAgZXJyb3I6IGVycm9yIGFzIEVycm9yLFxuICAgICAgICBtZXRyaWNzOiB7XG4gICAgICAgICAgcHJvY2Vzc2luZ1RpbWUsXG4gICAgICAgICAgZmlsZVNpemU6IDAsXG4gICAgICAgICAgcmVzb2x1dGlvbjogeyB3aWR0aDogMCwgaGVpZ2h0OiAwIH0sXG4gICAgICAgIH0sXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgZm9ybWF0OiBvcHRpb25zLmZvcm1hdCxcbiAgICAgICAgICBzaXplOiAwLFxuICAgICAgICAgIHByb2Nlc3NpbmdUaW1lLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBleHBvcnRQYWdlc0FzSW1hZ2VzKFxuICAgIHBhZ2VFbGVtZW50czogSFRNTEVsZW1lbnRbXSxcbiAgICBvcHRpb25zOiBJbWFnZUV4cG9ydE9wdGlvbnMsXG4gICAgb25Qcm9ncmVzcz86IChwcm9ncmVzczogRXhwb3J0UHJvZ3Jlc3MpID0+IHZvaWRcbiAgKTogUHJvbWlzZTxCYXRjaEV4cG9ydFJlc3VsdD4ge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgIGNvbnN0IHJlc3VsdHM6IFNlcnZpY2VFeHBvcnRSZXN1bHRbXSA9IFtdO1xuICAgIGNvbnN0IGVycm9yczogRXJyb3JbXSA9IFtdO1xuICAgIGxldCBzdWNjZXNzQ291bnQgPSAwO1xuICAgIGxldCBmYWlsdXJlQ291bnQgPSAwO1xuXG4gICAgLy8gQ3JlYXRlIGFib3J0IGNvbnRyb2xsZXIgZm9yIGNhbmNlbGxhdGlvblxuICAgIHRoaXMuYWJvcnRDb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIExvYWQgaHRtbDJjYW52YXMgb25jZSBmb3IgYmF0Y2ggb3BlcmF0aW9uXG4gICAgICBjb25zdCBodG1sMmNhbnZhcyA9IGF3YWl0IHRoaXMubG9hZEh0bWwyQ2FudmFzKCk7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFnZUVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIC8vIENoZWNrIGZvciBjYW5jZWxsYXRpb25cbiAgICAgICAgaWYgKHRoaXMuYWJvcnRDb250cm9sbGVyLnNpZ25hbC5hYm9ydGVkKSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBVcGRhdGUgcHJvZ3Jlc3NcbiAgICAgICAgY29uc3QgcHJvZ3Jlc3M6IEV4cG9ydFByb2dyZXNzID0ge1xuICAgICAgICAgIGN1cnJlbnQ6IGkgKyAxLFxuICAgICAgICAgIHRvdGFsOiBwYWdlRWxlbWVudHMubGVuZ3RoLFxuICAgICAgICAgIGN1cnJlbnRJdGVtOiBpICsgMSxcbiAgICAgICAgICB0b3RhbEl0ZW1zOiBwYWdlRWxlbWVudHMubGVuZ3RoLFxuICAgICAgICAgIHBlcmNlbnRhZ2U6ICgoaSArIDEpIC8gcGFnZUVsZW1lbnRzLmxlbmd0aCkgKiAxMDAsXG4gICAgICAgICAgY3VycmVudFBhZ2U6IGkgKyAxLFxuICAgICAgICAgIGN1cnJlbnRPcGVyYXRpb246IGBFeHBvcnRpbmcgcGFnZSAke2kgKyAxfSBvZiAke3BhZ2VFbGVtZW50cy5sZW5ndGh9YCxcbiAgICAgICAgICBlc3RpbWF0ZWRUaW1lUmVtYWluaW5nOiB0aGlzLmVzdGltYXRlVGltZVJlbWFpbmluZyhcbiAgICAgICAgICAgIGkgKyAxLFxuICAgICAgICAgICAgcGFnZUVsZW1lbnRzLmxlbmd0aCxcbiAgICAgICAgICAgIHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lXG4gICAgICAgICAgKSxcbiAgICAgICAgICBpc0NvbXBsZXRlOiBpICsgMSA9PT0gcGFnZUVsZW1lbnRzLmxlbmd0aCxcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLmN1cnJlbnRQcm9ncmVzcyA9IHByb2dyZXNzO1xuICAgICAgICBvblByb2dyZXNzPy4ocHJvZ3Jlc3MpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5leHBvcnRTaW5nbGVQYWdlV2l0aENhbnZhcyhcbiAgICAgICAgICAgIHBhZ2VFbGVtZW50c1tpXSxcbiAgICAgICAgICAgIGh0bWwyY2FudmFzLFxuICAgICAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgICAgIGkgKyAxXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIHJlc3VsdHMucHVzaChyZXN1bHQpO1xuXG4gICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICBzdWNjZXNzQ291bnQrKztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZmFpbHVyZUNvdW50Kys7XG4gICAgICAgICAgICBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICAgICAgICAgIGVycm9ycy5wdXNoKHJlc3VsdC5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGZhaWx1cmVDb3VudCsrO1xuICAgICAgICAgIGNvbnN0IGVyciA9IGVycm9yIGFzIEVycm9yO1xuICAgICAgICAgIGVycm9ycy5wdXNoKGVycik7XG5cbiAgICAgICAgICByZXN1bHRzLnB1c2goe1xuICAgICAgICAgICAgc2VxdWVuY2VJZDogYHBhZ2UtJHtpICsgMX1gLFxuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBmaWxlbmFtZTogdGhpcy5nZW5lcmF0ZUZpbGVuYW1lKG9wdGlvbnMuZm9ybWF0LCBpICsgMSksXG4gICAgICAgICAgICBlcnJvcjogZXJyLFxuICAgICAgICAgICAgbWV0cmljczoge1xuICAgICAgICAgICAgICBwcm9jZXNzaW5nVGltZTogMCxcbiAgICAgICAgICAgICAgZmlsZVNpemU6IDAsXG4gICAgICAgICAgICAgIHJlc29sdXRpb246IHsgd2lkdGg6IDAsIGhlaWdodDogMCB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgIGZvcm1hdDogb3B0aW9ucy5mb3JtYXQsXG4gICAgICAgICAgICAgIHNpemU6IDAsXG4gICAgICAgICAgICAgIHByb2Nlc3NpbmdUaW1lOiAwLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJyaWVmIHBhdXNlIHRvIGFsbG93IFVJIHVwZGF0ZXMgYW5kIHByZXZlbnQgYmxvY2tpbmdcbiAgICAgICAgYXdhaXQgdGhpcy5wYXVzZUZvclVJKCk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGVycm9ycy5wdXNoKGVycm9yIGFzIEVycm9yKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5hYm9ydENvbnRyb2xsZXIgPSBudWxsO1xuICAgICAgdGhpcy5jdXJyZW50UHJvZ3Jlc3MgPSBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IHRvdGFsUHJvY2Vzc2luZ1RpbWUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZTtcblxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgdG90YWxQYWdlczogcGFnZUVsZW1lbnRzLmxlbmd0aCxcbiAgICAgIHN1Y2Nlc3NDb3VudCxcbiAgICAgIGZhaWx1cmVDb3VudCxcbiAgICAgIHJlc3VsdHMsXG4gICAgICB0b3RhbFByb2Nlc3NpbmdUaW1lLFxuICAgICAgZXJyb3JzLFxuICAgIH07XG4gIH1cblxuICBjYWxjdWxhdGVPcHRpbWFsRGltZW5zaW9ucyhcbiAgICBwYWdlRWxlbWVudDogSFRNTEVsZW1lbnQsXG4gICAgdGFyZ2V0RFBJOiBudW1iZXJcbiAgKTogeyB3aWR0aDogbnVtYmVyOyBoZWlnaHQ6IG51bWJlciB9IHtcbiAgICBjb25zdCByZWN0ID0gcGFnZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgY29uc3Qgc2NhbGVGYWN0b3IgPSB0YXJnZXREUEkgLyA5NjsgLy8gOTYgRFBJIGlzIHN0YW5kYXJkIHNjcmVlbiBEUElcblxuICAgIHJldHVybiB7XG4gICAgICB3aWR0aDogTWF0aC5yb3VuZChyZWN0LndpZHRoICogc2NhbGVGYWN0b3IpLFxuICAgICAgaGVpZ2h0OiBNYXRoLnJvdW5kKHJlY3QuaGVpZ2h0ICogc2NhbGVGYWN0b3IpLFxuICAgIH07XG4gIH1cblxuICB2YWxpZGF0ZUV4cG9ydE9wdGlvbnMob3B0aW9uczogSW1hZ2VFeHBvcnRPcHRpb25zKTogYm9vbGVhbiB7XG4gICAgLy8gVmFsaWRhdGUgZm9ybWF0XG4gICAgaWYgKCFbXCJQTkdcIiwgXCJKUEVHXCIsIFwiV2ViUFwiXS5pbmNsdWRlcyhvcHRpb25zLmZvcm1hdCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSBxdWFsaXR5XG4gICAgaWYgKG9wdGlvbnMucXVhbGl0eSA8IDAgfHwgb3B0aW9ucy5xdWFsaXR5ID4gMSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIHNjYWxlXG4gICAgaWYgKG9wdGlvbnMuc2NhbGUgPD0gMCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIGRpbWVuc2lvbnMgaWYgcHJvdmlkZWRcbiAgICBpZiAob3B0aW9ucy53aWR0aCAmJiBvcHRpb25zLndpZHRoIDw9IDApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAob3B0aW9ucy5oZWlnaHQgJiYgb3B0aW9ucy5oZWlnaHQgPD0gMCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgZ2V0U3VwcG9ydGVkRm9ybWF0cygpOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIFtcIlBOR1wiLCBcIkpQRUdcIiwgXCJXZWJQXCJdO1xuICB9XG5cbiAgZ2V0UmVjb21tZW5kZWRTZXR0aW5ncyhcbiAgICB1c2VDYXNlOiBcInByaW50XCIgfCBcIndlYlwiIHwgXCJhcmNoaXZlXCJcbiAgKTogSW1hZ2VFeHBvcnRPcHRpb25zIHtcbiAgICBjb25zdCBiYXNlT3B0aW9ucyA9IHtcbiAgICAgIHF1YWxpdHk6IDAuOSxcbiAgICAgIHNjYWxlOiAxLjAsXG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwiI2ZmZmZmZlwiLFxuICAgIH07XG5cbiAgICBzd2l0Y2ggKHVzZUNhc2UpIHtcbiAgICAgIGNhc2UgXCJwcmludFwiOlxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLmJhc2VPcHRpb25zLFxuICAgICAgICAgIGZvcm1hdDogXCJQTkdcIiBhcyBjb25zdCxcbiAgICAgICAgICBzY2FsZTogMi4wLFxuICAgICAgICAgIHF1YWxpdHk6IDEuMCxcbiAgICAgICAgfTtcbiAgICAgIGNhc2UgXCJ3ZWJcIjpcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5iYXNlT3B0aW9ucyxcbiAgICAgICAgICBmb3JtYXQ6IFwiSlBFR1wiIGFzIGNvbnN0LFxuICAgICAgICAgIHNjYWxlOiAxLjAsXG4gICAgICAgICAgcXVhbGl0eTogMC44LFxuICAgICAgICB9O1xuICAgICAgY2FzZSBcImFyY2hpdmVcIjpcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5iYXNlT3B0aW9ucyxcbiAgICAgICAgICBmb3JtYXQ6IFwiUE5HXCIgYXMgY29uc3QsXG4gICAgICAgICAgc2NhbGU6IDEuNSxcbiAgICAgICAgICBxdWFsaXR5OiAxLjAsXG4gICAgICAgIH07XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLmJhc2VPcHRpb25zLFxuICAgICAgICAgIGZvcm1hdDogXCJQTkdcIiBhcyBjb25zdCxcbiAgICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvLyBDYW5jZWwgb25nb2luZyBleHBvcnRcbiAgY2FuY2VsRXhwb3J0KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmFib3J0Q29udHJvbGxlcikge1xuICAgICAgdGhpcy5hYm9ydENvbnRyb2xsZXIuYWJvcnQoKTtcbiAgICB9XG4gIH1cblxuICAvLyBHZXQgY3VycmVudCBwcm9ncmVzc1xuICBnZXRDdXJyZW50UHJvZ3Jlc3MoKTogRXhwb3J0UHJvZ3Jlc3MgfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50UHJvZ3Jlc3M7XG4gIH1cblxuICAvLyBQcml2YXRlIGhlbHBlciBtZXRob2RzXG5cbiAgcHJpdmF0ZSBhc3luYyBsb2FkSHRtbDJDYW52YXMoKTogUHJvbWlzZTxIdG1sMkNhbnZhc0Z1bmN0aW9uPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFRyeSB0byBsb2FkIGZyb20gQ0ROXG4gICAgICBpZiAoXG4gICAgICAgIHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgJiZcbiAgICAgICAgISh3aW5kb3cgYXMgV2luZG93V2l0aEh0bWwyQ2FudmFzKS5odG1sMmNhbnZhc1xuICAgICAgKSB7XG4gICAgICAgIC8vIER5bmFtaWNhbGx5IGxvYWQgaHRtbDJjYW52YXMgZnJvbSBDRE5cbiAgICAgICAgY29uc3Qgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcbiAgICAgICAgc2NyaXB0LnNyYyA9XG4gICAgICAgICAgXCJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9odG1sMmNhbnZhcy8xLjQuMS9odG1sMmNhbnZhcy5taW4uanNcIjtcblxuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgc2NyaXB0Lm9ubG9hZCA9IHJlc29sdmU7XG4gICAgICAgICAgc2NyaXB0Lm9uZXJyb3IgPSByZWplY3Q7XG4gICAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgaHRtbDJjYW52YXMgPSAod2luZG93IGFzIFdpbmRvd1dpdGhIdG1sMkNhbnZhcykuaHRtbDJjYW52YXM7XG4gICAgICBpZiAoIWh0bWwyY2FudmFzKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImh0bWwyY2FudmFzIGZhaWxlZCB0byBsb2FkXCIpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gaHRtbDJjYW52YXM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgXCJGYWlsZWQgdG8gbG9hZCBodG1sMmNhbnZhcyBsaWJyYXJ5LiBDaGVjayBpbnRlcm5ldCBjb25uZWN0aW9uLlwiXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgcHJlcGFyZUVsZW1lbnRGb3JDYXB0dXJlKGVsZW1lbnQ6IEhUTUxFbGVtZW50KTogSFRNTEVsZW1lbnQge1xuICAgIC8vIENsb25lIHRoZSBlbGVtZW50IHRvIGF2b2lkIG1vZGlmeWluZyB0aGUgb3JpZ2luYWxcbiAgICBjb25zdCBjbG9uZWRFbGVtZW50ID0gZWxlbWVudC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnQ7XG5cbiAgICAvLyBBcHBseSBjYXB0dXJlLXNwZWNpZmljIHN0eWxlc1xuICAgIGNsb25lZEVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSBcInN0YXRpY1wiO1xuICAgIGNsb25lZEVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gXCJub25lXCI7XG4gICAgY2xvbmVkRWxlbWVudC5zdHlsZS5tYXJnaW4gPSBcIjBcIjtcbiAgICBjbG9uZWRFbGVtZW50LnN0eWxlLnBhZGRpbmcgPSBcIjBcIjtcblxuICAgIC8vIEVuc3VyZSBhbGwgaW1hZ2VzIGFyZSBsb2FkZWRcbiAgICBjb25zdCBpbWFnZXMgPSBjbG9uZWRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbWdcIik7XG4gICAgaW1hZ2VzLmZvckVhY2goKGltZykgPT4ge1xuICAgICAgaWYgKCFpbWcuY29tcGxldGUpIHtcbiAgICAgICAgLy8gUmVwbGFjZSB3aXRoIHBsYWNlaG9sZGVyIGlmIGltYWdlIG5vdCBsb2FkZWRcbiAgICAgICAgaW1nLnNyYyA9XG4gICAgICAgICAgXCJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUIzYVdSMGFEMGlNVEF3SWlCb1pXbG5hSFE5SWpFd01DSWdlRzFzYm5NOUltaDBkSEE2THk5M2QzY3Vkek11YjNKbkx6SXdNREF2YzNabklqNDhjbVZqZENCM2FXUjBhRDBpTVRBd0lpQm9aV2xuYUhROUlqRXdNQ0lnWm1sc2JEMGlJMlZsWlNJdlBqeDBaWGgwSUhnOUlqVXdJaUI1UFNJMU1DSWdabTl1ZEMxbVlXMXBiSGs5SWtGeWFXRnNJaUJtYjI1MExYTnBlbVU5SWpFeUlpQm1hV3hzUFNJak9UazVJaUIwWlhoMExXRnVZMmh2Y2owaWJXbGtaR3hsSWlCa2VUMGlMak5sYlNJK1NXMWhaMlU4TDNSbGVIUStQQzl6ZG1jK1wiO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGNsb25lZEVsZW1lbnQ7XG4gIH1cblxuICBwcml2YXRlIGNhbGN1bGF0ZUNhcHR1cmVEaW1lbnNpb25zKFxuICAgIGVsZW1lbnQ6IEhUTUxFbGVtZW50LFxuICAgIG9wdGlvbnM6IEltYWdlRXhwb3J0T3B0aW9uc1xuICApOiB7IHdpZHRoOiBudW1iZXI7IGhlaWdodDogbnVtYmVyIH0ge1xuICAgIGNvbnN0IHJlY3QgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgaWYgKG9wdGlvbnMud2lkdGggJiYgb3B0aW9ucy5oZWlnaHQpIHtcbiAgICAgIHJldHVybiB7IHdpZHRoOiBvcHRpb25zLndpZHRoLCBoZWlnaHQ6IG9wdGlvbnMuaGVpZ2h0IH07XG4gICAgfVxuXG4gICAgaWYgKG9wdGlvbnMud2lkdGgpIHtcbiAgICAgIGNvbnN0IGFzcGVjdFJhdGlvID0gcmVjdC5oZWlnaHQgLyByZWN0LndpZHRoO1xuICAgICAgcmV0dXJuIHsgd2lkdGg6IG9wdGlvbnMud2lkdGgsIGhlaWdodDogb3B0aW9ucy53aWR0aCAqIGFzcGVjdFJhdGlvIH07XG4gICAgfVxuXG4gICAgaWYgKG9wdGlvbnMuaGVpZ2h0KSB7XG4gICAgICBjb25zdCBhc3BlY3RSYXRpbyA9IHJlY3Qud2lkdGggLyByZWN0LmhlaWdodDtcbiAgICAgIHJldHVybiB7IHdpZHRoOiBvcHRpb25zLmhlaWdodCAqIGFzcGVjdFJhdGlvLCBoZWlnaHQ6IG9wdGlvbnMuaGVpZ2h0IH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgd2lkdGg6IHJlY3Qud2lkdGgsIGhlaWdodDogcmVjdC5oZWlnaHQgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgY2FudmFzVG9CbG9iKFxuICAgIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsXG4gICAgb3B0aW9uczogSW1hZ2VFeHBvcnRPcHRpb25zXG4gICk6IFByb21pc2U8QmxvYj4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjb25zdCBtaW1lVHlwZSA9IHRoaXMuZ2V0TWltZVR5cGUob3B0aW9ucy5mb3JtYXQpO1xuICAgICAgY29uc3QgcXVhbGl0eSA9IG9wdGlvbnMuZm9ybWF0ID09PSBcIlBOR1wiID8gdW5kZWZpbmVkIDogb3B0aW9ucy5xdWFsaXR5O1xuXG4gICAgICBjYW52YXMudG9CbG9iKFxuICAgICAgICAoYmxvYikgPT4ge1xuICAgICAgICAgIGlmIChibG9iKSB7XG4gICAgICAgICAgICByZXNvbHZlKGJsb2IpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBibG9iIGZyb20gY2FudmFzXCIpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG1pbWVUeXBlLFxuICAgICAgICBxdWFsaXR5XG4gICAgICApO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRNaW1lVHlwZShmb3JtYXQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgc3dpdGNoIChmb3JtYXQpIHtcbiAgICAgIGNhc2UgXCJQTkdcIjpcbiAgICAgICAgcmV0dXJuIFwiaW1hZ2UvcG5nXCI7XG4gICAgICBjYXNlIFwiSlBFR1wiOlxuICAgICAgICByZXR1cm4gXCJpbWFnZS9qcGVnXCI7XG4gICAgICBjYXNlIFwiV2ViUFwiOlxuICAgICAgICByZXR1cm4gXCJpbWFnZS93ZWJwXCI7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gXCJpbWFnZS9wbmdcIjtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlRmlsZW5hbWUoZm9ybWF0OiBzdHJpbmcsIHBhZ2VOdW1iZXI/OiBudW1iZXIpOiBzdHJpbmcge1xuICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zbGljZSgwLCAxOSkucmVwbGFjZSgvOi9nLCBcIi1cIik7XG4gICAgY29uc3QgcGFnZSA9IHBhZ2VOdW1iZXIgPyBgLXBhZ2UtJHtwYWdlTnVtYmVyfWAgOiBcIlwiO1xuICAgIGNvbnN0IGV4dCA9IGZvcm1hdC50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiBgc2VxdWVuY2UtY2FyZHMke3BhZ2V9LSR7dGltZXN0YW1wfS4ke2V4dH1gO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBleHBvcnRTaW5nbGVQYWdlV2l0aENhbnZhcyhcbiAgICBwYWdlRWxlbWVudDogSFRNTEVsZW1lbnQsXG4gICAgaHRtbDJjYW52YXM6IEh0bWwyQ2FudmFzRnVuY3Rpb24sXG4gICAgb3B0aW9uczogSW1hZ2VFeHBvcnRPcHRpb25zLFxuICAgIHBhZ2VOdW1iZXI6IG51bWJlclxuICApOiBQcm9taXNlPFNlcnZpY2VFeHBvcnRSZXN1bHQ+IHtcbiAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBwcmVwYXJlZEVsZW1lbnQgPSB0aGlzLnByZXBhcmVFbGVtZW50Rm9yQ2FwdHVyZShwYWdlRWxlbWVudCk7XG4gICAgICBjb25zdCBkaW1lbnNpb25zID0gdGhpcy5jYWxjdWxhdGVDYXB0dXJlRGltZW5zaW9ucyhcbiAgICAgICAgcHJlcGFyZWRFbGVtZW50LFxuICAgICAgICBvcHRpb25zXG4gICAgICApO1xuXG4gICAgICBjb25zdCBjYW52YXMgPSBhd2FpdCBodG1sMmNhbnZhcyhwcmVwYXJlZEVsZW1lbnQsIHtcbiAgICAgICAgd2lkdGg6IGRpbWVuc2lvbnMud2lkdGgsXG4gICAgICAgIGhlaWdodDogZGltZW5zaW9ucy5oZWlnaHQsXG4gICAgICAgIHNjYWxlOiBvcHRpb25zLnNjYWxlLFxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IG9wdGlvbnMuYmFja2dyb3VuZENvbG9yIHx8IFwiI2ZmZmZmZlwiLFxuICAgICAgICB1c2VDT1JTOiB0cnVlLFxuICAgICAgICBhbGxvd1RhaW50OiBmYWxzZSxcbiAgICAgICAgcmVtb3ZlQ29udGFpbmVyOiB0cnVlLFxuICAgICAgICBsb2dnaW5nOiBmYWxzZSxcbiAgICAgICAgc2Nyb2xsWDogMCxcbiAgICAgICAgc2Nyb2xsWTogMCxcbiAgICAgICAgd2luZG93V2lkdGg6IGRpbWVuc2lvbnMud2lkdGgsXG4gICAgICAgIHdpbmRvd0hlaWdodDogZGltZW5zaW9ucy5oZWlnaHQsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IHRoaXMuY2FudmFzVG9CbG9iKGNhbnZhcywgb3B0aW9ucyk7XG4gICAgICBjb25zdCBwcm9jZXNzaW5nVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzZXF1ZW5jZUlkOiBgcGFnZS0ke3BhZ2VOdW1iZXJ9YCxcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgYmxvYixcbiAgICAgICAgZmlsZW5hbWU6IHRoaXMuZ2VuZXJhdGVGaWxlbmFtZShvcHRpb25zLmZvcm1hdCwgcGFnZU51bWJlciksXG4gICAgICAgIG1ldHJpY3M6IHtcbiAgICAgICAgICBwcm9jZXNzaW5nVGltZSxcbiAgICAgICAgICBmaWxlU2l6ZTogYmxvYi5zaXplLFxuICAgICAgICAgIHJlc29sdXRpb246IHsgd2lkdGg6IGNhbnZhcy53aWR0aCwgaGVpZ2h0OiBjYW52YXMuaGVpZ2h0IH0sXG4gICAgICAgIH0sXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgZm9ybWF0OiBvcHRpb25zLmZvcm1hdCxcbiAgICAgICAgICBzaXplOiBibG9iLnNpemUsXG4gICAgICAgICAgZGltZW5zaW9uczoge1xuICAgICAgICAgICAgd2lkdGg6IGNhbnZhcy53aWR0aCxcbiAgICAgICAgICAgIGhlaWdodDogY2FudmFzLmhlaWdodCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHByb2Nlc3NpbmdUaW1lLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgcHJvY2Vzc2luZ1RpbWUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc2VxdWVuY2VJZDogYHBhZ2UtJHtwYWdlTnVtYmVyfWAsXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBmaWxlbmFtZTogdGhpcy5nZW5lcmF0ZUZpbGVuYW1lKG9wdGlvbnMuZm9ybWF0LCBwYWdlTnVtYmVyKSxcbiAgICAgICAgZXJyb3I6IGVycm9yIGFzIEVycm9yLFxuICAgICAgICBtZXRyaWNzOiB7XG4gICAgICAgICAgcHJvY2Vzc2luZ1RpbWUsXG4gICAgICAgICAgZmlsZVNpemU6IDAsXG4gICAgICAgICAgcmVzb2x1dGlvbjogeyB3aWR0aDogMCwgaGVpZ2h0OiAwIH0sXG4gICAgICAgIH0sXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgZm9ybWF0OiBvcHRpb25zLmZvcm1hdCxcbiAgICAgICAgICBzaXplOiAwLFxuICAgICAgICAgIHByb2Nlc3NpbmdUaW1lLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGVzdGltYXRlVGltZVJlbWFpbmluZyhcbiAgICBjdXJyZW50OiBudW1iZXIsXG4gICAgdG90YWw6IG51bWJlcixcbiAgICBlbGFwc2VkVGltZTogbnVtYmVyXG4gICk6IG51bWJlciB7XG4gICAgaWYgKGN1cnJlbnQgPT09IDApIHJldHVybiAwO1xuXG4gICAgY29uc3QgYXZlcmFnZVRpbWVQZXJJdGVtID0gZWxhcHNlZFRpbWUgLyBjdXJyZW50O1xuICAgIGNvbnN0IHJlbWFpbmluZ0l0ZW1zID0gdG90YWwgLSBjdXJyZW50O1xuICAgIHJldHVybiByZW1haW5pbmdJdGVtcyAqIGF2ZXJhZ2VUaW1lUGVySXRlbTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcGF1c2VGb3JVSSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTApKTtcbiAgfVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIkFBc0NPLGFBQU0sdUJBQTBEO0FBQUEsRUFDN0Qsa0JBQTBDO0FBQUEsRUFDMUMsa0JBQXlDO0FBQUEsRUFFakQsTUFBTSxrQkFDSixhQUNBLFNBQzhCO0FBQzlCLFVBQU0sWUFBWSxZQUFZLElBQUk7QUFFbEMsUUFBSTtBQUVGLFlBQU0sYUFBYSxLQUFLLHNCQUFzQixPQUFPO0FBQ3JELFVBQUksQ0FBQyxZQUFZO0FBQ2YsY0FBTSxJQUFJLE1BQU0sd0JBQXdCO0FBQUEsTUFDMUM7QUFHQSxZQUFNLGNBQWMsTUFBTSxLQUFLLGdCQUFnQjtBQUcvQyxZQUFNLGtCQUFrQixLQUFLLHlCQUF5QixXQUFXO0FBR2pFLFlBQU0sYUFBYSxLQUFLO0FBQUEsUUFDdEI7QUFBQSxRQUNBO0FBQUEsTUFDRjtBQUdBLFlBQU0sU0FBUyxNQUFNLFlBQVksaUJBQWlCO0FBQUEsUUFDaEQsT0FBTyxXQUFXO0FBQUEsUUFDbEIsUUFBUSxXQUFXO0FBQUEsUUFDbkIsT0FBTyxRQUFRO0FBQUEsUUFDZixpQkFBaUIsUUFBUSxtQkFBbUI7QUFBQSxRQUM1QyxTQUFTO0FBQUEsUUFDVCxZQUFZO0FBQUEsUUFDWixpQkFBaUI7QUFBQSxRQUNqQixTQUFTO0FBQUE7QUFBQSxRQUVULFNBQVM7QUFBQSxRQUNULFNBQVM7QUFB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
