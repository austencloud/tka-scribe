export class DeviceDetectionService {
  capabilities = null;
  listeners = [];
  resizeObserver = null;
  constructor() {
    this.detectCapabilities();
    this.setupListeners();
  }
  getCapabilities() {
    if (!this.capabilities) {
      this.detectCapabilities();
    }
    if (!this.capabilities) {
      throw new Error("Failed to detect device capabilities");
    }
    return this.capabilities;
  }
  getResponsiveSettings() {
    const caps = this.getCapabilities();
    const minTouchTarget = caps.primaryInput === "touch" ? 48 : 32;
    const elementSpacing = caps.primaryInput === "touch" ? 16 : 8;
    const allowScrolling = caps.screenSize === "mobile" || caps.screenSize === "tablet";
    let layoutDensity = "comfortable";
    if (caps.screenSize === "mobile") {
      layoutDensity = "comfortable";
    } else if (caps.screenSize === "desktop" && caps.primaryInput === "mouse") {
      layoutDensity = "compact";
    } else {
      layoutDensity = "spacious";
    }
    const fontScaling = caps.screenSize === "mobile" ? 1.1 : 1;
    return {
      minTouchTarget,
      elementSpacing,
      allowScrolling,
      layoutDensity,
      fontScaling
    };
  }
  isTouchPrimary() {
    return this.getCapabilities().primaryInput === "touch";
  }
  shouldOptimizeForTouch() {
    const caps = this.getCapabilities();
    return caps.primaryInput === "touch" || caps.primaryInput === "hybrid";
  }
  getCurrentBreakpoint() {
    const { width } = this.getCapabilities().viewport;
    if (width < 768) return "mobile";
    if (width < 1024) return "tablet";
    if (width < 1440) return "desktop";
    return "large-desktop";
  }
  onCapabilitiesChanged(callback) {
    this.listeners.push(callback);
    return () => {
      const index = this.listeners.indexOf(callback);
      if (index > -1) {
        this.listeners.splice(index, 1);
      }
    };
  }
  detectCapabilities() {
    const viewport = {
      width: window.innerWidth,
      height: window.innerHeight
    };
    const hasTouch = this.detectTouch();
    const hasPrecisePointer = this.detectPrecisePointer();
    const hasKeyboard = this.detectKeyboard();
    const screenSize = this.determineScreenSize(viewport.width);
    const primaryInput = this.determinePrimaryInput(
      hasTouch,
      hasPrecisePointer,
      screenSize
    );
    this.capabilities = {
      primaryInput,
      screenSize,
      hasTouch,
      hasPrecisePointer,
      hasKeyboard,
      viewport,
      pixelRatio: window.devicePixelRatio || 1,
      colorDepth: screen.colorDepth || 24,
      supportsHDR: this.detectHDRSupport(),
      hardwareConcurrency: navigator.hardwareConcurrency || 4,
      memoryEstimate: this.estimateMemory(),
      connectionSpeed: this.detectConnectionSpeed()
    };
    this.updateCSSProperties();
  }
  detectTouch() {
    return "ontouchstart" in window || navigator.maxTouchPoints > 0 || // Legacy IE support
    (navigator.msMaxTouchPoints ?? 0) > 0;
  }
  detectPrecisePointer() {
    return window.matchMedia("(pointer: fine)").matches;
  }
  detectKeyboard() {
    return window.matchMedia("(pointer: fine)").matches;
  }
  determineScreenSize(width) {
    if (width < 768) return "mobile";
    if (width < 1024) return "tablet";
    return "desktop";
  }
  determinePrimaryInput(hasTouch, hasPrecisePointer, screenSize) {
    if (screenSize === "mobile") return "touch";
    if (screenSize === "desktop" && !hasTouch) return "mouse";
    if (screenSize === "desktop" && hasTouch && hasPrecisePointer)
      return "hybrid";
    if (screenSize === "tablet") {
      return hasPrecisePointer ? "hybrid" : "touch";
    }
    return hasTouch ? "touch" : "mouse";
  }
  updateCSSProperties() {
    if (!this.capabilities) return;
    const settings = this.getResponsiveSettings();
    document.documentElement.style.setProperty(
      "--min-touch-target",
      `${settings.minTouchTarget}px`
    );
    document.documentElement.style.setProperty(
      "--element-spacing",
      `${settings.elementSpacing}px`
    );
    document.documentElement.style.setProperty(
      "--font-scaling",
      settings.fontScaling.toString()
    );
    document.documentElement.setAttribute(
      "data-device-type",
      this.capabilities.primaryInput
    );
    document.documentElement.setAttribute(
      "data-screen-size",
      this.capabilities.screenSize
    );
    document.documentElement.setAttribute(
      "data-layout-density",
      settings.layoutDensity
    );
  }
  setupListeners() {
    const handleResize = () => {
      const oldCapabilities = this.capabilities;
      this.detectCapabilities();
      if (this.hasCapabilitiesChanged(oldCapabilities, this.capabilities)) {
        this.notifyListeners();
      }
    };
    const handleOrientationChange = () => {
      setTimeout(handleResize, 100);
    };
    window.addEventListener("resize", handleResize);
    window.addEventListener("orientationchange", handleOrientationChange);
    if ("ResizeObserver" in window) {
      this.resizeObserver = new ResizeObserver(handleResize);
      this.resizeObserver.observe(document.documentElement);
    }
    let hasDetectedMouse = false;
    const handleMouseMove = () => {
      if (!hasDetectedMouse) {
        hasDetectedMouse = true;
        const oldCapabilities = this.capabilities;
        this.detectCapabilities();
        if (this.hasCapabilitiesChanged(oldCapabilities, this.capabilities)) {
          this.notifyListeners();
        }
      }
    };
    window.addEventListener("mousemove", handleMouseMove, { once: true });
  }
  hasCapabilitiesChanged(old, current) {
    if (!old || !current) return true;
    return old.primaryInput !== current.primaryInput || old.screenSize !== current.screenSize || old.viewport.width !== current.viewport.width || old.viewport.height !== current.viewport.height;
  }
  notifyListeners() {
    if (this.capabilities) {
      const capabilities = this.capabilities;
      this.listeners.forEach((callback) => callback(capabilities));
    }
  }
  // Cleanup method for proper disposal
  dispose() {
    this.listeners = [];
    if (this.resizeObserver) {
      this.resizeObserver.disconnect();
      this.resizeObserver = null;
    }
  }
  detectHDRSupport() {
    if (typeof window !== "undefined" && window.matchMedia) {
      return window.matchMedia("(dynamic-range: high)").matches || window.matchMedia("(color-gamut: p3)").matches;
    }
    return false;
  }
  estimateMemory() {
    if ("deviceMemory" in navigator) {
      return navigator.deviceMemory * 1024;
    }
    const hardwareConcurrency = navigator.hardwareConcurrency || 4;
    if (hardwareConcurrency >= 8) return 8192;
    if (hardwareConcurrency >= 4) return 4096;
    return 2048;
  }
  detectConnectionSpeed() {
    if ("connection" in navigator) {
      const connection = navigator.connection;
      if (connection.effectiveType) {
        switch (connection.effectiveType) {
          case "slow-2g":
          case "2g":
            return "slow";
          case "3g":
            return "medium";
          case "4g":
          default:
            return "fast";
        }
      }
    }
    return void 0;
  }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkRldmljZURldGVjdGlvblNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBEZXZpY2UgRGV0ZWN0aW9uIFNlcnZpY2UgSW1wbGVtZW50YXRpb25cbiAqIFVzZXMgbW9kZXJuIGRldGVjdGlvbiBtZXRob2RzIGJhc2VkIG9uIHJlc2VhcmNoIGZyb20gVzNDLCBNYXRlcmlhbCBEZXNpZ24sIGFuZCBpT1MgZ3VpZGVsaW5lc1xuICovXG5cbmltcG9ydCB0eXBlIHsgRGV2aWNlQ2FwYWJpbGl0aWVzIH0gZnJvbSBcIi4uLy4uL2ludGVyZmFjZXMvZG9tYWluLXR5cGVzXCI7XG5pbXBvcnQgdHlwZSB7XG4gIElEZXZpY2VEZXRlY3Rpb25TZXJ2aWNlLFxuICBSZXNwb25zaXZlU2V0dGluZ3MsXG59IGZyb20gXCIuLi8uLi9pbnRlcmZhY2VzL2RldmljZS1pbnRlcmZhY2VzXCI7XG5cbmV4cG9ydCBjbGFzcyBEZXZpY2VEZXRlY3Rpb25TZXJ2aWNlIGltcGxlbWVudHMgSURldmljZURldGVjdGlvblNlcnZpY2Uge1xuICBwcml2YXRlIGNhcGFiaWxpdGllczogRGV2aWNlQ2FwYWJpbGl0aWVzIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgbGlzdGVuZXJzOiBBcnJheTwoY2FwYWJpbGl0aWVzOiBEZXZpY2VDYXBhYmlsaXRpZXMpID0+IHZvaWQ+ID0gW107XG4gIHByaXZhdGUgcmVzaXplT2JzZXJ2ZXI6IFJlc2l6ZU9ic2VydmVyIHwgbnVsbCA9IG51bGw7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5kZXRlY3RDYXBhYmlsaXRpZXMoKTtcbiAgICB0aGlzLnNldHVwTGlzdGVuZXJzKCk7XG4gIH1cblxuICBnZXRDYXBhYmlsaXRpZXMoKTogRGV2aWNlQ2FwYWJpbGl0aWVzIHtcbiAgICBpZiAoIXRoaXMuY2FwYWJpbGl0aWVzKSB7XG4gICAgICB0aGlzLmRldGVjdENhcGFiaWxpdGllcygpO1xuICAgIH1cbiAgICBpZiAoIXRoaXMuY2FwYWJpbGl0aWVzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZGV0ZWN0IGRldmljZSBjYXBhYmlsaXRpZXNcIik7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmNhcGFiaWxpdGllcztcbiAgfVxuXG4gIGdldFJlc3BvbnNpdmVTZXR0aW5ncygpOiBSZXNwb25zaXZlU2V0dGluZ3Mge1xuICAgIGNvbnN0IGNhcHMgPSB0aGlzLmdldENhcGFiaWxpdGllcygpO1xuXG4gICAgLy8gQmFzZWQgb24gcmVzZWFyY2g6IG1vYmlsZSBuZWVkcyA0NC00OHB4LCBkZXNrdG9wIGNhbiBiZSBzbWFsbGVyXG4gICAgY29uc3QgbWluVG91Y2hUYXJnZXQgPSBjYXBzLnByaW1hcnlJbnB1dCA9PT0gXCJ0b3VjaFwiID8gNDggOiAzMjtcbiAgICBjb25zdCBlbGVtZW50U3BhY2luZyA9IGNhcHMucHJpbWFyeUlucHV0ID09PSBcInRvdWNoXCIgPyAxNiA6IDg7XG5cbiAgICAvLyBNb2JpbGUgdXNlcnMgZXhwZWN0IHNjcm9sbGluZywgZGVza3RvcCBzaG91bGQgZml0IHdoZW4gcG9zc2libGVcbiAgICBjb25zdCBhbGxvd1Njcm9sbGluZyA9XG4gICAgICBjYXBzLnNjcmVlblNpemUgPT09IFwibW9iaWxlXCIgfHwgY2Fwcy5zY3JlZW5TaXplID09PSBcInRhYmxldFwiO1xuXG4gICAgLy8gTGF5b3V0IGRlbnNpdHkgYmFzZWQgb24gc2NyZWVuIHJlYWwgZXN0YXRlIGFuZCBpbnB1dCBtZXRob2RcbiAgICBsZXQgbGF5b3V0RGVuc2l0eTogXCJjb21wYWN0XCIgfCBcImNvbWZvcnRhYmxlXCIgfCBcInNwYWNpb3VzXCIgPSBcImNvbWZvcnRhYmxlXCI7XG4gICAgaWYgKGNhcHMuc2NyZWVuU2l6ZSA9PT0gXCJtb2JpbGVcIikge1xuICAgICAgbGF5b3V0RGVuc2l0eSA9IFwiY29tZm9ydGFibGVcIjsgLy8gTW9iaWxlIG5lZWRzIHNwYWNlIGZvciB0b3VjaFxuICAgIH0gZWxzZSBpZiAoY2Fwcy5zY3JlZW5TaXplID09PSBcImRlc2t0b3BcIiAmJiBjYXBzLnByaW1hcnlJbnB1dCA9PT0gXCJtb3VzZVwiKSB7XG4gICAgICBsYXlvdXREZW5zaXR5ID0gXCJjb21wYWN0XCI7IC8vIERlc2t0b3Agd2l0aCBtb3VzZSBjYW4gYmUgZGVuc2VyXG4gICAgfSBlbHNlIHtcbiAgICAgIGxheW91dERlbnNpdHkgPSBcInNwYWNpb3VzXCI7IC8vIEh5YnJpZCBkZXZpY2VzIGdldCBzcGFjaW91c1xuICAgIH1cblxuICAgIGNvbnN0IGZvbnRTY2FsaW5nID0gY2Fwcy5zY3JlZW5TaXplID09PSBcIm1vYmlsZVwiID8gMS4xIDogMS4wO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIG1pblRvdWNoVGFyZ2V0LFxuICAgICAgZWxlbWVudFNwYWNpbmcsXG4gICAgICBhbGxvd1Njcm9sbGluZyxcbiAgICAgIGxheW91dERlbnNpdHksXG4gICAgICBmb250U2NhbGluZyxcbiAgICB9O1xuICB9XG5cbiAgaXNUb3VjaFByaW1hcnkoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0Q2FwYWJpbGl0aWVzKCkucHJpbWFyeUlucHV0ID09PSBcInRvdWNoXCI7XG4gIH1cblxuICBzaG91bGRPcHRpbWl6ZUZvclRvdWNoKCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGNhcHMgPSB0aGlzLmdldENhcGFiaWxpdGllcygpO1xuICAgIHJldHVybiBjYXBzLnByaW1hcnlJbnB1dCA9PT0gXCJ0b3VjaFwiIHx8IGNhcHMucHJpbWFyeUlucHV0ID09PSBcImh5YnJpZFwiO1xuICB9XG5cbiAgZ2V0Q3VycmVudEJyZWFrcG9pbnQoKTogXCJtb2JpbGVcIiB8IFwidGFibGV0XCIgfCBcImRlc2t0b3BcIiB8IFwibGFyZ2UtZGVza3RvcFwiIHtcbiAgICBjb25zdCB7IHdpZHRoIH0gPSB0aGlzLmdldENhcGFiaWxpdGllcygpLnZpZXdwb3J0O1xuXG4gICAgLy8gU3RhbmRhcmQgYnJlYWtwb2ludHMgYmFzZWQgb24gcmVzZWFyY2hcbiAgICBpZiAod2lkdGggPCA3NjgpIHJldHVybiBcIm1vYmlsZVwiO1xuICAgIGlmICh3aWR0aCA8IDEwMjQpIHJldHVybiBcInRhYmxldFwiO1xuICAgIGlmICh3aWR0aCA8IDE0NDApIHJldHVybiBcImRlc2t0b3BcIjtcbiAgICByZXR1cm4gXCJsYXJnZS1kZXNrdG9wXCI7XG4gIH1cblxuICBvbkNhcGFiaWxpdGllc0NoYW5nZWQoXG4gICAgY2FsbGJhY2s6IChjYXBhYmlsaXRpZXM6IERldmljZUNhcGFiaWxpdGllcykgPT4gdm9pZFxuICApOiAoKSA9PiB2b2lkIHtcbiAgICB0aGlzLmxpc3RlbmVycy5wdXNoKGNhbGxiYWNrKTtcblxuICAgIC8vIFJldHVybiBjbGVhbnVwIGZ1bmN0aW9uXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5saXN0ZW5lcnMuaW5kZXhPZihjYWxsYmFjayk7XG4gICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICB0aGlzLmxpc3RlbmVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGRldGVjdENhcGFiaWxpdGllcygpOiB2b2lkIHtcbiAgICBjb25zdCB2aWV3cG9ydCA9IHtcbiAgICAgIHdpZHRoOiB3aW5kb3cuaW5uZXJXaWR0aCxcbiAgICAgIGhlaWdodDogd2luZG93LmlubmVySGVpZ2h0LFxuICAgIH07XG5cbiAgICAvLyBUb3VjaCBkZXRlY3Rpb24gdXNpbmcgbXVsdGlwbGUgbWV0aG9kcyBmb3IgcmVsaWFiaWxpdHlcbiAgICBjb25zdCBoYXNUb3VjaCA9IHRoaXMuZGV0ZWN0VG91Y2goKTtcblxuICAgIC8vIFByZWNpc2UgcG9pbnRlciBkZXRlY3Rpb24gKG1vdXNlL3RyYWNrcGFkKVxuICAgIGNvbnN0IGhhc1ByZWNpc2VQb2ludGVyID0gdGhpcy5kZXRlY3RQcmVjaXNlUG9pbnRlcigpO1xuXG4gICAgLy8gS2V5Ym9hcmQgZGV0ZWN0aW9uIChiZXN0IGVmZm9ydClcbiAgICBjb25zdCBoYXNLZXlib2FyZCA9IHRoaXMuZGV0ZWN0S2V5Ym9hcmQoKTtcblxuICAgIC8vIFNjcmVlbiBzaXplIGNhdGVnb3J5XG4gICAgY29uc3Qgc2NyZWVuU2l6ZSA9IHRoaXMuZGV0ZXJtaW5lU2NyZWVuU2l6ZSh2aWV3cG9ydC53aWR0aCk7XG5cbiAgICAvLyBQcmltYXJ5IGlucHV0IG1ldGhvZCBkZXRlcm1pbmF0aW9uXG4gICAgY29uc3QgcHJpbWFyeUlucHV0ID0gdGhpcy5kZXRlcm1pbmVQcmltYXJ5SW5wdXQoXG4gICAgICBoYXNUb3VjaCxcbiAgICAgIGhhc1ByZWNpc2VQb2ludGVyLFxuICAgICAgc2NyZWVuU2l6ZVxuICAgICk7XG5cbiAgICB0aGlzLmNhcGFiaWxpdGllcyA9IHtcbiAgICAgIHByaW1hcnlJbnB1dCxcbiAgICAgIHNjcmVlblNpemUsXG4gICAgICBoYXNUb3VjaCxcbiAgICAgIGhhc1ByZWNpc2VQb2ludGVyLFxuICAgICAgaGFzS2V5Ym9hcmQsXG4gICAgICB2aWV3cG9ydCxcbiAgICAgIHBpeGVsUmF0aW86IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDEsXG4gICAgICBjb2xvckRlcHRoOiBzY3JlZW4uY29sb3JEZXB0aCB8fCAyNCxcbiAgICAgIHN1cHBvcnRzSERSOiB0aGlzLmRldGVjdEhEUlN1cHBvcnQoKSxcbiAgICAgIGhhcmR3YXJlQ29uY3VycmVuY3k6IG5hdmlnYXRvci5oYXJkd2FyZUNvbmN1cnJlbmN5IHx8IDQsXG4gICAgICBtZW1vcnlFc3RpbWF0ZTogdGhpcy5lc3RpbWF0ZU1lbW9yeSgpLFxuICAgICAgY29ubmVjdGlvblNwZWVkOiB0aGlzLmRldGVjdENvbm5lY3Rpb25TcGVlZCgpLFxuICAgIH07XG5cbiAgICAvLyBVcGRhdGUgQ1NTIGN1c3RvbSBwcm9wZXJ0aWVzXG4gICAgdGhpcy51cGRhdGVDU1NQcm9wZXJ0aWVzKCk7XG4gIH1cblxuICBwcml2YXRlIGRldGVjdFRvdWNoKCk6IGJvb2xlYW4ge1xuICAgIC8vIE11bHRpLW1ldGhvZCBhcHByb2FjaCBiYXNlZCBvbiByZXNlYXJjaFxuICAgIHJldHVybiAoXG4gICAgICBcIm9udG91Y2hzdGFydFwiIGluIHdpbmRvdyB8fFxuICAgICAgbmF2aWdhdG9yLm1heFRvdWNoUG9pbnRzID4gMCB8fFxuICAgICAgLy8gTGVnYWN5IElFIHN1cHBvcnRcbiAgICAgICgobmF2aWdhdG9yIGFzIE5hdmlnYXRvciAmIHsgbXNNYXhUb3VjaFBvaW50cz86IG51bWJlciB9KVxuICAgICAgICAubXNNYXhUb3VjaFBvaW50cyA/PyAwKSA+IDBcbiAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSBkZXRlY3RQcmVjaXNlUG9pbnRlcigpOiBib29sZWFuIHtcbiAgICAvLyBVc2UgQ1NTIG1lZGlhIHF1ZXJ5IGZvciBwcmVjaXNlIHBvaW50ZXIgZGV0ZWN0aW9uXG4gICAgcmV0dXJuIHdpbmRvdy5tYXRjaE1lZGlhKFwiKHBvaW50ZXI6IGZpbmUpXCIpLm1hdGNoZXM7XG4gIH1cblxuICBwcml2YXRlIGRldGVjdEtleWJvYXJkKCk6IGJvb2xlYW4ge1xuICAgIC8vIFRoaXMgaXMgaGFyZCB0byBkZXRlY3QgcmVsaWFibHkgd2l0aG91dCB1c2VyIGludGVyYWN0aW9uXG4gICAgLy8gRm9yIG5vdywgYXNzdW1lIGRlc2t0b3AvbGFwdG9wIGRldmljZXMgaGF2ZSBrZXlib2FyZHNcbiAgICAvLyBDb3VsZCBiZSBlbmhhbmNlZCB3aXRoIGFjdHVhbCBrZXkgZXZlbnQgZGV0ZWN0aW9uXG4gICAgcmV0dXJuIHdpbmRvdy5tYXRjaE1lZGlhKFwiKHBvaW50ZXI6IGZpbmUpXCIpLm1hdGNoZXM7XG4gIH1cblxuICBwcml2YXRlIGRldGVybWluZVNjcmVlblNpemUod2lkdGg6IG51bWJlcik6IFwibW9iaWxlXCIgfCBcInRhYmxldFwiIHwgXCJkZXNrdG9wXCIge1xuICAgIGlmICh3aWR0aCA8IDc2OCkgcmV0dXJuIFwibW9iaWxlXCI7XG4gICAgaWYgKHdpZHRoIDwgMTAyNCkgcmV0dXJuIFwidGFibGV0XCI7XG4gICAgcmV0dXJuIFwiZGVza3RvcFwiO1xuICB9XG5cbiAgcHJpdmF0ZSBkZXRlcm1pbmVQcmltYXJ5SW5wdXQoXG4gICAgaGFzVG91Y2g6IGJvb2xlYW4sXG4gICAgaGFzUHJlY2lzZVBvaW50ZXI6IGJvb2xlYW4sXG4gICAgc2NyZWVuU2l6ZTogXCJtb2JpbGVcIiB8IFwidGFibGV0XCIgfCBcImRlc2t0b3BcIlxuICApOiBcInRvdWNoXCIgfCBcIm1vdXNlXCIgfCBcImh5YnJpZFwiIHtcbiAgICAvLyBNb2JpbGUgZGV2aWNlcyBhcmUgcHJpbWFyaWx5IHRvdWNoXG4gICAgaWYgKHNjcmVlblNpemUgPT09IFwibW9iaWxlXCIpIHJldHVybiBcInRvdWNoXCI7XG5cbiAgICAvLyBEZXNrdG9wIHdpdGhvdXQgdG91Y2ggaXMgbW91c2VcbiAgICBpZiAoc2NyZWVuU2l6ZSA9PT0gXCJkZXNrdG9wXCIgJiYgIWhhc1RvdWNoKSByZXR1cm4gXCJtb3VzZVwiO1xuXG4gICAgLy8gRGVza3RvcCB3aXRoIHRvdWNoIGNhcGFiaWxpdGllcyAoV2luZG93cyB0YWJsZXRzLCB0b3VjaHNjcmVlbiBsYXB0b3BzKVxuICAgIGlmIChzY3JlZW5TaXplID09PSBcImRlc2t0b3BcIiAmJiBoYXNUb3VjaCAmJiBoYXNQcmVjaXNlUG9pbnRlcilcbiAgICAgIHJldHVybiBcImh5YnJpZFwiO1xuXG4gICAgLy8gVGFibGV0IGxvZ2ljXG4gICAgaWYgKHNjcmVlblNpemUgPT09IFwidGFibGV0XCIpIHtcbiAgICAgIHJldHVybiBoYXNQcmVjaXNlUG9pbnRlciA/IFwiaHlicmlkXCIgOiBcInRvdWNoXCI7XG4gICAgfVxuXG4gICAgLy8gRmFsbGJhY2tcbiAgICByZXR1cm4gaGFzVG91Y2ggPyBcInRvdWNoXCIgOiBcIm1vdXNlXCI7XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZUNTU1Byb3BlcnRpZXMoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmNhcGFiaWxpdGllcykgcmV0dXJuO1xuXG4gICAgY29uc3Qgc2V0dGluZ3MgPSB0aGlzLmdldFJlc3BvbnNpdmVTZXR0aW5ncygpO1xuXG4gICAgLy8gVXBkYXRlIENTUyBjdXN0b20gcHJvcGVydGllcyBmb3IgZ2xvYmFsIHVzZVxuICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eShcbiAgICAgIFwiLS1taW4tdG91Y2gtdGFyZ2V0XCIsXG4gICAgICBgJHtzZXR0aW5ncy5taW5Ub3VjaFRhcmdldH1weGBcbiAgICApO1xuICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eShcbiAgICAgIFwiLS1lbGVtZW50LXNwYWNpbmdcIixcbiAgICAgIGAke3NldHRpbmdzLmVsZW1lbnRTcGFjaW5nfXB4YFxuICAgICk7XG4gICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KFxuICAgICAgXCItLWZvbnQtc2NhbGluZ1wiLFxuICAgICAgc2V0dGluZ3MuZm9udFNjYWxpbmcudG9TdHJpbmcoKVxuICAgICk7XG5cbiAgICAvLyBTZXQgZGF0YSBhdHRyaWJ1dGVzIGZvciBDU1MgdGFyZ2V0aW5nXG4gICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNldEF0dHJpYnV0ZShcbiAgICAgIFwiZGF0YS1kZXZpY2UtdHlwZVwiLFxuICAgICAgdGhpcy5jYXBhYmlsaXRpZXMucHJpbWFyeUlucHV0XG4gICAgKTtcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2V0QXR0cmlidXRlKFxuICAgICAgXCJkYXRhLXNjcmVlbi1zaXplXCIsXG4gICAgICB0aGlzLmNhcGFiaWxpdGllcy5zY3JlZW5TaXplXG4gICAgKTtcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2V0QXR0cmlidXRlKFxuICAgICAgXCJkYXRhLWxheW91dC1kZW5zaXR5XCIsXG4gICAgICBzZXR0aW5ncy5sYXlvdXREZW5zaXR5XG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgc2V0dXBMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgLy8gTGlzdGVuIGZvciB2aWV3cG9ydCBjaGFuZ2VzXG4gICAgY29uc3QgaGFuZGxlUmVzaXplID0gKCkgPT4ge1xuICAgICAgY29uc3Qgb2xkQ2FwYWJpbGl0aWVzID0gdGhpcy5jYXBhYmlsaXRpZXM7XG4gICAgICB0aGlzLmRldGVjdENhcGFiaWxpdGllcygpO1xuXG4gICAgICAvLyBPbmx5IG5vdGlmeSBpZiBjYXBhYmlsaXRpZXMgYWN0dWFsbHkgY2hhbmdlZFxuICAgICAgaWYgKHRoaXMuaGFzQ2FwYWJpbGl0aWVzQ2hhbmdlZChvbGRDYXBhYmlsaXRpZXMsIHRoaXMuY2FwYWJpbGl0aWVzKSkge1xuICAgICAgICB0aGlzLm5vdGlmeUxpc3RlbmVycygpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBMaXN0ZW4gZm9yIG9yaWVudGF0aW9uIGNoYW5nZXMgb24gbW9iaWxlXG4gICAgY29uc3QgaGFuZGxlT3JpZW50YXRpb25DaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAvLyBTbWFsbCBkZWxheSB0byBlbnN1cmUgdmlld3BvcnQgaXMgdXBkYXRlZFxuICAgICAgc2V0VGltZW91dChoYW5kbGVSZXNpemUsIDEwMCk7XG4gICAgfTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIGhhbmRsZVJlc2l6ZSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJvcmllbnRhdGlvbmNoYW5nZVwiLCBoYW5kbGVPcmllbnRhdGlvbkNoYW5nZSk7XG5cbiAgICAvLyBNb2Rlcm4gUmVzaXplT2JzZXJ2ZXIgZm9yIG1vcmUgcmVzcG9uc2l2ZSB1cGRhdGVzXG4gICAgaWYgKFwiUmVzaXplT2JzZXJ2ZXJcIiBpbiB3aW5kb3cpIHtcbiAgICAgIHRoaXMucmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoaGFuZGxlUmVzaXplKTtcbiAgICAgIHRoaXMucmVzaXplT2JzZXJ2ZXIub2JzZXJ2ZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpO1xuICAgIH1cblxuICAgIC8vIERldGVjdCBpZiB1c2VyIHN3aXRjaGVzIGZyb20gdG91Y2ggdG8gbW91c2UgKG9yIHZpY2UgdmVyc2EpXG4gICAgbGV0IGhhc0RldGVjdGVkTW91c2UgPSBmYWxzZTtcbiAgICBjb25zdCBoYW5kbGVNb3VzZU1vdmUgPSAoKSA9PiB7XG4gICAgICBpZiAoIWhhc0RldGVjdGVkTW91c2UpIHtcbiAgICAgICAgaGFzRGV0ZWN0ZWRNb3VzZSA9IHRydWU7XG4gICAgICAgIC8vIFJlLWV2YWx1YXRlIGNhcGFiaWxpdGllcyBpZiB3ZSBkZXRlY3QgbW91c2Ugb24gYSB0b3VjaCBkZXZpY2VcbiAgICAgICAgY29uc3Qgb2xkQ2FwYWJpbGl0aWVzID0gdGhpcy5jYXBhYmlsaXRpZXM7XG4gICAgICAgIHRoaXMuZGV0ZWN0Q2FwYWJpbGl0aWVzKCk7XG4gICAgICAgIGlmICh0aGlzLmhhc0NhcGFiaWxpdGllc0NoYW5nZWQob2xkQ2FwYWJpbGl0aWVzLCB0aGlzLmNhcGFiaWxpdGllcykpIHtcbiAgICAgICAgICB0aGlzLm5vdGlmeUxpc3RlbmVycygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGhhbmRsZU1vdXNlTW92ZSwgeyBvbmNlOiB0cnVlIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBoYXNDYXBhYmlsaXRpZXNDaGFuZ2VkKFxuICAgIG9sZDogRGV2aWNlQ2FwYWJpbGl0aWVzIHwgbnVsbCxcbiAgICBjdXJyZW50OiBEZXZpY2VDYXBhYmlsaXRpZXMgfCBudWxsXG4gICk6IGJvb2xlYW4ge1xuICAgIGlmICghb2xkIHx8ICFjdXJyZW50KSByZXR1cm4gdHJ1ZTtcblxuICAgIHJldHVybiAoXG4gICAgICBvbGQucHJpbWFyeUlucHV0ICE9PSBjdXJyZW50LnByaW1hcnlJbnB1dCB8fFxuICAgICAgb2xkLnNjcmVlblNpemUgIT09IGN1cnJlbnQuc2NyZWVuU2l6ZSB8fFxuICAgICAgb2xkLnZpZXdwb3J0LndpZHRoICE9PSBjdXJyZW50LnZpZXdwb3J0LndpZHRoIHx8XG4gICAgICBvbGQudmlld3BvcnQuaGVpZ2h0ICE9PSBjdXJyZW50LnZpZXdwb3J0LmhlaWdodFxuICAgICk7XG4gIH1cblxuICBwcml2YXRlIG5vdGlmeUxpc3RlbmVycygpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jYXBhYmlsaXRpZXMpIHtcbiAgICAgIGNvbnN0IGNhcGFiaWxpdGllcyA9IHRoaXMuY2FwYWJpbGl0aWVzOyAvLyBDYXB0dXJlIGZvciBjbG9zdXJlXG4gICAgICB0aGlzLmxpc3RlbmVycy5mb3JFYWNoKChjYWxsYmFjaykgPT4gY2FsbGJhY2soY2FwYWJpbGl0aWVzKSk7XG4gICAgfVxuICB9XG5cbiAgLy8gQ2xlYW51cCBtZXRob2QgZm9yIHByb3BlciBkaXNwb3NhbFxuICBwdWJsaWMgZGlzcG9zZSgpOiB2b2lkIHtcbiAgICB0aGlzLmxpc3RlbmVycyA9IFtdO1xuICAgIGlmICh0aGlzLnJlc2l6ZU9ic2VydmVyKSB7XG4gICAgICB0aGlzLnJlc2l6ZU9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgIHRoaXMucmVzaXplT2JzZXJ2ZXIgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZGV0ZWN0SERSU3VwcG9ydCgpOiBib29sZWFuIHtcbiAgICAvLyBDaGVjayBmb3IgSERSIHN1cHBvcnQgdXNpbmcgbWVkaWEgcXVlcmllc1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIHdpbmRvdy5tYXRjaE1lZGlhKSB7XG4gICAgICByZXR1cm4gKFxuICAgICAgICB3aW5kb3cubWF0Y2hNZWRpYShcIihkeW5hbWljLXJhbmdlOiBoaWdoKVwiKS5tYXRjaGVzIHx8XG4gICAgICAgIHdpbmRvdy5tYXRjaE1lZGlhKFwiKGNvbG9yLWdhbXV0OiBwMylcIikubWF0Y2hlc1xuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcHJpdmF0ZSBlc3RpbWF0ZU1lbW9yeSgpOiBudW1iZXIgfCB1bmRlZmluZWQge1xuICAgIC8vIFVzZSBuYXZpZ2F0b3IuZGV2aWNlTWVtb3J5IGlmIGF2YWlsYWJsZSAoQ2hyb21lKVxuICAgIGlmIChcImRldmljZU1lbW9yeVwiIGluIG5hdmlnYXRvcikge1xuICAgICAgcmV0dXJuIChuYXZpZ2F0b3IgYXMgeyBkZXZpY2VNZW1vcnk6IG51bWJlciB9KS5kZXZpY2VNZW1vcnkgKiAxMDI0OyAvLyBDb252ZXJ0IEdCIHRvIE1CXG4gICAgfVxuXG4gICAgLy8gRmFsbGJhY2sgZXN0aW1hdGlvbiBiYXNlZCBvbiBvdGhlciBmYWN0b3JzXG4gICAgY29uc3QgaGFyZHdhcmVDb25jdXJyZW5jeSA9IG5hdmlnYXRvci5oYXJkd2FyZUNvbmN1cnJlbmN5IHx8IDQ7XG4gICAgaWYgKGhhcmR3YXJlQ29uY3VycmVuY3kgPj0gOCkgcmV0dXJuIDgxOTI7IC8vIDhHQlxuICAgIGlmIChoYXJkd2FyZUNvbmN1cnJlbmN5ID49IDQpIHJldHVybiA0MDk2OyAvLyA0R0JcbiAgICByZXR1cm4gMjA0ODsgLy8gMkdCIGZhbGxiYWNrXG4gIH1cblxuICBwcml2YXRlIGRldGVjdENvbm5lY3Rpb25TcGVlZCgpOiBcInNsb3dcIiB8IFwibWVkaXVtXCIgfCBcImZhc3RcIiB8IHVuZGVmaW5lZCB7XG4gICAgLy8gVXNlIG5hdmlnYXRvci5jb25uZWN0aW9uIGlmIGF2YWlsYWJsZVxuICAgIGlmIChcImNvbm5lY3Rpb25cIiBpbiBuYXZpZ2F0b3IpIHtcbiAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSAoXG4gICAgICAgIG5hdmlnYXRvciBhcyB7IGNvbm5lY3Rpb246IHsgZWZmZWN0aXZlVHlwZT86IHN0cmluZyB9IH1cbiAgICAgICkuY29ubmVjdGlvbjtcbiAgICAgIGlmIChjb25uZWN0aW9uLmVmZmVjdGl2ZVR5cGUpIHtcbiAgICAgICAgc3dpdGNoIChjb25uZWN0aW9uLmVmZmVjdGl2ZVR5cGUpIHtcbiAgICAgICAgICBjYXNlIFwic2xvdy0yZ1wiOlxuICAgICAgICAgIGNhc2UgXCIyZ1wiOlxuICAgICAgICAgICAgcmV0dXJuIFwic2xvd1wiO1xuICAgICAgICAgIGNhc2UgXCIzZ1wiOlxuICAgICAgICAgICAgcmV0dXJuIFwibWVkaXVtXCI7XG4gICAgICAgICAgY2FzZSBcIjRnXCI6XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBcImZhc3RcIjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiJBQVdPLGFBQU0sdUJBQTBEO0FBQUEsRUFDN0QsZUFBMEM7QUFBQSxFQUMxQyxZQUErRCxDQUFDO0FBQUEsRUFDaEUsaUJBQXdDO0FBQUEsRUFFaEQsY0FBYztBQUNaLFNBQUssbUJBQW1CO0FBQ3hCLFNBQUssZUFBZTtBQUFBLEVBQ3RCO0FBQUEsRUFFQSxrQkFBc0M7QUFDcEMsUUFBSSxDQUFDLEtBQUssY0FBYztBQUN0QixXQUFLLG1CQUFtQjtBQUFBLElBQzFCO0FBQ0EsUUFBSSxDQUFDLEtBQUssY0FBYztBQUN0QixZQUFNLElBQUksTUFBTSxzQ0FBc0M7QUFBQSxJQUN4RDtBQUNBLFdBQU8sS0FBSztBQUFBLEVBQ2Q7QUFBQSxFQUVBLHdCQUE0QztBQUMxQyxVQUFNLE9BQU8sS0FBSyxnQkFBZ0I7QUFHbEMsVUFBTSxpQkFBaUIsS0FBSyxpQkFBaUIsVUFBVSxLQUFLO0FBQzVELFVBQU0saUJBQWlCLEtBQUssaUJBQWlCLFVBQVUsS0FBSztBQUc1RCxVQUFNLGlCQUNKLEtBQUssZUFBZSxZQUFZLEtBQUssZUFBZTtBQUd0RCxRQUFJLGdCQUF3RDtBQUM1RCxRQUFJLEtBQUssZUFBZSxVQUFVO0FBQ2hDLHNCQUFnQjtBQUFBLElBQ2xCLFdBQVcsS0FBSyxlQUFlLGFBQWEsS0FBSyxpQkFBaUIsU0FBUztBQUN6RSxzQkFBZ0I7QUFBQSxJQUNsQixPQUFPO0FBQ0wsc0JBQWdCO0FBQUEsSUFDbEI7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