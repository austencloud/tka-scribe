import { GridMode } from "/src/lib/domain/index.ts";
export class CsvDataService {
  csvData = null;
  parsedData = null;
  isInitialized = false;
  constructor() {
  }
  /**
   * Load CSV data from multiple sources (global data or static files)
   */
  async loadCsvData() {
    if (this.isInitialized) {
      return;
    }
    try {
      if (typeof window !== "undefined" && window.csvData) {
        this.csvData = window.csvData;
      } else {
        const [diamondResponse, boxResponse] = await Promise.all([
          fetch("/DiamondPictographDataframe.csv"),
          fetch("/BoxPictographDataframe.csv")
        ]);
        if (!diamondResponse.ok || !boxResponse.ok) {
          throw new Error(
            `Failed to load CSV files: Diamond=${diamondResponse.status}, Box=${boxResponse.status}`
          );
        }
        const diamondData = await diamondResponse.text();
        const boxData = await boxResponse.text();
        this.csvData = { diamondData, boxData };
      }
      if (this.csvData) {
        this.parsedData = {
          [GridMode.DIAMOND]: this.parseCSV(this.csvData.diamondData),
          [GridMode.BOX]: this.parseCSV(this.csvData.boxData)
        };
      }
      this.isInitialized = true;
    } catch (error) {
      console.error("❌ Error loading CSV data:", error);
      throw new Error(
        `Failed to load CSV data: ${error instanceof Error ? error.message : "Unknown error"}`
      );
    }
  }
  /**
   * Get CSV data (similar to legacy layout data)
   */
  getCsvData() {
    return this.csvData;
  }
  /**
   * Get parsed data for a specific grid mode
   */
  getParsedData(gridMode) {
    if (!this.parsedData) {
      return [];
    }
    return this.parsedData[gridMode];
  }
  /**
   * Get available options for a given end position (like legacy OptionDataService)
   */
  getNextOptions(endPosition, gridMode = GridMode.DIAMOND) {
    if (!this.parsedData) {
      return [];
    }
    try {
      const dataset = this.parsedData[gridMode];
      const matchingOptions = dataset.filter(
        (row) => row.startPosition === endPosition
      );
      return matchingOptions;
    } catch (error) {
      console.error("❌ Error getting next options:", error);
      return [];
    }
  }
  /**
   * Parse CSV text into array of objects (same as legacy)
   */
  parseCSV(csvText) {
    const lines = csvText.trim().split("\n");
    if (lines.length < 2) return [];
    const headerLine = lines[0] ?? "";
    const headers = headerLine.split(",").map((h) => h.trim());
    const data = [];
    for (let i = 1; i < lines.length; i++) {
      const line = lines[i] ?? "";
      const values = line.split(",").map((v) => v.trim());
      const row = {};
      headers.forEach((header, index) => {
        row[header] = values[index] || "";
      });
      data.push({
        letter: row.letter || "",
        startPosition: row.startPosition || "",
        endPosition: row.endPosition || "",
        timing: row.timing || "",
        direction: row.direction || "",
        blueMotionType: row.blueMotionType || "",
        blueRotationDirection: row.blueRotationDirection || "",
        blueStartLocation: row.blueStartLocation || "",
        blueEndLocation: row.blueEndLocation || "",
        redMotionType: row.redMotionType || "",
        redRotationDirection: row.redRotationDirection || "",
        redStartLocation: row.redStartLocation || "",
        redEndLocation: row.redEndLocation || ""
      });
    }
    return data;
  }
  /**
   * Get all available start positions for a given grid mode
   */
  getAvailableStartPositions(gridMode = GridMode.DIAMOND) {
    if (!this.parsedData) return [];
    const dataset = this.parsedData[gridMode];
    const startPositions = [
      ...new Set(dataset.map((row) => row.startPosition))
    ];
    return startPositions.sort();
  }
  /**
   * Get all available end positions for a given grid mode
   */
  getAvailableEndPositions(gridMode = GridMode.DIAMOND) {
    if (!this.parsedData) return [];
    const dataset = this.parsedData[gridMode];
    const endPositions = [...new Set(dataset.map((row) => row.endPosition))];
    return endPositions.sort();
  }
  /**
   * Get statistics about the loaded data
   */
  getDataStats() {
    if (!this.parsedData) return null;
    return {
      [GridMode.DIAMOND]: {
        total: this.parsedData.diamond.length,
        letters: [...new Set(this.parsedData.diamond.map((row) => row.letter))].length,
        startPositions: this.getAvailableStartPositions(GridMode.DIAMOND).length,
        endPositions: this.getAvailableEndPositions(GridMode.DIAMOND).length
      },
      [GridMode.BOX]: {
        total: this.parsedData.box.length,
        letters: [...new Set(this.parsedData.box.map((row) => row.letter))].length,
        startPositions: this.getAvailableStartPositions(GridMode.BOX).length,
        endPositions: this.getAvailableEndPositions(GridMode.BOX).length
      }
    };
  }
  /**
   * Check if the service is initialized
   */
  isReady() {
    return this.isInitialized && this.parsedData !== null;
  }
  /**
   * Debug method to inspect specific position data
   */
  debugPosition(_position, gridMode = GridMode.DIAMOND) {
    if (!this.parsedData) {
      return;
    }
    void this.parsedData[gridMode];
  }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNzdkRhdGFTZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEdyaWRNb2RlIH0gZnJvbSBcIiRsaWIvZG9tYWluXCI7XG5cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgLy8gRXh0ZW5kIHdpbmRvdyB0eXBpbmcgZm9yIGNzdkRhdGEgaW5qZWN0aW9uXG4gIGludGVyZmFjZSBXaW5kb3cge1xuICAgIGNzdkRhdGE/OiBDc3ZEYXRhU2V0OyBcbiAgfVxufVxuLyoqXG4gKiBDU1YgRGF0YSBTZXJ2aWNlIC0gSW1wbGVtZW50YXRpb24gKFVwZGF0ZWQgZm9yIEdsb2JhbCBEYXRhIEFjY2VzcylcbiAqXG4gKiBMb2FkcyBhbmQgbWFuYWdlcyBDU1YgZGF0YSBmb3IgdGhlIG1vZGVybiB3ZWIgYXBwLlxuICogQmFzZWQgb24gdGhlIGxlZ2FjeSBzeXN0ZW0ncyBDU1YgbG9hZGluZyBhcHByb2FjaC5cbiAqL1xuXG5leHBvcnQgaW50ZXJmYWNlIENzdkRhdGFTZXQge1xuICBkaWFtb25kRGF0YTogc3RyaW5nO1xuICBib3hEYXRhOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFyc2VkQ3N2Um93IHtcbiAgbGV0dGVyOiBzdHJpbmc7XG4gIHN0YXJ0UG9zaXRpb246IHN0cmluZztcbiAgZW5kUG9zaXRpb246IHN0cmluZztcbiAgdGltaW5nOiBzdHJpbmc7XG4gIGRpcmVjdGlvbjogc3RyaW5nO1xuICBibHVlTW90aW9uVHlwZTogc3RyaW5nO1xuICBibHVlUm90YXRpb25EaXJlY3Rpb246IHN0cmluZztcbiAgYmx1ZVN0YXJ0TG9jYXRpb246IHN0cmluZztcbiAgYmx1ZUVuZExvY2F0aW9uOiBzdHJpbmc7XG4gIHJlZE1vdGlvblR5cGU6IHN0cmluZztcbiAgcmVkUm90YXRpb25EaXJlY3Rpb246IHN0cmluZztcbiAgcmVkU3RhcnRMb2NhdGlvbjogc3RyaW5nO1xuICByZWRFbmRMb2NhdGlvbjogc3RyaW5nO1xuICAvLyBBZGQgaW5kZXggc2lnbmF0dXJlIHRvIG1ha2UgaXQgY29tcGF0aWJsZSB3aXRoIFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbiAgW2tleTogc3RyaW5nXTogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgQ3N2RGF0YVNlcnZpY2Uge1xuICBwcml2YXRlIGNzdkRhdGE6IENzdkRhdGFTZXQgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBwYXJzZWREYXRhOiBSZWNvcmQ8R3JpZE1vZGUsIFBhcnNlZENzdlJvd1tdPiB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICAvLyBDc3ZEYXRhU2VydmljZSBpbml0aWFsaXplZFxuICB9XG5cbiAgLyoqXG4gICAqIExvYWQgQ1NWIGRhdGEgZnJvbSBtdWx0aXBsZSBzb3VyY2VzIChnbG9iYWwgZGF0YSBvciBzdGF0aWMgZmlsZXMpXG4gICAqL1xuICBhc3luYyBsb2FkQ3N2RGF0YSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodGhpcy5pc0luaXRpYWxpemVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIEZpcnN0IHRyeSB0byBnZXQgZGF0YSBmcm9tIGdsb2JhbCB3aW5kb3cuY3N2RGF0YSAoc2V0IGJ5IGxheW91dClcbiAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIHdpbmRvdy5jc3ZEYXRhKSB7XG4gICAgICAgIHRoaXMuY3N2RGF0YSA9IHdpbmRvdy5jc3ZEYXRhO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRmFsbGJhY2s6IEZldGNoIENTViBmaWxlcyBmcm9tIHN0YXRpYyBkaXJlY3RvcnlcbiAgICAgICAgY29uc3QgW2RpYW1vbmRSZXNwb25zZSwgYm94UmVzcG9uc2VdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICAgIGZldGNoKFwiL0RpYW1vbmRQaWN0b2dyYXBoRGF0YWZyYW1lLmNzdlwiKSxcbiAgICAgICAgICBmZXRjaChcIi9Cb3hQaWN0b2dyYXBoRGF0YWZyYW1lLmNzdlwiKSxcbiAgICAgICAgXSk7XG5cbiAgICAgICAgaWYgKCFkaWFtb25kUmVzcG9uc2Uub2sgfHwgIWJveFJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICAgYEZhaWxlZCB0byBsb2FkIENTViBmaWxlczogRGlhbW9uZD0ke2RpYW1vbmRSZXNwb25zZS5zdGF0dXN9LCBCb3g9JHtib3hSZXNwb25zZS5zdGF0dXN9YFxuICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBkaWFtb25kRGF0YSA9IGF3YWl0IGRpYW1vbmRSZXNwb25zZS50ZXh0KCk7XG4gICAgICAgIGNvbnN0IGJveERhdGEgPSBhd2FpdCBib3hSZXNwb25zZS50ZXh0KCk7XG5cbiAgICAgICAgdGhpcy5jc3ZEYXRhID0geyBkaWFtb25kRGF0YSwgYm94RGF0YSB9O1xuICAgICAgfVxuXG4gICAgICAvLyBQYXJzZSB0aGUgQ1NWIGRhdGFcbiAgICAgIGlmICh0aGlzLmNzdkRhdGEpIHtcbiAgICAgICAgdGhpcy5wYXJzZWREYXRhID0ge1xuICAgICAgICAgIFtHcmlkTW9kZS5ESUFNT05EXTogdGhpcy5wYXJzZUNTVih0aGlzLmNzdkRhdGEuZGlhbW9uZERhdGEpLFxuICAgICAgICAgIFtHcmlkTW9kZS5CT1hdOiB0aGlzLnBhcnNlQ1NWKHRoaXMuY3N2RGF0YS5ib3hEYXRhKSxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5pc0luaXRpYWxpemVkID0gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBFcnJvciBsb2FkaW5nIENTViBkYXRhOlwiLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBGYWlsZWQgdG8gbG9hZCBDU1YgZGF0YTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFwiVW5rbm93biBlcnJvclwifWBcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBDU1YgZGF0YSAoc2ltaWxhciB0byBsZWdhY3kgbGF5b3V0IGRhdGEpXG4gICAqL1xuICBnZXRDc3ZEYXRhKCk6IENzdkRhdGFTZXQgfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5jc3ZEYXRhO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBwYXJzZWQgZGF0YSBmb3IgYSBzcGVjaWZpYyBncmlkIG1vZGVcbiAgICovXG4gIGdldFBhcnNlZERhdGEoZ3JpZE1vZGU6IEdyaWRNb2RlKTogUGFyc2VkQ3N2Um93W10ge1xuICAgIGlmICghdGhpcy5wYXJzZWREYXRhKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnBhcnNlZERhdGFbZ3JpZE1vZGVdO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhdmFpbGFibGUgb3B0aW9ucyBmb3IgYSBnaXZlbiBlbmQgcG9zaXRpb24gKGxpa2UgbGVnYWN5IE9wdGlvbkRhdGFTZXJ2aWNlKVxuICAgKi9cbiAgZ2V0TmV4dE9wdGlvbnMoXG4gICAgZW5kUG9zaXRpb246IHN0cmluZyxcbiAgICBncmlkTW9kZTogR3JpZE1vZGUgPSBHcmlkTW9kZS5ESUFNT05EXG4gICk6IFBhcnNlZENzdlJvd1tdIHtcbiAgICBpZiAoIXRoaXMucGFyc2VkRGF0YSkge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyBHZXQgdGhlIGFwcHJvcHJpYXRlIGRhdGFzZXQgYmFzZWQgb24gZ3JpZCBtb2RlXG4gICAgICBjb25zdCBkYXRhc2V0ID0gdGhpcy5wYXJzZWREYXRhW2dyaWRNb2RlXTtcblxuICAgICAgLy8gRmlsdGVyIG9wdGlvbnMgd2hlcmUgc3RhcnRQb3NpdGlvbiBtYXRjaGVzIHRoZSBlbmRQb3NpdGlvbiAocG9zaXRpb25hbCBjb250aW51aXR5KVxuICAgICAgY29uc3QgbWF0Y2hpbmdPcHRpb25zID0gZGF0YXNldC5maWx0ZXIoXG4gICAgICAgIChyb3cpID0+IHJvdy5zdGFydFBvc2l0aW9uID09PSBlbmRQb3NpdGlvblxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIG1hdGNoaW5nT3B0aW9ucztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBFcnJvciBnZXR0aW5nIG5leHQgb3B0aW9uczpcIiwgZXJyb3IpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBDU1YgdGV4dCBpbnRvIGFycmF5IG9mIG9iamVjdHMgKHNhbWUgYXMgbGVnYWN5KVxuICAgKi9cbiAgcHJpdmF0ZSBwYXJzZUNTVihjc3ZUZXh0OiBzdHJpbmcpOiBQYXJzZWRDc3ZSb3dbXSB7XG4gICAgY29uc3QgbGluZXMgPSBjc3ZUZXh0LnRyaW0oKS5zcGxpdChcIlxcblwiKTtcbiAgICBpZiAobGluZXMubGVuZ3RoIDwgMikgcmV0dXJuIFtdO1xuXG4gICAgLy8gUGFyc2UgaGVhZGVyXG4gICAgY29uc3QgaGVhZGVyTGluZSA9IGxpbmVzWzBdID8/IFwiXCI7XG4gICAgY29uc3QgaGVhZGVycyA9IGhlYWRlckxpbmUuc3BsaXQoXCIsXCIpLm1hcCgoaCkgPT4gaC50cmltKCkpO1xuICAgIGNvbnN0IGRhdGE6IFBhcnNlZENzdlJvd1tdID0gW107XG5cbiAgICAvLyBQYXJzZSBlYWNoIGRhdGEgcm93XG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgbGluZSA9IGxpbmVzW2ldID8/IFwiXCI7XG4gICAgICBjb25zdCB2YWx1ZXMgPSBsaW5lLnNwbGl0KFwiLFwiKS5tYXAoKHYpID0+IHYudHJpbSgpKTtcbiAgICAgIGNvbnN0IHJvdzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xuXG4gICAgICAvLyBDcmVhdGUgcm93IG9iamVjdFxuICAgICAgaGVhZGVycy5mb3JFYWNoKChoZWFkZXIsIGluZGV4KSA9PiB7XG4gICAgICAgIHJvd1toZWFkZXJdID0gdmFsdWVzW2luZGV4XSB8fCBcIlwiO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFR5cGUtc2FmZSBjb252ZXJzaW9uIHRvIFBhcnNlZENzdlJvd1xuICAgICAgZGF0YS5wdXNoKHtcbiAgICAgICAgbGV0dGVyOiByb3cubGV0dGVyIHx8IFwiXCIsXG4gICAgICAgIHN0YXJ0UG9zaXRpb246IHJvdy5zdGFydFBvc2l0aW9uIHx8IFwiXCIsXG4gICAgICAgIGVuZFBvc2l0aW9uOiByb3cuZW5kUG9zaXRpb24gfHwgXCJcIixcbiAgICAgICAgdGltaW5nOiByb3cudGltaW5nIHx8IFwiXCIsXG4gICAgICAgIGRpcmVjdGlvbjogcm93LmRpcmVjdGlvbiB8fCBcIlwiLFxuICAgICAgICBibHVlTW90aW9uVHlwZTogcm93LmJsdWVNb3Rpb25UeXBlIHx8IFwiXCIsXG4gICAgICAgIGJsdWVSb3RhdGlvbkRpcmVjdGlvbjogcm93LmJsdWVSb3RhdGlvbkRpcmVjdGlvbiB8fCBcIlwiLFxuICAgICAgICBibHVlU3RhcnRMb2NhdGlvbjogcm93LmJsdWVTdGFydExvY2F0aW9uIHx8IFwiXCIsXG4gICAgICAgIGJsdWVFbmRMb2NhdGlvbjogcm93LmJsdWVFbmRMb2NhdGlvbiB8fCBcIlwiLFxuICAgICAgICByZWRNb3Rpb25UeXBlOiByb3cucmVkTW90aW9uVHlwZSB8fCBcIlwiLFxuICAgICAgICByZWRSb3RhdGlvbkRpcmVjdGlvbjogcm93LnJlZFJvdGF0aW9uRGlyZWN0aW9uIHx8IFwiXCIsXG4gICAgICAgIHJlZFN0YXJ0TG9jYXRpb246IHJvdy5yZWRTdGFydExvY2F0aW9uIHx8IFwiXCIsXG4gICAgICAgIHJlZEVuZExvY2F0aW9uOiByb3cucmVkRW5kTG9jYXRpb24gfHwgXCJcIixcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBkYXRhO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbGwgYXZhaWxhYmxlIHN0YXJ0IHBvc2l0aW9ucyBmb3IgYSBnaXZlbiBncmlkIG1vZGVcbiAgICovXG4gIGdldEF2YWlsYWJsZVN0YXJ0UG9zaXRpb25zKGdyaWRNb2RlOiBHcmlkTW9kZSA9IEdyaWRNb2RlLkRJQU1PTkQpOiBzdHJpbmdbXSB7XG4gICAgaWYgKCF0aGlzLnBhcnNlZERhdGEpIHJldHVybiBbXTtcblxuICAgIGNvbnN0IGRhdGFzZXQgPSB0aGlzLnBhcnNlZERhdGFbZ3JpZE1vZGVdO1xuICAgIGNvbnN0IHN0YXJ0UG9zaXRpb25zID0gW1xuICAgICAgLi4ubmV3IFNldChkYXRhc2V0Lm1hcCgocm93KSA9PiByb3cuc3RhcnRQb3NpdGlvbikpLFxuICAgIF07XG4gICAgcmV0dXJuIHN0YXJ0UG9zaXRpb25zLnNvcnQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYWxsIGF2YWlsYWJsZSBlbmQgcG9zaXRpb25zIGZvciBhIGdpdmVuIGdyaWQgbW9kZVxuICAgKi9cbiAgZ2V0QXZhaWxhYmxlRW5kUG9zaXRpb25zKGdyaWRNb2RlOiBHcmlkTW9kZSA9IEdyaWRNb2RlLkRJQU1PTkQpOiBzdHJpbmdbXSB7XG4gICAgaWYgKCF0aGlzLnBhcnNlZERhdGEpIHJldHVybiBbXTtcblxuICAgIGNvbnN0IGRhdGFzZXQgPSB0aGlzLnBhcnNlZERhdGFbZ3JpZE1vZGVdO1xuICAgIGNvbnN0IGVuZFBvc2l0aW9ucyA9IFsuLi5uZXcgU2V0KGRhdGFzZXQubWFwKChyb3cpID0+IHJvdy5lbmRQb3NpdGlvbikpXTtcbiAgICByZXR1cm4gZW5kUG9zaXRpb25zLnNvcnQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgc3RhdGlzdGljcyBhYm91dCB0aGUgbG9hZGVkIGRhdGFcbiAgICovXG4gIGdldERhdGFTdGF0cygpIHtcbiAgICBpZiAoIXRoaXMucGFyc2VkRGF0YSkgcmV0dXJuIG51bGw7XG5cbiAgICByZXR1cm4ge1xuICAgICAgW0dyaWRNb2RlLkRJQU1PTkRdOiB7XG4gICAgICAgIHRvdGFsOiB0aGlzLnBhcnNlZERhdGEuZGlhbW9uZC5sZW5ndGgsXG4gICAgICAgIGxldHRlcnM6IFsuLi5uZXcgU2V0KHRoaXMucGFyc2VkRGF0YS5kaWFtb25kLm1hcCgocm93KSA9PiByb3cubGV0dGVyKSldXG4gICAgICAgICAgLmxlbmd0aCxcbiAgICAgICAgc3RhcnRQb3NpdGlvbnM6IHRoaXMuZ2V0QXZhaWxhYmxlU3RhcnRQb3NpdGlvbnMoR3JpZE1vZGUuRElBTU9ORClcbiAgICAgICAgICAubGVuZ3RoLFxuICAgICAgICBlbmRQb3NpdGlvbnM6IHRoaXMuZ2V0QXZhaWxhYmxlRW5kUG9zaXRpb25zKEdyaWRNb2RlLkRJQU1PTkQpLmxlbmd0aCxcbiAgICAgIH0sXG4gICAgICBbR3JpZE1vZGUuQk9YXToge1xuICAgICAgICB0b3RhbDogdGhpcy5wYXJzZWREYXRhLmJveC5sZW5ndGgsXG4gICAgICAgIGxldHRlcnM6IFsuLi5uZXcgU2V0KHRoaXMucGFyc2VkRGF0YS5ib3gubWFwKChyb3cpID0+IHJvdy5sZXR0ZXIpKV1cbiAgICAgICAgICAubGVuZ3RoLFxuICAgICAgICBzdGFydFBvc2l0aW9uczogdGhpcy5nZXRBdmFpbGFibGVTdGFydFBvc2l0aW9ucyhHcmlkTW9kZS5CT1gpLmxlbmd0aCxcbiAgICAgICAgZW5kUG9zaXRpb25zOiB0aGlzLmdldEF2YWlsYWJsZUVuZFBvc2l0aW9ucyhHcmlkTW9kZS5CT1gpLmxlbmd0aCxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiB0aGUgc2VydmljZSBpcyBpbml0aWFsaXplZFxuICAgKi9cbiAgaXNSZWFkeSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5pc0luaXRpYWxpemVkICYmIHRoaXMucGFyc2VkRGF0YSAhPT0gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWJ1ZyBtZXRob2QgdG8gaW5zcGVjdCBzcGVjaWZpYyBwb3NpdGlvbiBkYXRhXG4gICAqL1xuICBkZWJ1Z1Bvc2l0aW9uKFxuICAgIF9wb3NpdGlvbjogc3RyaW5nLFxuICAgIGdyaWRNb2RlOiBHcmlkTW9kZSA9IEdyaWRNb2RlLkRJQU1PTkRcbiAgKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLnBhcnNlZERhdGEpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBJbnRlbnRpb25hbGx5IG1pbmltYWwgdG8gYXZvaWQgdW51c2VkIHZhcmlhYmxlIHdhcm5pbmdzXG4gICAgdm9pZCB0aGlzLnBhcnNlZERhdGFbZ3JpZE1vZGVdO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBLFNBQVMsZ0JBQWdCO0FBc0NsQixhQUFNLGVBQWU7QUFBQSxFQUNsQixVQUE2QjtBQUFBLEVBQzdCLGFBQXNEO0FBQUEsRUFDdEQsZ0JBQWdCO0FBQUEsRUFFeEIsY0FBYztBQUFBLEVBRWQ7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sY0FBNkI7QUFDakMsUUFBSSxLQUFLLGVBQWU7QUFDdEI7QUFBQSxJQUNGO0FBRUEsUUFBSTtBQUVGLFVBQUksT0FBTyxXQUFXLGVBQWUsT0FBTyxTQUFTO0FBQ25ELGFBQUssVUFBVSxPQUFPO0FBQUEsTUFDeEIsT0FBTztBQUVMLGNBQU0sQ0FBQyxpQkFBaUIsV0FBVyxJQUFJLE1BQU0sUUFBUSxJQUFJO0FBQUEsVUFDdkQsTUFBTSxpQ0FBaUM7QUFBQSxVQUN2QyxNQUFNLDZCQUE2QjtBQUFBLFFBQ3JDLENBQUM7QUFFRCxZQUFJLENBQUMsZ0JBQWdCLE1BQU0sQ0FBQyxZQUFZLElBQUk7QUFDMUMsZ0JBQU0sSUFBSTtBQUFBLFlBQ1IscUNBQXFDLGdCQUFnQixNQUFNLFNBQVMsWUFBWSxNQUFNO0FBQUEsVUFDeEY7QUFBQSxRQUNGO0FBRUEsY0FBTSxjQUFjLE1BQU0sZ0JBQWdCLEtBQUs7QUFDL0MsY0FBTSxVQUFVLE1BQU0sWUFBWSxLQUFLO0FBRXZDLGFBQUssVUFBVSxFQUFFLGFBQWEsUUFBUTtBQUFBLE1BQ3hDO0FBR0EsVUFBSSxLQUFLLFNBQVM7QUFDaEIsYUFB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