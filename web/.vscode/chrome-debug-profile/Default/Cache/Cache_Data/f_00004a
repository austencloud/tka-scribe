export class LocalStoragePersistenceService {
  CACHE_VERSION = "v2.1";
  // âœ… ROBUST: Cache versioning
  SEQUENCES_KEY = `tka-${this.CACHE_VERSION}-sequences`;
  SEQUENCE_PREFIX = `tka-${this.CACHE_VERSION}-sequence-`;
  /**
   * Validate sequence data before storage operations
   */
  isValidSequence(sequence) {
    const name = sequence.name || sequence.word || sequence.id || "";
    return name.length > 0 && name.length <= 100 && // Reasonable name length limit
    !name.includes("__") && // No double underscores
    !name.includes("test");
  }
  /**
   * Save a sequence to localStorage
   */
  async saveSequence(sequence) {
    try {
      if (!this.isValidSequence(sequence)) {
        return;
      }
      const sequenceKey = `${this.SEQUENCE_PREFIX}${sequence.id}`;
      localStorage.setItem(sequenceKey, JSON.stringify(sequence));
      await this.updateSequenceIndex(sequence);
    } catch (error) {
      console.error("Failed to save sequence:", error);
      throw new Error(
        `Failed to save sequence: ${error instanceof Error ? error.message : "Unknown error"}`
      );
    }
  }
  /**
   * Load a sequence by ID
   */
  async loadSequence(id) {
    try {
      const sequenceKey = `${this.SEQUENCE_PREFIX}${id}`;
      const data = localStorage.getItem(sequenceKey);
      if (!data) {
        return null;
      }
      const sequence = JSON.parse(data);
      return this.validateSequenceData(sequence);
    } catch (error) {
      console.error(`Failed to load sequence ${id}:`, error);
      return null;
    }
  }
  /**
   * Load all sequences
   */
  async loadAllSequences() {
    try {
      const indexData = localStorage.getItem(this.SEQUENCES_KEY);
      if (!indexData) {
        return [];
      }
      const sequenceIds = JSON.parse(indexData);
      const sequences = [];
      for (const id of sequenceIds) {
        const sequence = await this.loadSequence(id);
        if (sequence && this.isValidSequence(sequence)) {
          sequences.push(sequence);
        }
      }
      return sequences.sort((a, b) => {
        const aDate = new Date(a.metadata?.saved_at || 0).getTime();
        const bDate = new Date(b.metadata?.saved_at || 0).getTime();
        return bDate - aDate;
      });
    } catch (error) {
      console.error("Failed to load sequences:", error);
      return [];
    }
  }
  /**
   * Delete a sequence
   */
  async deleteSequence(id) {
    try {
      const sequenceKey = `${this.SEQUENCE_PREFIX}${id}`;
      localStorage.removeItem(sequenceKey);
      await this.removeFromSequenceIndex(id);
    } catch (error) {
      console.error(`Failed to delete sequence ${id}:`, error);
      throw new Error(
        `Failed to delete sequence: ${error instanceof Error ? error.message : "Unknown error"}`
      );
    }
  }
  /**
   * Update the sequence index with a new or updated sequence
   */
  async updateSequenceIndex(sequence) {
    try {
      const indexData = localStorage.getItem(this.SEQUENCES_KEY);
      const sequenceIds = indexData ? JSON.parse(indexData) : [];
      if (!sequenceIds.includes(sequence.id)) {
        sequenceIds.push(sequence.id);
        localStorage.setItem(this.SEQUENCES_KEY, JSON.stringify(sequenceIds));
      }
    } catch (error) {
      console.error("Failed to update sequence index:", error);
    }
  }
  /**
   * Remove a sequence ID from the index
   */
  async removeFromSequenceIndex(id) {
    try {
      const indexData = localStorage.getItem(this.SEQUENCES_KEY);
      if (!indexData) return;
      const sequenceIds = JSON.parse(indexData);
      const filteredIds = sequenceIds.filter((existingId) => existingId !== id);
      localStorage.setItem(this.SEQUENCES_KEY, JSON.stringify(filteredIds));
    } catch (error) {
      console.error("Failed to remove from sequence index:", error);
    }
  }
  /**
   * Validate sequence data structure
   */
  validateSequenceData(raw) {
    const data = raw || {};
    if (typeof data.id !== "string" || typeof data.name !== "string" || !Array.isArray(data.beats)) {
      throw new Error("Invalid sequence data structure");
    }
    const nowIso = (/* @__PURE__ */ new Date()).toISOString();
    const existingMeta = data.metadata || {};
    const metadata = {
      ...existingMeta,
      saved_at: typeof existingMeta.saved_at === "string" ? existingMeta.saved_at : nowIso,
      updated_at: nowIso
    };
    const beatsArray = Array.isArray(data.beats) ? data.beats : [];
    const beats = beatsArray.filter((b) => {
      if (b == null || typeof b !== "object") return false;
      const candidate = b;
      return "beatNumber" in candidate;
    });
    const result = {
      id: data.id,
      name: data.name,
      beats,
      word: data.word || "",
      thumbnails: data.thumbnails || [],
      is_favorite: Boolean(data.is_favorite),
      is_circular: Boolean(data.is_circular),
      tags: data.tags || [],
      metadata,
      // **CRITICAL: Include startPosition field if it exists**
      ...data.startPosition ? { startPosition: data.startPosition } : {}
    };
    return result;
  }
  /**
   * Get storage usage statistics
   */
  getStorageInfo() {
    try {
      let used = 0;
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key?.startsWith(`tka-${this.CACHE_VERSION}-`)) {
          const value = localStorage.getItem(key);
          used += (key.length + (value?.length || 0)) * 2;
        }
      }
      const indexData = localStorage.getItem(this.SEQUENCES_KEY);
      const sequenceCount = indexData ? JSON.parse(indexData).length : 0;
      return {
        used: Math.round(used / 1024),
        // KB
        available: 5120,
        // Rough estimate of 5MB localStorage limit
        sequences: sequenceCount
      };
    } catch {
      return { used: 0, available: 5120, sequences: 0 };
    }
  }
  /**
   * Clear old cached data and malformed sequences
   */
  async clearLegacyCache() {
    try {
      const preserveKeys = [
        "tka-app-tab-state-v2",
        "tka-modern-web-settings",
        "tka-browse-state-v2",
        "tka-browse-filter-v2",
        "tka-browse-sort-v2",
        "tka-browse-view-v2",
        "tka-browse-scroll-v2",
        "tka-browse-selection-v2"
      ];
      const keysToRemove = [];
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key?.startsWith("tka-") && !key.startsWith(`tka-${this.CACHE_VERSION}-`) && !preserveKeys.includes(key)) {
          keysToRemove.push(key);
        }
      }
      keysToRemove.forEach((key) => {
        localStorage.removeItem(key);
      });
      const sessionKeysToRemove = [];
      for (let i = 0; i < sessionStorage.length; i++) {
        const key = sessionStorage.key(i);
        if (key?.startsWith("tka-")) {
          sessionKeysToRemove.push(key);
        }
      }
      sessionKeysToRemove.forEach((key) => {
        sessionStorage.removeItem(key);
      });
    } catch (error) {
      console.error("Failed to clear legacy cache:", error);
    }
  }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkxvY2FsU3RvcmFnZVBlcnNpc3RlbmNlU2VydmljZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExvY2FsIFN0b3JhZ2UgUGVyc2lzdGVuY2UgU2VydmljZVxuICpcbiAqIEhhbmRsZXMgZGF0YSBwZXJzaXN0ZW5jZSB1c2luZyBicm93c2VyIGxvY2FsU3RvcmFnZS5cbiAqIFRoaXMgcHJvdmlkZXMgYSBzaW1wbGUgcGVyc2lzdGVuY2UgbGF5ZXIgZm9yIHNlcXVlbmNlcyBhbmQgc2V0dGluZ3MuXG4gKi9cblxuaW1wb3J0IHR5cGUgeyBCZWF0RGF0YSwgU2VxdWVuY2VEYXRhIH0gZnJvbSBcIiRsaWIvZG9tYWluXCI7XG5pbXBvcnQgdHlwZSB7IElQZXJzaXN0ZW5jZVNlcnZpY2UgfSBmcm9tIFwiLi4vLi4vaW50ZXJmYWNlcy9zZXF1ZW5jZS1pbnRlcmZhY2VzXCI7XG5cbmV4cG9ydCBjbGFzcyBMb2NhbFN0b3JhZ2VQZXJzaXN0ZW5jZVNlcnZpY2UgaW1wbGVtZW50cyBJUGVyc2lzdGVuY2VTZXJ2aWNlIHtcbiAgcHJpdmF0ZSByZWFkb25seSBDQUNIRV9WRVJTSU9OID0gXCJ2Mi4xXCI7IC8vIOKchSBST0JVU1Q6IENhY2hlIHZlcnNpb25pbmdcbiAgcHJpdmF0ZSByZWFkb25seSBTRVFVRU5DRVNfS0VZID0gYHRrYS0ke3RoaXMuQ0FDSEVfVkVSU0lPTn0tc2VxdWVuY2VzYDtcbiAgcHJpdmF0ZSByZWFkb25seSBTRVFVRU5DRV9QUkVGSVggPSBgdGthLSR7dGhpcy5DQUNIRV9WRVJTSU9OfS1zZXF1ZW5jZS1gO1xuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBzZXF1ZW5jZSBkYXRhIGJlZm9yZSBzdG9yYWdlIG9wZXJhdGlvbnNcbiAgICovXG4gIHByaXZhdGUgaXNWYWxpZFNlcXVlbmNlKHNlcXVlbmNlOiBTZXF1ZW5jZURhdGEpOiBib29sZWFuIHtcbiAgICAvLyDinIUgUEVSTUFORU5UOiBWYWxpZGF0ZSBzZXF1ZW5jZSBuYW1lcyB0byBwcmV2ZW50IG1hbGZvcm1lZCBkYXRhXG4gICAgY29uc3QgbmFtZSA9IHNlcXVlbmNlLm5hbWUgfHwgc2VxdWVuY2Uud29yZCB8fCBzZXF1ZW5jZS5pZCB8fCBcIlwiO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIG5hbWUubGVuZ3RoID4gMCAmJlxuICAgICAgbmFtZS5sZW5ndGggPD0gMTAwICYmIC8vIFJlYXNvbmFibGUgbmFtZSBsZW5ndGggbGltaXRcbiAgICAgICFuYW1lLmluY2x1ZGVzKFwiX19cIikgJiYgLy8gTm8gZG91YmxlIHVuZGVyc2NvcmVzXG4gICAgICAhbmFtZS5pbmNsdWRlcyhcInRlc3RcIikgLy8gTm8gdGVzdCBzZXF1ZW5jZXNcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFNhdmUgYSBzZXF1ZW5jZSB0byBsb2NhbFN0b3JhZ2VcbiAgICovXG4gIGFzeW5jIHNhdmVTZXF1ZW5jZShzZXF1ZW5jZTogU2VxdWVuY2VEYXRhKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIOKchSBQRVJNQU5FTlQ6IFZhbGlkYXRlIGJlZm9yZSBzYXZpbmdcbiAgICAgIGlmICghdGhpcy5pc1ZhbGlkU2VxdWVuY2Uoc2VxdWVuY2UpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gU2F2ZSBpbmRpdmlkdWFsIHNlcXVlbmNlXG4gICAgICBjb25zdCBzZXF1ZW5jZUtleSA9IGAke3RoaXMuU0VRVUVOQ0VfUFJFRklYfSR7c2VxdWVuY2UuaWR9YDtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHNlcXVlbmNlS2V5LCBKU09OLnN0cmluZ2lmeShzZXF1ZW5jZSkpO1xuXG4gICAgICAvLyBVcGRhdGUgc2VxdWVuY2UgaW5kZXhcbiAgICAgIGF3YWl0IHRoaXMudXBkYXRlU2VxdWVuY2VJbmRleChzZXF1ZW5jZSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gc2F2ZSBzZXF1ZW5jZTpcIiwgZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgRmFpbGVkIHRvIHNhdmUgc2VxdWVuY2U6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcIlVua25vd24gZXJyb3JcIn1gXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBMb2FkIGEgc2VxdWVuY2UgYnkgSURcbiAgICovXG4gIGFzeW5jIGxvYWRTZXF1ZW5jZShpZDogc3RyaW5nKTogUHJvbWlzZTxTZXF1ZW5jZURhdGEgfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlcXVlbmNlS2V5ID0gYCR7dGhpcy5TRVFVRU5DRV9QUkVGSVh9JHtpZH1gO1xuICAgICAgY29uc3QgZGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKHNlcXVlbmNlS2V5KTtcblxuICAgICAgaWYgKCFkYXRhKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBzZXF1ZW5jZSA9IEpTT04ucGFyc2UoZGF0YSkgYXMgU2VxdWVuY2VEYXRhO1xuICAgICAgcmV0dXJuIHRoaXMudmFsaWRhdGVTZXF1ZW5jZURhdGEoc2VxdWVuY2UpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gbG9hZCBzZXF1ZW5jZSAke2lkfTpgLCBlcnJvcik7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTG9hZCBhbGwgc2VxdWVuY2VzXG4gICAqL1xuICBhc3luYyBsb2FkQWxsU2VxdWVuY2VzKCk6IFByb21pc2U8U2VxdWVuY2VEYXRhW10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgaW5kZXhEYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5TRVFVRU5DRVNfS0VZKTtcbiAgICAgIGlmICghaW5kZXhEYXRhKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc2VxdWVuY2VJZHMgPSBKU09OLnBhcnNlKGluZGV4RGF0YSkgYXMgc3RyaW5nW107XG4gICAgICBjb25zdCBzZXF1ZW5jZXM6IFNlcXVlbmNlRGF0YVtdID0gW107XG5cbiAgICAgIGZvciAoY29uc3QgaWQgb2Ygc2VxdWVuY2VJZHMpIHtcbiAgICAgICAgY29uc3Qgc2VxdWVuY2UgPSBhd2FpdCB0aGlzLmxvYWRTZXF1ZW5jZShpZCk7XG4gICAgICAgIGlmIChzZXF1ZW5jZSAmJiB0aGlzLmlzVmFsaWRTZXF1ZW5jZShzZXF1ZW5jZSkpIHtcbiAgICAgICAgICAvLyDinIUgUEVSTUFORU5UOiBGaWx0ZXIgb3V0IGludmFsaWQgc2VxdWVuY2VzIGR1cmluZyBsb2FkXG4gICAgICAgICAgc2VxdWVuY2VzLnB1c2goc2VxdWVuY2UpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzZXF1ZW5jZXMuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAvLyBTb3J0IGJ5IHN0b3JlZCB0aW1lc3RhbXAgaW4gbWV0YWRhdGEgaWYgYXZhaWxhYmxlXG4gICAgICAgIGNvbnN0IGFEYXRlID0gbmV3IERhdGUoKGEubWV0YWRhdGE/LnNhdmVkX2F0IGFzIHN0cmluZykgfHwgMCkuZ2V0VGltZSgpO1xuICAgICAgICBjb25zdCBiRGF0ZSA9IG5ldyBEYXRlKChiLm1ldGFkYXRhPy5zYXZlZF9hdCBhcyBzdHJpbmcpIHx8IDApLmdldFRpbWUoKTtcbiAgICAgICAgcmV0dXJuIGJEYXRlIC0gYURhdGU7XG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBsb2FkIHNlcXVlbmNlczpcIiwgZXJyb3IpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxldGUgYSBzZXF1ZW5jZVxuICAgKi9cbiAgYXN5bmMgZGVsZXRlU2VxdWVuY2UoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBSZW1vdmUgaW5kaXZpZHVhbCBzZXF1ZW5jZVxuICAgICAgY29uc3Qgc2VxdWVuY2VLZXkgPSBgJHt0aGlzLlNFUVVFTkNFX1BSRUZJWH0ke2lkfWA7XG4gICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShzZXF1ZW5jZUtleSk7XG5cbiAgICAgIC8vIFVwZGF0ZSBzZXF1ZW5jZSBpbmRleFxuICAgICAgYXdhaXQgdGhpcy5yZW1vdmVGcm9tU2VxdWVuY2VJbmRleChpZCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBkZWxldGUgc2VxdWVuY2UgJHtpZH06YCwgZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgRmFpbGVkIHRvIGRlbGV0ZSBzZXF1ZW5jZTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFwiVW5rbm93biBlcnJvclwifWBcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSB0aGUgc2VxdWVuY2UgaW5kZXggd2l0aCBhIG5ldyBvciB1cGRhdGVkIHNlcXVlbmNlXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHVwZGF0ZVNlcXVlbmNlSW5kZXgoc2VxdWVuY2U6IFNlcXVlbmNlRGF0YSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBpbmRleERhdGEgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0aGlzLlNFUVVFTkNFU19LRVkpO1xuICAgICAgY29uc3Qgc2VxdWVuY2VJZHMgPSBpbmRleERhdGEgPyAoSlNPTi5wYXJzZShpbmRleERhdGEpIGFzIHN0cmluZ1tdKSA6IFtdO1xuXG4gICAgICAvLyBBZGQgc2VxdWVuY2UgSUQgaWYgbm90IGFscmVhZHkgcHJlc2VudFxuICAgICAgaWYgKCFzZXF1ZW5jZUlkcy5pbmNsdWRlcyhzZXF1ZW5jZS5pZCkpIHtcbiAgICAgICAgc2VxdWVuY2VJZHMucHVzaChzZXF1ZW5jZS5pZCk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHRoaXMuU0VRVUVOQ0VTX0tFWSwgSlNPTi5zdHJpbmdpZnkoc2VxdWVuY2VJZHMpKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byB1cGRhdGUgc2VxdWVuY2UgaW5kZXg6XCIsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGEgc2VxdWVuY2UgSUQgZnJvbSB0aGUgaW5kZXhcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcmVtb3ZlRnJvbVNlcXVlbmNlSW5kZXgoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBpbmRleERhdGEgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0aGlzLlNFUVVFTkNFU19LRVkpO1xuICAgICAgaWYgKCFpbmRleERhdGEpIHJldHVybjtcblxuICAgICAgY29uc3Qgc2VxdWVuY2VJZHMgPSBKU09OLnBhcnNlKGluZGV4RGF0YSkgYXMgc3RyaW5nW107XG4gICAgICBjb25zdCBmaWx0ZXJlZElkcyA9IHNlcXVlbmNlSWRzLmZpbHRlcigoZXhpc3RpbmdJZCkgPT4gZXhpc3RpbmdJZCAhPT0gaWQpO1xuXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLlNFUVVFTkNFU19LRVksIEpTT04uc3RyaW5naWZ5KGZpbHRlcmVkSWRzKSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gcmVtb3ZlIGZyb20gc2VxdWVuY2UgaW5kZXg6XCIsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgc2VxdWVuY2UgZGF0YSBzdHJ1Y3R1cmVcbiAgICovXG4gIHByaXZhdGUgdmFsaWRhdGVTZXF1ZW5jZURhdGEocmF3OiB1bmtub3duKTogU2VxdWVuY2VEYXRhIHtcbiAgICBjb25zdCBkYXRhID0gKHJhdyBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikgfHwge307XG4gICAgLy8gQmFzaWMgdmFsaWRhdGlvbiAtIGVuc3VyZSByZXF1aXJlZCBmaWVsZHMgZXhpc3RcbiAgICBpZiAoXG4gICAgICB0eXBlb2YgZGF0YS5pZCAhPT0gXCJzdHJpbmdcIiB8fFxuICAgICAgdHlwZW9mIGRhdGEubmFtZSAhPT0gXCJzdHJpbmdcIiB8fFxuICAgICAgIUFycmF5LmlzQXJyYXkoZGF0YS5iZWF0cylcbiAgICApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgc2VxdWVuY2UgZGF0YSBzdHJ1Y3R1cmVcIik7XG4gICAgfVxuXG4gICAgLy8gRW5zdXJlIGFsbCByZXF1aXJlZCBmaWVsZHMgaGF2ZSBkZWZhdWx0c1xuICAgIGNvbnN0IG5vd0lzbyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICBjb25zdCBleGlzdGluZ01ldGEgPSAoZGF0YS5tZXRhZGF0YSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikgfHwge307XG4gICAgY29uc3QgbWV0YWRhdGEgPSB7XG4gICAgICAuLi5leGlzdGluZ01ldGEsXG4gICAgICBzYXZlZF9hdDpcbiAgICAgICAgdHlwZW9mIGV4aXN0aW5nTWV0YS5zYXZlZF9hdCA9PT0gXCJzdHJpbmdcIlxuICAgICAgICAgID8gZXhpc3RpbmdNZXRhLnNhdmVkX2F0XG4gICAgICAgICAgOiBub3dJc28sXG4gICAgICB1cGRhdGVkX2F0OiBub3dJc28sXG4gICAgfTtcbiAgICBjb25zdCBiZWF0c0FycmF5ID0gQXJyYXkuaXNBcnJheShkYXRhLmJlYXRzKVxuICAgICAgPyAoZGF0YS5iZWF0cyBhcyB1bmtub3duW10pXG4gICAgICA6IFtdO1xuICAgIGNvbnN0IGJlYXRzOiBCZWF0RGF0YVtdID0gYmVhdHNBcnJheS5maWx0ZXIoKGIpOiBiIGlzIEJlYXREYXRhID0+IHtcbiAgICAgIGlmIChiID09IG51bGwgfHwgdHlwZW9mIGIgIT09IFwib2JqZWN0XCIpIHJldHVybiBmYWxzZTtcbiAgICAgIGNvbnN0IGNhbmRpZGF0ZSA9IGIgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICByZXR1cm4gXCJiZWF0TnVtYmVyXCIgaW4gY2FuZGlkYXRlO1xuICAgIH0pO1xuICAgIGNvbnN0IHJlc3VsdDogU2VxdWVuY2VEYXRhID0ge1xuICAgICAgaWQ6IGRhdGEuaWQgYXMgc3RyaW5nLFxuICAgICAgbmFtZTogZGF0YS5uYW1lIGFzIHN0cmluZyxcbiAgICAgIGJlYXRzLFxuICAgICAgd29yZDogKGRhdGEud29yZCBhcyBzdHJpbmcpIHx8IFwiXCIsXG4gICAgICB0aHVtYm5haWxzOiAoZGF0YS50aHVtYm5haWxzIGFzIHN0cmluZ1tdKSB8fCBbXSxcbiAgICAgIGlzX2Zhdm9yaXRlOiBCb29sZWFuKGRhdGEuaXNfZmF2b3JpdGUpLFxuICAgICAgaXNfY2lyY3VsYXI6IEJvb2xlYW4oZGF0YS5pc19jaXJjdWxhciksXG4gICAgICB0YWdzOiAoZGF0YS50YWdzIGFzIHN0cmluZ1tdKSB8fCBbXSxcbiAgICAgIG1ldGFkYXRhLFxuICAgICAgLy8gKipDUklUSUNBTDogSW5jbHVkZSBzdGFydFBvc2l0aW9uIGZpZWxkIGlmIGl0IGV4aXN0cyoqXG4gICAgICAuLi4oZGF0YS5zdGFydFBvc2l0aW9uXG4gICAgICAgID8geyBzdGFydFBvc2l0aW9uOiBkYXRhLnN0YXJ0UG9zaXRpb24gYXMgQmVhdERhdGEgfVxuICAgICAgICA6IHt9KSxcbiAgICB9O1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgc3RvcmFnZSB1c2FnZSBzdGF0aXN0aWNzXG4gICAqL1xuICBnZXRTdG9yYWdlSW5mbygpOiB7IHVzZWQ6IG51bWJlcjsgYXZhaWxhYmxlOiBudW1iZXI7IHNlcXVlbmNlczogbnVtYmVyIH0ge1xuICAgIHRyeSB7XG4gICAgICAvLyBDYWxjdWxhdGUgdXNlZCBzdG9yYWdlIChyb3VnaCBlc3RpbWF0ZSlcbiAgICAgIGxldCB1c2VkID0gMDtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbG9jYWxTdG9yYWdlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGtleSA9IGxvY2FsU3RvcmFnZS5rZXkoaSk7XG4gICAgICAgIGlmIChrZXk/LnN0YXJ0c1dpdGgoYHRrYS0ke3RoaXMuQ0FDSEVfVkVSU0lPTn0tYCkpIHtcbiAgICAgICAgICAvLyDinIUgUk9CVVNUOiBPbmx5IGNvdW50IGN1cnJlbnQgdmVyc2lvbiBzdG9yYWdlXG4gICAgICAgICAgY29uc3QgdmFsdWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgICAgICAgIHVzZWQgKz0gKGtleS5sZW5ndGggKyAodmFsdWU/Lmxlbmd0aCB8fCAwKSkgKiAyOyAvLyBVVEYtMTYgZW5jb2RpbmdcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBHZXQgc2VxdWVuY2UgY291bnRcbiAgICAgIGNvbnN0IGluZGV4RGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRoaXMuU0VRVUVOQ0VTX0tFWSk7XG4gICAgICBjb25zdCBzZXF1ZW5jZUNvdW50ID0gaW5kZXhEYXRhID8gSlNPTi5wYXJzZShpbmRleERhdGEpLmxlbmd0aCA6IDA7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZWQ6IE1hdGgucm91bmQodXNlZCAvIDEwMjQpLCAvLyBLQlxuICAgICAgICBhdmFpbGFibGU6IDUxMjAsIC8vIFJvdWdoIGVzdGltYXRlIG9mIDVNQiBsb2NhbFN0b3JhZ2UgbGltaXRcbiAgICAgICAgc2VxdWVuY2VzOiBzZXF1ZW5jZUNvdW50LFxuICAgICAgfTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiB7IHVzZWQ6IDAsIGF2YWlsYWJsZTogNTEyMCwgc2VxdWVuY2VzOiAwIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENsZWFyIG9sZCBjYWNoZWQgZGF0YSBhbmQgbWFsZm9ybWVkIHNlcXVlbmNlc1xuICAgKi9cbiAgYXN5bmMgY2xlYXJMZWdhY3lDYWNoZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgLy8gS2V5cyB0byBwcmVzZXJ2ZSAoZG9uJ3QgcmVtb3ZlIHRoZXNlIGltcG9ydGFudCBzdGF0ZSBrZXlzKVxuICAgICAgY29uc3QgcHJlc2VydmVLZXlzID0gW1xuICAgICAgICBcInRrYS1hcHAtdGFiLXN0YXRlLXYyXCIsXG4gICAgICAgIFwidGthLW1vZGVybi13ZWItc2V0dGluZ3NcIixcbiAgICAgICAgXCJ0a2EtYnJvd3NlLXN0YXRlLXYyXCIsXG4gICAgICAgIFwidGthLWJyb3dzZS1maWx0ZXItdjJcIixcbiAgICAgICAgXCJ0a2EtYnJvd3NlLXNvcnQtdjJcIixcbiAgICAgICAgXCJ0a2EtYnJvd3NlLXZpZXctdjJcIixcbiAgICAgICAgXCJ0a2EtYnJvd3NlLXNjcm9sbC12MlwiLFxuICAgICAgICBcInRrYS1icm93c2Utc2VsZWN0aW9uLXYyXCIsXG4gICAgICBdO1xuXG4gICAgICAvLyBDbGVhciBhbGwgb2xkIFRLQSBzdG9yYWdlIGtleXMgZXhjZXB0IHByZXNlcnZlZCBvbmVzXG4gICAgICBjb25zdCBrZXlzVG9SZW1vdmU6IHN0cmluZ1tdID0gW107XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxvY2FsU3RvcmFnZS5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBrZXkgPSBsb2NhbFN0b3JhZ2Uua2V5KGkpO1xuICAgICAgICBpZiAoXG4gICAgICAgICAga2V5Py5zdGFydHNXaXRoKFwidGthLVwiKSAmJlxuICAgICAgICAgICFrZXkuc3RhcnRzV2l0aChgdGthLSR7dGhpcy5DQUNIRV9WRVJTSU9OfS1gKSAmJlxuICAgICAgICAgICFwcmVzZXJ2ZUtleXMuaW5jbHVkZXMoa2V5KVxuICAgICAgICApIHtcbiAgICAgICAgICBrZXlzVG9SZW1vdmUucHVzaChrZXkpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFJlbW92ZSBvbGQga2V5c1xuICAgICAga2V5c1RvUmVtb3ZlLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENsZWFyIHNlc3Npb24gc3RvcmFnZSBhcyB3ZWxsXG4gICAgICBjb25zdCBzZXNzaW9uS2V5c1RvUmVtb3ZlOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZXNzaW9uU3RvcmFnZS5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBrZXkgPSBzZXNzaW9uU3RvcmFnZS5rZXkoaSk7XG4gICAgICAgIGlmIChrZXk/LnN0YXJ0c1dpdGgoXCJ0a2EtXCIpKSB7XG4gICAgICAgICAgc2Vzc2lvbktleXNUb1JlbW92ZS5wdXNoKGtleSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgc2Vzc2lvbktleXNUb1JlbW92ZS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gY2xlYXIgbGVnYWN5IGNhY2hlOlwiLCBlcnJvcik7XG4gICAgfVxuICB9XG59XG4iXSwibWFwcGluZ3MiOiJBQVVPLGFBQU0sK0JBQThEO0FBQUEsRUFDeEQsZ0JBQWdCO0FBQUE7QUFBQSxFQUNoQixnQkFBZ0IsT0FBTyxLQUFLLGFBQWE7QUFBQSxFQUN6QyxrQkFBa0IsT0FBTyxLQUFLLGFBQWE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtwRCxnQkFBZ0IsVUFBaUM7QUFFdkQsVUFBTSxPQUFPLFNBQVMsUUFBUSxTQUFTLFFBQVEsU0FBUyxNQUFNO0FBRTlELFdBQ0UsS0FBSyxTQUFTLEtBQ2QsS0FBSyxVQUFVO0FBQUEsSUFDZixDQUFDLEtBQUssU0FBUyxJQUFJO0FBQUEsSUFDbkIsQ0FBQyxLQUFLLFNBQVMsTUFB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