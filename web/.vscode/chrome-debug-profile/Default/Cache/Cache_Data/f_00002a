import { GridMode } from "/src/lib/domain/index.ts";
export class CodexService {
  constructor(letterMappingRepository, lessonRepository, pictographQueryService, operationsService) {
    this.letterMappingRepository = letterMappingRepository;
    this.lessonRepository = lessonRepository;
    this.pictographQueryService = pictographQueryService;
    this.operationsService = operationsService;
    console.log(
      "ðŸ”§ Clean CodexService initialized with proper dependency injection"
    );
  }
  initialized = false;
  /**
   * Initialize the service and all dependencies
   */
  async initialize() {
    if (this.initialized) return;
    try {
      console.log("ðŸš€ Initializing clean CodexService...");
      await Promise.all([
        this.letterMappingRepository.initialize(),
        this.lessonRepository.initialize(),
        this.pictographQueryService.initialize()
      ]);
      this.initialized = true;
      console.log("âœ… Clean CodexService fully initialized");
    } catch (error) {
      console.error("âŒ Failed to initialize clean CodexService:", error);
      throw error;
    }
  }
  /**
   * Load all pictographs in alphabetical order
   */
  async loadAllPictographs() {
    await this.initialize();
    console.log("ðŸ” Loading all codex pictographs...");
    const pictographs = await this.pictographQueryService.getAllCodexPictographs(
      GridMode.DIAMOND
    );
    console.log(
      `ðŸ“Š Loaded ${pictographs.length} pictographs from codex query service`
    );
    const sortedPictographs = this.sortPictographsAlphabetically(pictographs);
    console.log(
      `âœ… Sorted ${sortedPictographs.length} pictographs alphabetically`
    );
    return sortedPictographs;
  }
  /**
   * Search pictographs by letter or pattern
   */
  async searchPictographs(searchTerm) {
    await this.initialize();
    const pictographs = await this.pictographQueryService.searchPictographs(
      searchTerm,
      GridMode.DIAMOND
    );
    return this.sortPictographsAlphabetically(pictographs);
  }
  /**
   * Get a specific pictograph by letter
   */
  async getPictographByLetter(letter) {
    await this.initialize();
    return this.pictographQueryService.getPictographByLetter(
      letter,
      GridMode.DIAMOND
    );
  }
  /**
   * Get pictographs for a specific lesson type
   */
  async getPictographsForLesson(lessonType) {
    await this.initialize();
    console.log(`ðŸ“š Getting pictographs for lesson type: ${lessonType}`);
    const letters = this.lessonRepository.getLettersForLesson(lessonType);
    if (letters.length === 0) {
      console.warn(`No letters found for lesson type: ${lessonType}`);
      return [];
    }
    const pictographs = await this.pictographQueryService.getPictographsByLetters(
      letters,
      GridMode.DIAMOND
    );
    return this.sortPictographsAlphabetically(pictographs);
  }
  /**
   * Get letters organized by rows for grid display
   */
  getLettersByRow() {
    this.ensureInitialized();
    const rows = this.letterMappingRepository.getLetterRows();
    return rows.map((row) => [...row.letters]);
  }
  /**
   * Apply rotate operation to all pictographs
   */
  async rotateAllPictographs(pictographs) {
    await this.initialize();
    return this.operationsService.rotateAllPictographs(pictographs);
  }
  /**
   * Apply mirror operation to all pictographs
   */
  async mirrorAllPictographs(pictographs) {
    await this.initialize();
    return this.operationsService.mirrorAllPictographs(pictographs);
  }
  /**
   * Apply color swap operation to all pictographs
   */
  async colorSwapAllPictographs(pictographs) {
    await this.initialize();
    return this.operationsService.colorSwapAllPictographs(pictographs);
  }
  /**
   * Get all pictograph data organized by letter
   */
  async getAllPictographData() {
    await this.initialize();
    const allLetters = this.letterMappingRepository.getAllLetters();
    const result = {};
    allLetters.forEach((letter) => {
      result[letter] = null;
    });
    const pictographs = await this.loadAllPictographs();
    pictographs.forEach((pictograph) => {
      if (pictograph.letter) {
        result[pictograph.letter] = pictograph;
      }
    });
    return result;
  }
  // Additional clean helper methods
  /**
   * Get available lesson types
   */
  async getAvailableLessonTypes() {
    await this.initialize();
    return this.lessonRepository.getAllLessonTypes();
  }
  /**
   * Get letters by category
   */
  getLettersByCategory(category) {
    this.ensureInitialized();
    return this.letterMappingRepository.getLettersByCategory(category);
  }
  /**
   * Check if a letter is valid in the codex
   */
  isValidLetter(letter) {
    this.ensureInitialized();
    return this.letterMappingRepository.isValidLetter(letter);
  }
  // Private helper methods
  sortPictographsAlphabetically(pictographs) {
    return [...pictographs].sort((a, b) => {
      const letterA = a.letter || "";
      const letterB = b.letter || "";
      return letterA.localeCompare(letterB);
    });
  }
  ensureInitialized() {
    if (!this.initialized) {
      throw new Error(
        "CodexService not initialized. Methods will auto-initialize, but sync methods require prior initialization."
      );
    }
  }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvZGV4U2VydmljZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENsZWFuIENvZGV4IFNlcnZpY2UgSW1wbGVtZW50YXRpb25cbiAqXG4gKiBBIGNsZWFuLCBtYWludGFpbmFibGUgaW1wbGVtZW50YXRpb24gdGhhdCB1c2VzIHByb3BlciBzZXBhcmF0aW9uIG9mIGNvbmNlcm5zLlxuICogTm8gbW9yZSBoYXJkY29kZWQgbWFwcGluZ3Mgb3IgbWl4ZWQgcmVzcG9uc2liaWxpdGllcyFcbiAqL1xuXG5pbXBvcnQgeyBHcmlkTW9kZSB9IGZyb20gXCIkbGliL2RvbWFpblwiO1xuaW1wb3J0IHR5cGUgeyBQaWN0b2dyYXBoRGF0YSB9IGZyb20gXCIkbGliL2RvbWFpbi9QaWN0b2dyYXBoRGF0YVwiO1xuaW1wb3J0IHR5cGUgeyBMZXR0ZXJDYXRlZ29yeSB9IGZyb20gXCIkbGliL2RvbWFpbi9jb2RleC90eXBlc1wiO1xuaW1wb3J0IHR5cGUgeyBJTGV0dGVyTWFwcGluZ1JlcG9zaXRvcnkgfSBmcm9tIFwiJGxpYi9yZXBvc2l0b3JpZXMvTGV0dGVyTWFwcGluZ1JlcG9zaXRvcnlcIjtcbmltcG9ydCB0eXBlIHsgSUxlc3NvblJlcG9zaXRvcnkgfSBmcm9tIFwiJGxpYi9yZXBvc2l0b3JpZXMvTGVzc29uUmVwb3NpdG9yeVwiO1xuaW1wb3J0IHR5cGUgeyBJUGljdG9ncmFwaFF1ZXJ5U2VydmljZSB9IGZyb20gXCIuL1BpY3RvZ3JhcGhRdWVyeVNlcnZpY2VcIjtcbmltcG9ydCB0eXBlIHsgSVBpY3RvZ3JhcGhPcGVyYXRpb25zU2VydmljZSB9IGZyb20gXCIuL1BpY3RvZ3JhcGhPcGVyYXRpb25zU2VydmljZVwiO1xuaW1wb3J0IHR5cGUgeyBJQ29kZXhTZXJ2aWNlIH0gZnJvbSBcIi4vSUNvZGV4U2VydmljZVwiO1xuXG4vLyBSZS1leHBvcnQgdGhlIGludGVyZmFjZSBmb3IgY29udmVuaWVuY2VcbmV4cG9ydCB0eXBlIHsgSUNvZGV4U2VydmljZSB9IGZyb20gXCIuL0lDb2RleFNlcnZpY2VcIjtcblxuZXhwb3J0IGNsYXNzIENvZGV4U2VydmljZSBpbXBsZW1lbnRzIElDb2RleFNlcnZpY2Uge1xuICBwcml2YXRlIGluaXRpYWxpemVkID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBsZXR0ZXJNYXBwaW5nUmVwb3NpdG9yeTogSUxldHRlck1hcHBpbmdSZXBvc2l0b3J5LFxuICAgIHByaXZhdGUgbGVzc29uUmVwb3NpdG9yeTogSUxlc3NvblJlcG9zaXRvcnksXG4gICAgcHJpdmF0ZSBwaWN0b2dyYXBoUXVlcnlTZXJ2aWNlOiBJUGljdG9ncmFwaFF1ZXJ5U2VydmljZSxcbiAgICBwcml2YXRlIG9wZXJhdGlvbnNTZXJ2aWNlOiBJUGljdG9ncmFwaE9wZXJhdGlvbnNTZXJ2aWNlXG4gICkge1xuICAgIGNvbnNvbGUubG9nKFxuICAgICAgXCLwn5SnIENsZWFuIENvZGV4U2VydmljZSBpbml0aWFsaXplZCB3aXRoIHByb3BlciBkZXBlbmRlbmN5IGluamVjdGlvblwiXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHRoZSBzZXJ2aWNlIGFuZCBhbGwgZGVwZW5kZW5jaWVzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGluaXRpYWxpemUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHJldHVybjtcblxuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZyhcIvCfmoAgSW5pdGlhbGl6aW5nIGNsZWFuIENvZGV4U2VydmljZS4uLlwiKTtcblxuICAgICAgLy8gSW5pdGlhbGl6ZSBhbGwgcmVwb3NpdG9yaWVzIGFuZCBzZXJ2aWNlc1xuICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICB0aGlzLmxldHRlck1hcHBpbmdSZXBvc2l0b3J5LmluaXRpYWxpemUoKSxcbiAgICAgICAgdGhpcy5sZXNzb25SZXBvc2l0b3J5LmluaXRpYWxpemUoKSxcbiAgICAgICAgdGhpcy5waWN0b2dyYXBoUXVlcnlTZXJ2aWNlLmluaXRpYWxpemUoKSxcbiAgICAgIF0pO1xuXG4gICAgICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgIGNvbnNvbGUubG9nKFwi4pyFIENsZWFuIENvZGV4U2VydmljZSBmdWxseSBpbml0aWFsaXplZFwiKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBGYWlsZWQgdG8gaW5pdGlhbGl6ZSBjbGVhbiBDb2RleFNlcnZpY2U6XCIsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBMb2FkIGFsbCBwaWN0b2dyYXBocyBpbiBhbHBoYWJldGljYWwgb3JkZXJcbiAgICovXG4gIGFzeW5jIGxvYWRBbGxQaWN0b2dyYXBocygpOiBQcm9taXNlPFBpY3RvZ3JhcGhEYXRhW10+IHtcbiAgICBhd2FpdCB0aGlzLmluaXRpYWxpemUoKTtcblxuICAgIGNvbnNvbGUubG9nKFwi8J+UjSBMb2FkaW5nIGFsbCBjb2RleCBwaWN0b2dyYXBocy4uLlwiKTtcbiAgICBjb25zdCBwaWN0b2dyYXBocyA9XG4gICAgICBhd2FpdCB0aGlzLnBpY3RvZ3JhcGhRdWVyeVNlcnZpY2UuZ2V0QWxsQ29kZXhQaWN0b2dyYXBocyhcbiAgICAgICAgR3JpZE1vZGUuRElBTU9ORFxuICAgICAgKTtcbiAgICBjb25zb2xlLmxvZyhcbiAgICAgIGDwn5OKIExvYWRlZCAke3BpY3RvZ3JhcGhzLmxlbmd0aH0gcGljdG9ncmFwaHMgZnJvbSBjb2RleCBxdWVyeSBzZXJ2aWNlYFxuICAgICk7XG4gICAgY29uc3Qgc29ydGVkUGljdG9ncmFwaHMgPSB0aGlzLnNvcnRQaWN0b2dyYXBoc0FscGhhYmV0aWNhbGx5KHBpY3RvZ3JhcGhzKTtcbiAgICBjb25zb2xlLmxvZyhcbiAgICAgIGDinIUgU29ydGVkICR7c29ydGVkUGljdG9ncmFwaHMubGVuZ3RofSBwaWN0b2dyYXBocyBhbHBoYWJldGljYWxseWBcbiAgICApO1xuICAgIHJldHVybiBzb3J0ZWRQaWN0b2dyYXBocztcbiAgfVxuXG4gIC8qKlxuICAgKiBTZWFyY2ggcGljdG9ncmFwaHMgYnkgbGV0dGVyIG9yIHBhdHRlcm5cbiAgICovXG4gIGFzeW5jIHNlYXJjaFBpY3RvZ3JhcGhzKHNlYXJjaFRlcm06IHN0cmluZyk6IFByb21pc2U8UGljdG9ncmFwaERhdGFbXT4ge1xuICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZSgpO1xuXG4gICAgY29uc3QgcGljdG9ncmFwaHMgPSBhd2FpdCB0aGlzLnBpY3RvZ3JhcGhRdWVyeVNlcnZpY2Uuc2VhcmNoUGljdG9ncmFwaHMoXG4gICAgICBzZWFyY2hUZXJtLFxuICAgICAgR3JpZE1vZGUuRElBTU9ORFxuICAgICk7XG4gICAgcmV0dXJuIHRoaXMuc29ydFBpY3RvZ3JhcGhzQWxwaGFiZXRpY2FsbHkocGljdG9ncmFwaHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhIHNwZWNpZmljIHBpY3RvZ3JhcGggYnkgbGV0dGVyXG4gICAqL1xuICBhc3luYyBnZXRQaWN0b2dyYXBoQnlMZXR0ZXIobGV0dGVyOiBzdHJpbmcpOiBQcm9taXNlPFBpY3RvZ3JhcGhEYXRhIHwgbnVsbD4ge1xuICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZSgpO1xuXG4gICAgcmV0dXJuIHRoaXMucGljdG9ncmFwaFF1ZXJ5U2VydmljZS5nZXRQaWN0b2dyYXBoQnlMZXR0ZXIoXG4gICAgICBsZXR0ZXIsXG4gICAgICBHcmlkTW9kZS5ESUFNT05EXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgcGljdG9ncmFwaHMgZm9yIGEgc3BlY2lmaWMgbGVzc29uIHR5cGVcbiAgICovXG4gIGFzeW5jIGdldFBpY3RvZ3JhcGhzRm9yTGVzc29uKGxlc3NvblR5cGU6IHN0cmluZyk6IFByb21pc2U8UGljdG9ncmFwaERhdGFbXT4ge1xuICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZSgpO1xuXG4gICAgY29uc29sZS5sb2coYPCfk5ogR2V0dGluZyBwaWN0b2dyYXBocyBmb3IgbGVzc29uIHR5cGU6ICR7bGVzc29uVHlwZX1gKTtcblxuICAgIGNvbnN0IGxldHRlcnMgPSB0aGlzLmxlc3NvblJlcG9zaXRvcnkuZ2V0TGV0dGVyc0Zvckxlc3NvbihsZXNzb25UeXBlKTtcbiAgICBpZiAobGV0dGVycy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnNvbGUud2FybihgTm8gbGV0dGVycyBmb3VuZCBmb3IgbGVzc29uIHR5cGU6ICR7bGVzc29uVHlwZX1gKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBjb25zdCBwaWN0b2dyYXBocyA9XG4gICAgICBhd2FpdCB0aGlzLnBpY3RvZ3JhcGhRdWVyeVNlcnZpY2UuZ2V0UGljdG9ncmFwaHNCeUxldHRlcnMoXG4gICAgICAgIGxldHRlcnMsXG4gICAgICAgIEdyaWRNb2RlLkRJQU1PTkRcbiAgICAgICk7XG4gICAgcmV0dXJuIHRoaXMuc29ydFBpY3RvZ3JhcGhzQWxwaGFiZXRpY2FsbHkocGljdG9ncmFwaHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBsZXR0ZXJzIG9yZ2FuaXplZCBieSByb3dzIGZvciBncmlkIGRpc3BsYXlcbiAgICovXG4gIGdldExldHRlcnNCeVJvdygpOiBzdHJpbmdbXVtdIHtcbiAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG5cbiAgICBjb25zdCByb3dzID0gdGhpcy5sZXR0ZXJNYXBwaW5nUmVwb3NpdG9yeS5nZXRMZXR0ZXJSb3dzKCk7XG4gICAgcmV0dXJuIHJvd3MubWFwKChyb3cpID0+IFsuLi5yb3cubGV0dGVyc10pOyAvLyBSZXR1cm4gY29weSB0byBwcmV2ZW50IG11dGF0aW9uXG4gIH1cblxuICAvKipcbiAgICogQXBwbHkgcm90YXRlIG9wZXJhdGlvbiB0byBhbGwgcGljdG9ncmFwaHNcbiAgICovXG4gIGFzeW5jIHJvdGF0ZUFsbFBpY3RvZ3JhcGhzKFxuICAgIHBpY3RvZ3JhcGhzOiBQaWN0b2dyYXBoRGF0YVtdXG4gICk6IFByb21pc2U8UGljdG9ncmFwaERhdGFbXT4ge1xuICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZSgpO1xuXG4gICAgcmV0dXJuIHRoaXMub3BlcmF0aW9uc1NlcnZpY2Uucm90YXRlQWxsUGljdG9ncmFwaHMocGljdG9ncmFwaHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFwcGx5IG1pcnJvciBvcGVyYXRpb24gdG8gYWxsIHBpY3RvZ3JhcGhzXG4gICAqL1xuICBhc3luYyBtaXJyb3JBbGxQaWN0b2dyYXBocyhcbiAgICBwaWN0b2dyYXBoczogUGljdG9ncmFwaERhdGFbXVxuICApOiBQcm9taXNlPFBpY3RvZ3JhcGhEYXRhW10+IHtcbiAgICBhd2FpdCB0aGlzLmluaXRpYWxpemUoKTtcblxuICAgIHJldHVybiB0aGlzLm9wZXJhdGlvbnNTZXJ2aWNlLm1pcnJvckFsbFBpY3RvZ3JhcGhzKHBpY3RvZ3JhcGhzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBcHBseSBjb2xvciBzd2FwIG9wZXJhdGlvbiB0byBhbGwgcGljdG9ncmFwaHNcbiAgICovXG4gIGFzeW5jIGNvbG9yU3dhcEFsbFBpY3RvZ3JhcGhzKFxuICAgIHBpY3RvZ3JhcGhzOiBQaWN0b2dyYXBoRGF0YVtdXG4gICk6IFByb21pc2U8UGljdG9ncmFwaERhdGFbXT4ge1xuICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZSgpO1xuXG4gICAgcmV0dXJuIHRoaXMub3BlcmF0aW9uc1NlcnZpY2UuY29sb3JTd2FwQWxsUGljdG9ncmFwaHMocGljdG9ncmFwaHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbGwgcGljdG9ncmFwaCBkYXRhIG9yZ2FuaXplZCBieSBsZXR0ZXJcbiAgICovXG4gIGFzeW5jIGdldEFsbFBpY3RvZ3JhcGhEYXRhKCk6IFByb21pc2U8UmVjb3JkPHN0cmluZywgUGljdG9ncmFwaERhdGEgfCBudWxsPj4ge1xuICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZSgpO1xuXG4gICAgY29uc3QgYWxsTGV0dGVycyA9IHRoaXMubGV0dGVyTWFwcGluZ1JlcG9zaXRvcnkuZ2V0QWxsTGV0dGVycygpO1xuICAgIGNvbnN0IHJlc3VsdDogUmVjb3JkPHN0cmluZywgUGljdG9ncmFwaERhdGEgfCBudWxsPiA9IHt9O1xuXG4gICAgLy8gSW5pdGlhbGl6ZSBhbGwgbGV0dGVycyB0byBudWxsXG4gICAgYWxsTGV0dGVycy5mb3JFYWNoKChsZXR0ZXIpID0+IHtcbiAgICAgIHJlc3VsdFtsZXR0ZXJdID0gbnVsbDtcbiAgICB9KTtcblxuICAgIC8vIExvYWQgYWN0dWFsIHBpY3RvZ3JhcGhzXG4gICAgY29uc3QgcGljdG9ncmFwaHMgPSBhd2FpdCB0aGlzLmxvYWRBbGxQaWN0b2dyYXBocygpO1xuICAgIHBpY3RvZ3JhcGhzLmZvckVhY2goKHBpY3RvZ3JhcGgpID0+IHtcbiAgICAgIGlmIChwaWN0b2dyYXBoLmxldHRlcikge1xuICAgICAgICByZXN1bHRbcGljdG9ncmFwaC5sZXR0ZXJdID0gcGljdG9ncmFwaDtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvLyBBZGRpdGlvbmFsIGNsZWFuIGhlbHBlciBtZXRob2RzXG5cbiAgLyoqXG4gICAqIEdldCBhdmFpbGFibGUgbGVzc29uIHR5cGVzXG4gICAqL1xuICBhc3luYyBnZXRBdmFpbGFibGVMZXNzb25UeXBlcygpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgYXdhaXQgdGhpcy5pbml0aWFsaXplKCk7XG5cbiAgICByZXR1cm4gdGhpcy5sZXNzb25SZXBvc2l0b3J5LmdldEFsbExlc3NvblR5cGVzKCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGxldHRlcnMgYnkgY2F0ZWdvcnlcbiAgICovXG4gIGdldExldHRlcnNCeUNhdGVnb3J5KGNhdGVnb3J5OiBMZXR0ZXJDYXRlZ29yeSk6IHN0cmluZ1tdIHtcbiAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG5cbiAgICByZXR1cm4gdGhpcy5sZXR0ZXJNYXBwaW5nUmVwb3NpdG9yeS5nZXRMZXR0ZXJzQnlDYXRlZ29yeShjYXRlZ29yeSk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgYSBsZXR0ZXIgaXMgdmFsaWQgaW4gdGhlIGNvZGV4XG4gICAqL1xuICBpc1ZhbGlkTGV0dGVyKGxldHRlcjogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuXG4gICAgcmV0dXJuIHRoaXMubGV0dGVyTWFwcGluZ1JlcG9zaXRvcnkuaXNWYWxpZExldHRlcihsZXR0ZXIpO1xuICB9XG5cbiAgLy8gUHJpdmF0ZSBoZWxwZXIgbWV0aG9kc1xuXG4gIHByaXZhdGUgc29ydFBpY3RvZ3JhcGhzQWxwaGFiZXRpY2FsbHkoXG4gICAgcGljdG9ncmFwaHM6IFBpY3RvZ3JhcGhEYXRhW11cbiAgKTogUGljdG9ncmFwaERhdGFbXSB7XG4gICAgcmV0dXJuIFsuLi5waWN0b2dyYXBoc10uc29ydCgoYSwgYikgPT4ge1xuICAgICAgY29uc3QgbGV0dGVyQSA9IGEubGV0dGVyIHx8IFwiXCI7XG4gICAgICBjb25zdCBsZXR0ZXJCID0gYi5sZXR0ZXIgfHwgXCJcIjtcbiAgICAgIHJldHVybiBsZXR0ZXJBLmxvY2FsZUNvbXBhcmUobGV0dGVyQik7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGVuc3VyZUluaXRpYWxpemVkKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBcIkNvZGV4U2VydmljZSBub3QgaW5pdGlhbGl6ZWQuIE1ldGhvZHMgd2lsbCBhdXRvLWluaXRpYWxpemUsIGJ1dCBzeW5jIG1ldGhvZHMgcmVxdWlyZSBwcmlvciBpbml0aWFsaXphdGlvbi5cIlxuICAgICAgKTtcbiAgICB9XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6IkFBT0EsU0FBUyxnQkFBZ0I7QUFZbEIsYUFBTSxhQUFzQztBQUFBLEVBR2pELFlBQ1UseUJBQ0Esa0JBQ0Esd0JBQ0EsbUJBQ1I7QUFKUTtBQUNBO0FBQ0E7QUFDQTtBQUVSLFlBQVE7QUFBQSxNQUNOO0FBQUEsSUFDRjtBQUFBLEVBQ0Y7QUFBQSxFQVhRLGNBQWM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQWdCdEIsTUFBYyxhQUE0QjtBQUN4QyxRQUFJLEtBQUssWUFBYTtBQUV0QixRQUFJO0FBQ0YsY0FBUSxJQUFJLHVDQUF1QztBQUduRCxZQUFNLFFBQVEsSUFBSTtBQUFBLFFBQ2hCLEtBQUssd0JBQXdCLFdBQVc7QUFBQSxRQUN4QyxLQUFLLGlCQUFpQixXQUFXO0FBQUEsUUFDakMsS0FBSyx1QkFBdUIsV0FBVztBQUFBLE1BQ3pDLENBQUM7QUFFRCxXQUFLLGNBQWM7QUFDbkIsY0FBUSxJQUFJLHdDQUF3QztBQUFBLElBQ3RELFNBQVMsT0FBTztBQUNkLGNBQVEsTUFBTSw4Q0FBOEMsS0FBSztBQUNqRSxZQUFNO0FBQUEsSUFDUjtBQUFBLEVBQ0Y7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0scUJBQWdEO0FBQ3BELFVBQU0sS0FBSyxXQUFXO0FBRXRCLFlBQVEsSUFBSSxxQ0FBcUM7QUFDakQsVUFBTSxjQUNKLE1BQU0sS0FBSyx1QkFBdUI7QUFBQSxNQUNoQyxTQUFTO0FBQUEsSUFDWDtBQUNGLFlBQVE7QUFBQSxNQUNOLGFBQWEsWUFBWSxNQUFNO0FBQUEsSUFDakM7QUFDQSxVQUFNLG9CQUFvQixLQUFLLDhCQUE4QixXQUFXO0FBQ3hFLFlBQVE7QUFBQSxNQUNOLFlBQVksa0JBQWtCLE1BQU07QUFBQSxJQUN0QztBQUNBLFdBQU87QUFBQSxFQUNUO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLGtCQUFrQixZQUErQztBQUNyRSxVQUFNLEtBQUssV0FBVztBQUV0QixVQUFNLGNBQWMsTUFBTSxLQUFLLHVCQUF1QjtBQUFBLE1BQ3BEO0FBQUEsTUFDQSxTQUFTO0FBQUEsSUFDWDtBQUNBLFdBQU8sS0FBSyw4QkFBOEIsV0FBVztBQUFBLEVBQ3ZEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLHNCQUFzQixRQUFnRDtBQUMxRSxVQUFNLEtBQUssV0FBVztBQUV0QixXQUFPLEtBQUssdUJBQXVCO0FBQUEsTUFDakM7QUFBQSxNQUNBLFNBQVM7QUFBQSxJQUNYO0FBQUEsRUFDRjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSx3QkFBd0IsWUFBK0M7QUFDM0UsVUFBTSxLQUFLLFdBQVc7QUFFdEIsWUFBUSxJQUFJLDJDQUEyQyxVQUFVLEVBQUU7QUFFbkUsVUFBTSxVQUFVLEtBQUssaUJBQWlCLG9CQUFvQixVQUFVO0FBQ3BFLFFBQUksUUFBUSxXQUFXLEdBQUc7QUFDeEIsY0FBUSxLQUFLLHFDQUFxQyxVQUFVLEVBQUU7QUFDOUQsYUFBTyxDQUFDO0FBQUEsSUFDVjtBQUVBLFVBQU0sY0FDSixNQUFNLEtBQUssdUJBQXVCO0FBQUEsTUFDaEM7QUFBQSxNQUNBLFNBQVM7QUFBQSxJQUNYO0FBQ0YsV0FBTyxLQUFLLDhCQUE4QixXQUFXO0FBQUEsRUFDdkQ7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGtCQUE4QjtBQUM1QixTQUFLLGtCQUFrQjtBQUV2QixVQUFNLE9BQU8sS0FBSyx3QkFBd0IsY0FBYztBQUN4RCxXQUFPLEtBQUssSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLElBQUksT0FBTyxDQUFDO0FBQUEsRUFDM0M7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0scUJBQ0osYUFDMkI7QUFDM0IsVUFBTSxLQUFLLFdBQVc7QUFFdEIsV0FBTyxLQUFLLGtCQUFrQixxQkFBcUIsV0FBVztBQUFBLEVBQ2hFO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLHFCQUNKLGFBQzJCO0FBQzNCLFVBQU0sS0FBSyxXQUFXO0FBRXRCLFdBQU8sS0FBSyxrQkFBa0IscUJBQXFCLFdBQVc7QUFBQSxFQUNoRTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSx3QkFDSixhQUMyQjtBQUMzQixVQUFNLEtBQUssV0FBVztBQUV0QixXQUFPLEtBQUssa0JBQWtCLHdCQUF3QixXQUFXO0FBQUEsRUFDbkU7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sdUJBQXVFO0FBQzNFLFVBQU0sS0FBSyxXQUFXO0FBRXRCLFVBQU0sYUFBYSxLQUFLLHdCQUF3QixjQUFjO0FBQzlELFVBQU0sU0FBZ0QsQ0FBQztBQUd2RCxlQUFXLFFBQVEsQ0FBQyxXQUFXO0FBQzdCLGFBQU8sTUFBTSxJQUFJO0FBQUEsSUFDbkIsQ0FBQztBQUdELFVBQU0sY0FBYyxNQUFNLEtBQUssbUJBQW1CO0FBQ2xELGdCQUFZLFFBQVEsQ0FBQyxlQUFlO0FBQ2xDLFVBQUksV0FBVyxRQUFRO0FBQ3JCLGVBQU8sV0FBVyxNQUFNLElBQUk7QUFBQSxNQUM5QjtBQUFBLElBQ0YsQ0FBQztBQUVELFdBQU87QUFBQSxFQUNUO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU9BLE1BQU0sMEJBQTZDO0FBQ2pELFVBQU0sS0FBSyxXQUFXO0FBRXRCLFdBQU8sS0FBSyxpQkFBaUIsa0JBQWtCO0FBQUEsRUFDakQ7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHFCQUFxQixVQUFvQztBQUN2RCxTQUFLLGtCQUFrQjtBQUV2QixXQUFPLEtBQUssd0JBQXdCLHFCQUFxQixRQUFRO0FBQUEsRUFDbkU7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGNBQWMsUUFBeUI7QUFDckMsU0FBSyxrQkFBa0I7QUFFdkIsV0FBTyxLQUFLLHdCQUF3QixjQUFjLE1BQU07QUFBQSxFQUMxRDtBQUFBO0FBQUEsRUFJUSw4QkFDTixhQUNrQjtBQUNsQixXQUFPLENBQUMsR0FBRyxXQUFXLEVBQUUsS0FBSyxDQUFDLEdBQUcsTUFBTTtBQUNyQyxZQUFNLFVBQVUsRUFBRSxVQUFVO0FBQzVCLFlBQU0sVUFBVSxFQUFFLFVBQVU7QUFDNUIsYUFBTyxRQUFRLGNBQWMsT0FBTztBQUFBLElBQ3RDLENBQUM7QUFBQSxFQUNIO0FBQUEsRUFFUSxvQkFBMEI7QUFDaEMsUUFBSSxDQUFDLEtBQUssYUFBYTtBQUNyQixZQUFNLElBQUk7QUFBQSxRQUNSO0FBQUEsTUFDRjtBQUFBLElBQ0Y7QUFBQSxFQUNGO0FBQ0Y7IiwibmFtZXMiOltdfQ==