export class SequenceIndexService {
  sequenceIndex = null;
  searchIndex = null;
  sequenceMap = /* @__PURE__ */ new Map();
  async loadSequenceIndex() {
    if (this.sequenceIndex !== null) {
      return this.sequenceIndex;
    }
    try {
      if (this.sequenceIndex === null) {
        this.sequenceIndex = await this.scanSequenceDirectory();
      }
      if (this.sequenceIndex) {
        await this.buildSearchIndex(this.sequenceIndex);
      }
      return this.sequenceIndex || [];
    } catch (error) {
      console.error("Failed to load sequence index:", error);
      this.sequenceIndex = [];
      return [];
    }
  }
  async buildSearchIndex(sequences) {
    this.searchIndex = {
      wordIndex: /* @__PURE__ */ new Map(),
      authorIndex: /* @__PURE__ */ new Map(),
      tagIndex: /* @__PURE__ */ new Map(),
      metadataIndex: /* @__PURE__ */ new Map()
    };
    this.sequenceMap.clear();
    for (const sequence of sequences) {
      this.sequenceMap.set(sequence.id, sequence);
      this.addToIndex(
        this.searchIndex.wordIndex,
        sequence.word.toLowerCase(),
        sequence.id
      );
      this.addToIndex(
        this.searchIndex.wordIndex,
        sequence.name.toLowerCase(),
        sequence.id
      );
      if (sequence.author) {
        this.addToIndex(
          this.searchIndex.authorIndex,
          sequence.author.toLowerCase(),
          sequence.id
        );
      }
      for (const tag of sequence.tags) {
        this.addToIndex(
          this.searchIndex.tagIndex,
          tag.toLowerCase(),
          sequence.id
        );
      }
      const searchableText = this.buildSearchableText(sequence);
      for (const term of searchableText.split(/\s+/)) {
        if (term.length > 2) {
          this.addToIndex(
            this.searchIndex.metadataIndex,
            term.toLowerCase(),
            sequence.id
          );
        }
      }
    }
  }
  async searchSequences(query) {
    if (!this.searchIndex || !query.trim()) {
      return this.sequenceIndex || [];
    }
    const searchTerms = query.toLowerCase().split(/\s+/).filter((term) => term.length > 0);
    const resultIds = /* @__PURE__ */ new Set();
    for (const term of searchTerms) {
      const matchingIds = this.searchTerm(term);
      if (resultIds.size === 0) {
        matchingIds.forEach((id) => resultIds.add(id));
      } else {
        const currentIds = new Set(resultIds);
        resultIds.clear();
        matchingIds.forEach((id) => {
          if (currentIds.has(id)) {
            resultIds.add(id);
          }
        });
      }
    }
    const results = Array.from(resultIds).map((id) => this.sequenceMap.get(id)).filter((seq) => seq !== void 0);
    return this.sortByRelevance(results, query);
  }
  async refreshIndex() {
    this.sequenceIndex = null;
    this.searchIndex = null;
    this.sequenceMap.clear();
    await this.loadSequenceIndex();
  }
  // Additional utility methods
  getIndexStats() {
    return {
      totalSequences: this.sequenceMap.size,
      indexedWords: this.searchIndex?.wordIndex.size || 0,
      indexedAuthors: this.searchIndex?.authorIndex.size || 0,
      indexedTags: this.searchIndex?.tagIndex.size || 0,
      indexedMetadata: this.searchIndex?.metadataIndex.size || 0
    };
  }
  async getSequenceById(id) {
    if (!this.sequenceMap.has(id)) {
      await this.loadSequenceIndex();
    }
    return this.sequenceMap.get(id) || null;
  }
  async getSuggestions(partialQuery, maxSuggestions = 10) {
    if (!this.searchIndex || partialQuery.length < 2) {
      return [];
    }
    const suggestions = /* @__PURE__ */ new Set();
    const query = partialQuery.toLowerCase();
    for (const [word] of this.searchIndex.wordIndex) {
      if (word.includes(query)) {
        suggestions.add(word);
        if (suggestions.size >= maxSuggestions) break;
      }
    }
    if (suggestions.size < maxSuggestions) {
      for (const [author] of this.searchIndex.authorIndex) {
        if (author.includes(query)) {
          suggestions.add(author);
          if (suggestions.size >= maxSuggestions) break;
        }
      }
    }
    return Array.from(suggestions).slice(0, maxSuggestions);
  }
  // Private helper methods
  addToIndex(index, key, sequenceId) {
    if (!index.has(key)) {
      index.set(key, /* @__PURE__ */ new Set());
    }
    const keySet = index.get(key);
    if (keySet) {
      keySet.add(sequenceId);
    }
  }
  searchTerm(term) {
    const results = /* @__PURE__ */ new Set();
    if (!this.searchIndex) return results;
    const wordMatches = this.searchIndex.wordIndex.get(term) || /* @__PURE__ */ new Set();
    wordMatches.forEach((id) => results.add(id));
    for (const [word, ids] of this.searchIndex.wordIndex) {
      if (word.includes(term)) {
        ids.forEach((id) => results.add(id));
      }
    }
    const authorMatches = this.searchIndex.authorIndex.get(term) || /* @__PURE__ */ new Set();
    authorMatches.forEach((id) => results.add(id));
    const tagMatches = this.searchIndex.tagIndex.get(term) || /* @__PURE__ */ new Set();
    tagMatches.forEach((id) => results.add(id));
    const metadataMatches = this.searchIndex.metadataIndex.get(term) || /* @__PURE__ */ new Set();
    metadataMatches.forEach((id) => results.add(id));
    return results;
  }
  buildSearchableText(sequence) {
    const parts = [
      sequence.word,
      sequence.name,
      sequence.author || "",
      sequence.difficultyLevel || "",
      sequence.gridMode || "",
      sequence.propType || "",
      ...sequence.tags
    ];
    return parts.filter(Boolean).join(" ");
  }
  sortByRelevance(sequences, query) {
    const queryLower = query.toLowerCase();
    return sequences.sort((a, b) => {
      const scoreA = this.calculateRelevanceScore(a, queryLower);
      const scoreB = this.calculateRelevanceScore(b, queryLower);
      return scoreB - scoreA;
    });
  }
  calculateRelevanceScore(sequence, query) {
    let score = 0;
    if (sequence.word.toLowerCase() === query) {
      score += 100;
    }
    if (sequence.word.toLowerCase().startsWith(query)) {
      score += 50;
    }
    if (sequence.word.toLowerCase().includes(query)) {
      score += 25;
    }
    if (sequence.name.toLowerCase().includes(query)) {
      score += 15;
    }
    if (sequence.author?.toLowerCase().includes(query)) {
      score += 10;
    }
    for (const tag of sequence.tags) {
      if (tag.toLowerCase().includes(query)) {
        score += 5;
      }
    }
    if (sequence.isFavorite) {
      score += 2;
    }
    return score;
  }
  async scanSequenceDirectory() {
    console.warn("Scanning directory - using fallback sample data");
    const sequences = [];
    const knownSequences = [
      "A",
      "AABB",
      "AAKE",
      "AB",
      "ABC",
      "AJEΦ-",
      "AKE",
      "AKIΦ",
      "ALFALGGF",
      "B",
      "BA",
      "BBKE",
      "BBLF",
      "BC",
      "BJEA",
      "BJFA",
      "BKEΦ-",
      "C",
      "CAKE",
      "CCCΦ-",
      "CCKE",
      "CCKΦ"
      // Add more as needed...
    ];
    for (let i = 0; i < knownSequences.length; i++) {
      const word = knownSequences[i];
      if (!word) continue;
      const authors = ["TKA User", "Demo Author", "Expert User"];
      const gridModes = ["diamond", "box"];
      const difficulties = ["beginner", "intermediate", "advanced"];
      const author = authors[i % authors.length];
      const gridMode = gridModes[i % gridModes.length];
      const difficulty = difficulties[i % difficulties.length];
      const result = {
        id: word,
        // ✅ FIXED: Keep uppercase to match PNG file names
        name: `${word} Sequence`,
        word,
        thumbnails: [`${word}_ver1.png`],
        isFavorite: Math.random() > 0.8,
        isCircular: false,
        tags: ["flow", "practice", "generated"].slice(
          0,
          Math.floor(Math.random() * 3) + 1
        ),
        metadata: { scanned: true, index: i }
      };
      if (author) result.author = author;
      if (gridMode) result.gridMode = gridMode;
      if (difficulty) result.difficultyLevel = difficulty;
      result.sequenceLength = Math.floor(Math.random() * 8) + 3;
      result.level = Math.floor(Math.random() * 4) + 1;
      result.dateAdded = new Date(
        Date.now() - Math.random() * 365 * 24 * 60 * 60 * 1e3
      );
      result.propType = "fans";
      result.startingPosition = "center";
      sequences.push(result);
    }
    return sequences;
  }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNlcXVlbmNlSW5kZXhTZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU2VxdWVuY2UgSW5kZXggU2VydmljZSBJbXBsZW1lbnRhdGlvblxuICpcbiAqIEhhbmRsZXMgbG9hZGluZywgYnVpbGRpbmcsIGFuZCBzZWFyY2hpbmcgc2VxdWVuY2UgaW5kaWNlcyBmb3IgZmFzdCBicm93c2Ugb3BlcmF0aW9ucy5cbiAqIFByb3ZpZGVzIHNlYXJjaCBjYXBhYmlsaXRpZXMgYWNyb3NzIHNlcXVlbmNlIG1ldGFkYXRhLlxuICovXG5cbmltcG9ydCB0eXBlIHsgQnJvd3NlU2VxdWVuY2VNZXRhZGF0YSB9IGZyb20gXCIkbGliL3NlcnZpY2VzL2ludGVyZmFjZXMvZG9tYWluLXR5cGVzXCI7XG5pbXBvcnQgdHlwZSB7IElTZXF1ZW5jZUluZGV4U2VydmljZSB9IGZyb20gXCIkbGliL3NlcnZpY2VzL2ludGVyZmFjZXMvYnJvd3NlLWludGVyZmFjZXNcIjtcblxuaW50ZXJmYWNlIFNlYXJjaEluZGV4IHtcbiAgd29yZEluZGV4OiBNYXA8c3RyaW5nLCBTZXQ8c3RyaW5nPj47IC8vIHdvcmQgLT4gc2VxdWVuY2UgSURzXG4gIGF1dGhvckluZGV4OiBNYXA8c3RyaW5nLCBTZXQ8c3RyaW5nPj47IC8vIGF1dGhvciAtPiBzZXF1ZW5jZSBJRHNcbiAgdGFnSW5kZXg6IE1hcDxzdHJpbmcsIFNldDxzdHJpbmc+PjsgLy8gdGFnIC0+IHNlcXVlbmNlIElEc1xuICBtZXRhZGF0YUluZGV4OiBNYXA8c3RyaW5nLCBTZXQ8c3RyaW5nPj47IC8vIGNvbWJpbmVkIG1ldGFkYXRhIC0+IHNlcXVlbmNlIElEc1xufVxuXG5leHBvcnQgY2xhc3MgU2VxdWVuY2VJbmRleFNlcnZpY2UgaW1wbGVtZW50cyBJU2VxdWVuY2VJbmRleFNlcnZpY2Uge1xuICBwcml2YXRlIHNlcXVlbmNlSW5kZXg6IEJyb3dzZVNlcXVlbmNlTWV0YWRhdGFbXSB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIHNlYXJjaEluZGV4OiBTZWFyY2hJbmRleCB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIHNlcXVlbmNlTWFwID0gbmV3IE1hcDxzdHJpbmcsIEJyb3dzZVNlcXVlbmNlTWV0YWRhdGE+KCk7XG5cbiAgYXN5bmMgbG9hZFNlcXVlbmNlSW5kZXgoKTogUHJvbWlzZTxCcm93c2VTZXF1ZW5jZU1ldGFkYXRhW10+IHtcbiAgICBpZiAodGhpcy5zZXF1ZW5jZUluZGV4ICE9PSBudWxsKSB7XG4gICAgICByZXR1cm4gdGhpcy5zZXF1ZW5jZUluZGV4O1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyBMb2FkIHNlcXVlbmNlcyBpZiBub3QgYWxyZWFkeSBsb2FkZWRcbiAgICAgIGlmICh0aGlzLnNlcXVlbmNlSW5kZXggPT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5zZXF1ZW5jZUluZGV4ID0gYXdhaXQgdGhpcy5zY2FuU2VxdWVuY2VEaXJlY3RvcnkoKTtcbiAgICAgIH1cblxuICAgICAgLy8gQnVpbGQgc2VhcmNoIGluZGV4XG4gICAgICBpZiAodGhpcy5zZXF1ZW5jZUluZGV4KSB7XG4gICAgICAgIGF3YWl0IHRoaXMuYnVpbGRTZWFyY2hJbmRleCh0aGlzLnNlcXVlbmNlSW5kZXgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5zZXF1ZW5jZUluZGV4IHx8IFtdO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGxvYWQgc2VxdWVuY2UgaW5kZXg6XCIsIGVycm9yKTtcbiAgICAgIC8vIFJldHVybiBlbXB0eSBhcnJheSBhcyBmYWxsYmFja1xuICAgICAgdGhpcy5zZXF1ZW5jZUluZGV4ID0gW107XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgYnVpbGRTZWFyY2hJbmRleChzZXF1ZW5jZXM6IEJyb3dzZVNlcXVlbmNlTWV0YWRhdGFbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuc2VhcmNoSW5kZXggPSB7XG4gICAgICB3b3JkSW5kZXg6IG5ldyBNYXAoKSxcbiAgICAgIGF1dGhvckluZGV4OiBuZXcgTWFwKCksXG4gICAgICB0YWdJbmRleDogbmV3IE1hcCgpLFxuICAgICAgbWV0YWRhdGFJbmRleDogbmV3IE1hcCgpLFxuICAgIH07XG5cbiAgICB0aGlzLnNlcXVlbmNlTWFwLmNsZWFyKCk7XG5cbiAgICBmb3IgKGNvbnN0IHNlcXVlbmNlIG9mIHNlcXVlbmNlcykge1xuICAgICAgdGhpcy5zZXF1ZW5jZU1hcC5zZXQoc2VxdWVuY2UuaWQsIHNlcXVlbmNlKTtcblxuICAgICAgLy8gSW5kZXggYnkgd29yZC9uYW1lXG4gICAgICB0aGlzLmFkZFRvSW5kZXgoXG4gICAgICAgIHRoaXMuc2VhcmNoSW5kZXgud29yZEluZGV4LFxuICAgICAgICBzZXF1ZW5jZS53b3JkLnRvTG93ZXJDYXNlKCksXG4gICAgICAgIHNlcXVlbmNlLmlkXG4gICAgICApO1xuICAgICAgdGhpcy5hZGRUb0luZGV4KFxuICAgICAgICB0aGlzLnNlYXJjaEluZGV4LndvcmRJbmRleCxcbiAgICAgICAgc2VxdWVuY2UubmFtZS50b0xvd2VyQ2FzZSgpLFxuICAgICAgICBzZXF1ZW5jZS5pZFxuICAgICAgKTtcblxuICAgICAgLy8gSW5kZXggYnkgYXV0aG9yXG4gICAgICBpZiAoc2VxdWVuY2UuYXV0aG9yKSB7XG4gICAgICAgIHRoaXMuYWRkVG9JbmRleChcbiAgICAgICAgICB0aGlzLnNlYXJjaEluZGV4LmF1dGhvckluZGV4LFxuICAgICAgICAgIHNlcXVlbmNlLmF1dGhvci50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgIHNlcXVlbmNlLmlkXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIC8vIEluZGV4IGJ5IHRhZ3NcbiAgICAgIGZvciAoY29uc3QgdGFnIG9mIHNlcXVlbmNlLnRhZ3MpIHtcbiAgICAgICAgdGhpcy5hZGRUb0luZGV4KFxuICAgICAgICAgIHRoaXMuc2VhcmNoSW5kZXgudGFnSW5kZXgsXG4gICAgICAgICAgdGFnLnRvTG93ZXJDYXNlKCksXG4gICAgICAgICAgc2VxdWVuY2UuaWRcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgLy8gSW5kZXggYnkgbWV0YWRhdGEgKGNvbWJpbmVkIHNlYXJjaGFibGUgdGV4dClcbiAgICAgIGNvbnN0IHNlYXJjaGFibGVUZXh0ID0gdGhpcy5idWlsZFNlYXJjaGFibGVUZXh0KHNlcXVlbmNlKTtcbiAgICAgIGZvciAoY29uc3QgdGVybSBvZiBzZWFyY2hhYmxlVGV4dC5zcGxpdCgvXFxzKy8pKSB7XG4gICAgICAgIGlmICh0ZXJtLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAvLyBPbmx5IGluZGV4IHRlcm1zIGxvbmdlciB0aGFuIDIgY2hhcmFjdGVyc1xuICAgICAgICAgIHRoaXMuYWRkVG9JbmRleChcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoSW5kZXgubWV0YWRhdGFJbmRleCxcbiAgICAgICAgICAgIHRlcm0udG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICAgIHNlcXVlbmNlLmlkXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHNlYXJjaFNlcXVlbmNlcyhxdWVyeTogc3RyaW5nKTogUHJvbWlzZTxCcm93c2VTZXF1ZW5jZU1ldGFkYXRhW10+IHtcbiAgICBpZiAoIXRoaXMuc2VhcmNoSW5kZXggfHwgIXF1ZXJ5LnRyaW0oKSkge1xuICAgICAgcmV0dXJuIHRoaXMuc2VxdWVuY2VJbmRleCB8fCBbXTtcbiAgICB9XG5cbiAgICBjb25zdCBzZWFyY2hUZXJtcyA9IHF1ZXJ5XG4gICAgICAudG9Mb3dlckNhc2UoKVxuICAgICAgLnNwbGl0KC9cXHMrLylcbiAgICAgIC5maWx0ZXIoKHRlcm0pID0+IHRlcm0ubGVuZ3RoID4gMCk7XG4gICAgY29uc3QgcmVzdWx0SWRzID0gbmV3IFNldDxzdHJpbmc+KCk7XG5cbiAgICBmb3IgKGNvbnN0IHRlcm0gb2Ygc2VhcmNoVGVybXMpIHtcbiAgICAgIGNvbnN0IG1hdGNoaW5nSWRzID0gdGhpcy5zZWFyY2hUZXJtKHRlcm0pO1xuXG4gICAgICAvLyBGb3IgbXVsdGlwbGUgdGVybXMsIHVzZSBpbnRlcnNlY3Rpb24gKEFORCBsb2dpYylcbiAgICAgIGlmIChyZXN1bHRJZHMuc2l6ZSA9PT0gMCkge1xuICAgICAgICBtYXRjaGluZ0lkcy5mb3JFYWNoKChpZCkgPT4gcmVzdWx0SWRzLmFkZChpZCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgY3VycmVudElkcyA9IG5ldyBTZXQocmVzdWx0SWRzKTtcbiAgICAgICAgcmVzdWx0SWRzLmNsZWFyKCk7XG4gICAgICAgIG1hdGNoaW5nSWRzLmZvckVhY2goKGlkKSA9PiB7XG4gICAgICAgICAgaWYgKGN1cnJlbnRJZHMuaGFzKGlkKSkge1xuICAgICAgICAgICAgcmVzdWx0SWRzLmFkZChpZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDb252ZXJ0IElEcyBiYWNrIHRvIHNlcXVlbmNlcyBhbmQgc29ydCBieSByZWxldmFuY2VcbiAgICBjb25zdCByZXN1bHRzID0gQXJyYXkuZnJvbShyZXN1bHRJZHMpXG4gICAgICAubWFwKChpZCkgPT4gdGhpcy5zZXF1ZW5jZU1hcC5nZXQoaWQpKVxuICAgICAgLmZpbHRlcigoc2VxKTogc2VxIGlzIEJyb3dzZVNlcXVlbmNlTWV0YWRhdGEgPT4gc2VxICE9PSB1bmRlZmluZWQpO1xuXG4gICAgcmV0dXJuIHRoaXMuc29ydEJ5UmVsZXZhbmNlKHJlc3VsdHMsIHF1ZXJ5KTtcbiAgfVxuXG4gIGFzeW5jIHJlZnJlc2hJbmRleCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLnNlcXVlbmNlSW5kZXggPSBudWxsO1xuICAgIHRoaXMuc2VhcmNoSW5kZXggPSBudWxsO1xuICAgIHRoaXMuc2VxdWVuY2VNYXAuY2xlYXIoKTtcbiAgICBhd2FpdCB0aGlzLmxvYWRTZXF1ZW5jZUluZGV4KCk7XG4gIH1cblxuICAvLyBBZGRpdGlvbmFsIHV0aWxpdHkgbWV0aG9kc1xuICBnZXRJbmRleFN0YXRzKCk6IHtcbiAgICB0b3RhbFNlcXVlbmNlczogbnVtYmVyO1xuICAgIGluZGV4ZWRXb3JkczogbnVtYmVyO1xuICAgIGluZGV4ZWRBdXRob3JzOiBudW1iZXI7XG4gICAgaW5kZXhlZFRhZ3M6IG51bWJlcjtcbiAgICBpbmRleGVkTWV0YWRhdGE6IG51bWJlcjtcbiAgfSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsU2VxdWVuY2VzOiB0aGlzLnNlcXVlbmNlTWFwLnNpemUsXG4gICAgICBpbmRleGVkV29yZHM6IHRoaXMuc2VhcmNoSW5kZXg/LndvcmRJbmRleC5zaXplIHx8IDAsXG4gICAgICBpbmRleGVkQXV0aG9yczogdGhpcy5zZWFyY2hJbmRleD8uYXV0aG9ySW5kZXguc2l6ZSB8fCAwLFxuICAgICAgaW5kZXhlZFRhZ3M6IHRoaXMuc2VhcmNoSW5kZXg/LnRhZ0luZGV4LnNpemUgfHwgMCxcbiAgICAgIGluZGV4ZWRNZXRhZGF0YTogdGhpcy5zZWFyY2hJbmRleD8ubWV0YWRhdGFJbmRleC5zaXplIHx8IDAsXG4gICAgfTtcbiAgfVxuXG4gIGFzeW5jIGdldFNlcXVlbmNlQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxCcm93c2VTZXF1ZW5jZU1ldGFkYXRhIHwgbnVsbD4ge1xuICAgIGlmICghdGhpcy5zZXF1ZW5jZU1hcC5oYXMoaWQpKSB7XG4gICAgICBhd2FpdCB0aGlzLmxvYWRTZXF1ZW5jZUluZGV4KCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnNlcXVlbmNlTWFwLmdldChpZCkgfHwgbnVsbDtcbiAgfVxuXG4gIGFzeW5jIGdldFN1Z2dlc3Rpb25zKFxuICAgIHBhcnRpYWxRdWVyeTogc3RyaW5nLFxuICAgIG1heFN1Z2dlc3Rpb25zID0gMTBcbiAgKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgIGlmICghdGhpcy5zZWFyY2hJbmRleCB8fCBwYXJ0aWFsUXVlcnkubGVuZ3RoIDwgMikge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgY29uc3QgcXVlcnkgPSBwYXJ0aWFsUXVlcnkudG9Mb3dlckNhc2UoKTtcblxuICAgIC8vIFNlYXJjaCBpbiB3b3Jkcy9uYW1lc1xuICAgIGZvciAoY29uc3QgW3dvcmRdIG9mIHRoaXMuc2VhcmNoSW5kZXgud29yZEluZGV4KSB7XG4gICAgICBpZiAod29yZC5pbmNsdWRlcyhxdWVyeSkpIHtcbiAgICAgICAgc3VnZ2VzdGlvbnMuYWRkKHdvcmQpO1xuICAgICAgICBpZiAoc3VnZ2VzdGlvbnMuc2l6ZSA+PSBtYXhTdWdnZXN0aW9ucykgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gU2VhcmNoIGluIGF1dGhvcnMgaWYgbm90IGVub3VnaCBzdWdnZXN0aW9uc1xuICAgIGlmIChzdWdnZXN0aW9ucy5zaXplIDwgbWF4U3VnZ2VzdGlvbnMpIHtcbiAgICAgIGZvciAoY29uc3QgW2F1dGhvcl0gb2YgdGhpcy5zZWFyY2hJbmRleC5hdXRob3JJbmRleCkge1xuICAgICAgICBpZiAoYXV0aG9yLmluY2x1ZGVzKHF1ZXJ5KSkge1xuICAgICAgICAgIHN1Z2dlc3Rpb25zLmFkZChhdXRob3IpO1xuICAgICAgICAgIGlmIChzdWdnZXN0aW9ucy5zaXplID49IG1heFN1Z2dlc3Rpb25zKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBBcnJheS5mcm9tKHN1Z2dlc3Rpb25zKS5zbGljZSgwLCBtYXhTdWdnZXN0aW9ucyk7XG4gIH1cblxuICAvLyBQcml2YXRlIGhlbHBlciBtZXRob2RzXG4gIHByaXZhdGUgYWRkVG9JbmRleChcbiAgICBpbmRleDogTWFwPHN0cmluZywgU2V0PHN0cmluZz4+LFxuICAgIGtleTogc3RyaW5nLFxuICAgIHNlcXVlbmNlSWQ6IHN0cmluZ1xuICApOiB2b2lkIHtcbiAgICBpZiAoIWluZGV4LmhhcyhrZXkpKSB7XG4gICAgICBpbmRleC5zZXQoa2V5LCBuZXcgU2V0KCkpO1xuICAgIH1cbiAgICBjb25zdCBrZXlTZXQgPSBpbmRleC5nZXQoa2V5KTtcbiAgICBpZiAoa2V5U2V0KSB7XG4gICAgICBrZXlTZXQuYWRkKHNlcXVlbmNlSWQpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2VhcmNoVGVybSh0ZXJtOiBzdHJpbmcpOiBTZXQ8c3RyaW5nPiB7XG4gICAgY29uc3QgcmVzdWx0cyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuXG4gICAgaWYgKCF0aGlzLnNlYXJjaEluZGV4KSByZXR1cm4gcmVzdWx0cztcblxuICAgIC8vIEV4YWN0IG1hdGNoZXMgaW4gd29yZHNcbiAgICBjb25zdCB3b3JkTWF0Y2hlcyA9IHRoaXMuc2VhcmNoSW5kZXgud29yZEluZGV4LmdldCh0ZXJtKSB8fCBuZXcgU2V0KCk7XG4gICAgd29yZE1hdGNoZXMuZm9yRWFjaCgoaWQpID0+IHJlc3VsdHMuYWRkKGlkKSk7XG5cbiAgICAvLyBQYXJ0aWFsIG1hdGNoZXMgaW4gd29yZHNcbiAgICBmb3IgKGNvbnN0IFt3b3JkLCBpZHNdIG9mIHRoaXMuc2VhcmNoSW5kZXgud29yZEluZGV4KSB7XG4gICAgICBpZiAod29yZC5pbmNsdWRlcyh0ZXJtKSkge1xuICAgICAgICBpZHMuZm9yRWFjaCgoaWQpID0+IHJlc3VsdHMuYWRkKGlkKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQXV0aG9yIG1hdGNoZXNcbiAgICBjb25zdCBhdXRob3JNYXRjaGVzID0gdGhpcy5zZWFyY2hJbmRleC5hdXRob3JJbmRleC5nZXQodGVybSkgfHwgbmV3IFNldCgpO1xuICAgIGF1dGhvck1hdGNoZXMuZm9yRWFjaCgoaWQpID0+IHJlc3VsdHMuYWRkKGlkKSk7XG5cbiAgICAvLyBUYWcgbWF0Y2hlc1xuICAgIGNvbnN0IHRhZ01hdGNoZXMgPSB0aGlzLnNlYXJjaEluZGV4LnRhZ0luZGV4LmdldCh0ZXJtKSB8fCBuZXcgU2V0KCk7XG4gICAgdGFnTWF0Y2hlcy5mb3JFYWNoKChpZCkgPT4gcmVzdWx0cy5hZGQoaWQpKTtcblxuICAgIC8vIE1ldGFkYXRhIG1hdGNoZXNcbiAgICBjb25zdCBtZXRhZGF0YU1hdGNoZXMgPVxuICAgICAgdGhpcy5zZWFyY2hJbmRleC5tZXRhZGF0YUluZGV4LmdldCh0ZXJtKSB8fCBuZXcgU2V0KCk7XG4gICAgbWV0YWRhdGFNYXRjaGVzLmZvckVhY2goKGlkKSA9PiByZXN1bHRzLmFkZChpZCkpO1xuXG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cblxuICBwcml2YXRlIGJ1aWxkU2VhcmNoYWJsZVRleHQoc2VxdWVuY2U6IEJyb3dzZVNlcXVlbmNlTWV0YWRhdGEpOiBzdHJpbmcge1xuICAgIGNvbnN0IHBhcnRzID0gW1xuICAgICAgc2VxdWVuY2Uud29yZCxcbiAgICAgIHNlcXVlbmNlLm5hbWUsXG4gICAgICBzZXF1ZW5jZS5hdXRob3IgfHwgXCJcIixcbiAgICAgIHNlcXVlbmNlLmRpZmZpY3VsdHlMZXZlbCB8fCBcIlwiLFxuICAgICAgc2VxdWVuY2UuZ3JpZE1vZGUgfHwgXCJcIixcbiAgICAgIHNlcXVlbmNlLnByb3BUeXBlIHx8IFwiXCIsXG4gICAgICAuLi5zZXF1ZW5jZS50YWdzLFxuICAgIF07XG5cbiAgICByZXR1cm4gcGFydHMuZmlsdGVyKEJvb2xlYW4pLmpvaW4oXCIgXCIpO1xuICB9XG5cbiAgcHJpdmF0ZSBzb3J0QnlSZWxldmFuY2UoXG4gICAgc2VxdWVuY2VzOiBCcm93c2VTZXF1ZW5jZU1ldGFkYXRhW10sXG4gICAgcXVlcnk6IHN0cmluZ1xuICApOiBCcm93c2VTZXF1ZW5jZU1ldGFkYXRhW10ge1xuICAgIGNvbnN0IHF1ZXJ5TG93ZXIgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xuXG4gICAgcmV0dXJuIHNlcXVlbmNlcy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICBjb25zdCBzY29yZUEgPSB0aGlzLmNhbGN1bGF0ZVJlbGV2YW5jZVNjb3JlKGEsIHF1ZXJ5TG93ZXIpO1xuICAgICAgY29uc3Qgc2NvcmVCID0gdGhpcy5jYWxjdWxhdGVSZWxldmFuY2VTY29yZShiLCBxdWVyeUxvd2VyKTtcbiAgICAgIHJldHVybiBzY29yZUIgLSBzY29yZUE7IC8vIEhpZ2hlciBzY29yZSBmaXJzdFxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBjYWxjdWxhdGVSZWxldmFuY2VTY29yZShcbiAgICBzZXF1ZW5jZTogQnJvd3NlU2VxdWVuY2VNZXRhZGF0YSxcbiAgICBxdWVyeTogc3RyaW5nXG4gICk6IG51bWJlciB7XG4gICAgbGV0IHNjb3JlID0gMDtcblxuICAgIC8vIEV4YWN0IHdvcmQgbWF0Y2ggZ2V0cyBoaWdoZXN0IHNjb3JlXG4gICAgaWYgKHNlcXVlbmNlLndvcmQudG9Mb3dlckNhc2UoKSA9PT0gcXVlcnkpIHtcbiAgICAgIHNjb3JlICs9IDEwMDtcbiAgICB9XG5cbiAgICAvLyBXb3JkIHN0YXJ0cyB3aXRoIHF1ZXJ5XG4gICAgaWYgKHNlcXVlbmNlLndvcmQudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKHF1ZXJ5KSkge1xuICAgICAgc2NvcmUgKz0gNTA7XG4gICAgfVxuXG4gICAgLy8gV29yZCBjb250YWlucyBxdWVyeVxuICAgIGlmIChzZXF1ZW5jZS53b3JkLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnkpKSB7XG4gICAgICBzY29yZSArPSAyNTtcbiAgICB9XG5cbiAgICAvLyBOYW1lIG1hdGNoZXNcbiAgICBpZiAoc2VxdWVuY2UubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5KSkge1xuICAgICAgc2NvcmUgKz0gMTU7XG4gICAgfVxuXG4gICAgLy8gQXV0aG9yIG1hdGNoZXNcbiAgICBpZiAoc2VxdWVuY2UuYXV0aG9yPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5KSkge1xuICAgICAgc2NvcmUgKz0gMTA7XG4gICAgfVxuXG4gICAgLy8gVGFnIG1hdGNoZXNcbiAgICBmb3IgKGNvbnN0IHRhZyBvZiBzZXF1ZW5jZS50YWdzKSB7XG4gICAgICBpZiAodGFnLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnkpKSB7XG4gICAgICAgIHNjb3JlICs9IDU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRmF2b3JpdGVzIGdldCBib251cyBwb2ludHNcbiAgICBpZiAoc2VxdWVuY2UuaXNGYXZvcml0ZSkge1xuICAgICAgc2NvcmUgKz0gMjtcbiAgICB9XG5cbiAgICByZXR1cm4gc2NvcmU7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHNjYW5TZXF1ZW5jZURpcmVjdG9yeSgpOiBQcm9taXNlPEJyb3dzZVNlcXVlbmNlTWV0YWRhdGFbXT4ge1xuICAgIC8vIFRoaXMgaXMgYSBmYWxsYmFjayBtZXRob2QgdGhhdCB3b3VsZCBzY2FuIHRoZSBzdGF0aWMgZGlyZWN0b3J5XG4gICAgLy8gSW4gYSByZWFsIGltcGxlbWVudGF0aW9uLCB0aGlzIHdvdWxkIHJlcXVpcmUgc2VydmVyLXNpZGUgc3VwcG9ydFxuICAgIC8vIEZvciBub3csIHJldHVybiBhIGNvbXByZWhlbnNpdmUgc2V0IG9mIHNhbXBsZSBkYXRhIGJhc2VkIG9uIHRoZSBjb3BpZWQgZmlsZXNcblxuICAgIGNvbnNvbGUud2FybihcIlNjYW5uaW5nIGRpcmVjdG9yeSAtIHVzaW5nIGZhbGxiYWNrIHNhbXBsZSBkYXRhXCIpO1xuXG4gICAgLy8gR2VuZXJhdGUgc2VxdWVuY2VzIGJhc2VkIG9uIGNvbW1vbiBwYXR0ZXJuIGZyb20gdGhlIGNvcGllZCBkaWN0aW9uYXJ5XG4gICAgY29uc3Qgc2VxdWVuY2VzOiBCcm93c2VTZXF1ZW5jZU1ldGFkYXRhW10gPSBbXTtcblxuICAgIC8vIFNhbXBsZSBzZXF1ZW5jZXMgdGhhdCBzaG91bGQgZXhpc3QgYmFzZWQgb24gdGhlIGRpY3Rpb25hcnkgY29weVxuICAgIGNvbnN0IGtub3duU2VxdWVuY2VzID0gW1xuICAgICAgXCJBXCIsXG4gICAgICBcIkFBQkJcIixcbiAgICAgIFwiQUFLRVwiLFxuICAgICAgXCJBQlwiLFxuICAgICAgXCJBQkNcIixcbiAgICAgIFwiQUpFzqYtXCIsXG4gICAgICBcIkFLRVwiLFxuICAgICAgXCJBS0nOplwiLFxuICAgICAgXCJBTEZBTEdHRlwiLFxuICAgICAgXCJCXCIsXG4gICAgICBcIkJBXCIsXG4gICAgICBcIkJCS0VcIixcbiAgICAgIFwiQkJMRlwiLFxuICAgICAgXCJCQ1wiLFxuICAgICAgXCJCSkVBXCIsXG4gICAgICBcIkJKRkFcIixcbiAgICAgIFwiQktFzqYtXCIsXG4gICAgICBcIkNcIixcbiAgICAgIFwiQ0FLRVwiLFxuICAgICAgXCJDQ0POpi1cIixcbiAgICAgIFwiQ0NLRVwiLFxuICAgICAgXCJDQ0vOplwiLFxuICAgICAgLy8gQWRkIG1vcmUgYXMgbmVlZGVkLi4uXG4gICAgXTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwga25vd25TZXF1ZW5jZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHdvcmQgPSBrbm93blNlcXVlbmNlc1tpXTtcbiAgICAgIGlmICghd29yZCkgY29udGludWU7IC8vIFNraXAgdW5kZWZpbmVkIGVudHJpZXNcblxuICAgICAgY29uc3QgYXV0aG9ycyA9IFtcIlRLQSBVc2VyXCIsIFwiRGVtbyBBdXRob3JcIiwgXCJFeHBlcnQgVXNlclwiXTtcbiAgICAgIGNvbnN0IGdyaWRNb2RlcyA9IFtcImRpYW1vbmRcIiwgXCJib3hcIl07XG4gICAgICBjb25zdCBkaWZmaWN1bHRpZXMgPSBbXCJiZWdpbm5lclwiLCBcImludGVybWVkaWF0ZVwiLCBcImFkdmFuY2VkXCJdO1xuXG4gICAgICBjb25zdCBhdXRob3IgPSBhdXRob3JzW2kgJSBhdXRob3JzLmxlbmd0aF07XG4gICAgICBjb25zdCBncmlkTW9kZSA9IGdyaWRNb2Rlc1tpICUgZ3JpZE1vZGVzLmxlbmd0aF07XG4gICAgICBjb25zdCBkaWZmaWN1bHR5ID0gZGlmZmljdWx0aWVzW2kgJSBkaWZmaWN1bHRpZXMubGVuZ3RoXTtcblxuICAgICAgY29uc3QgcmVzdWx0OiBCcm93c2VTZXF1ZW5jZU1ldGFkYXRhID0ge1xuICAgICAgICBpZDogd29yZCwgLy8g4pyFIEZJWEVEOiBLZWVwIHVwcGVyY2FzZSB0byBtYXRjaCBQTkcgZmlsZSBuYW1lc1xuICAgICAgICBuYW1lOiBgJHt3b3JkfSBTZXF1ZW5jZWAsXG4gICAgICAgIHdvcmQsXG4gICAgICAgIHRodW1ibmFpbHM6IFtgJHt3b3JkfV92ZXIxLnBuZ2BdLFxuICAgICAgICBpc0Zhdm9yaXRlOiBNYXRoLnJhbmRvbSgpID4gMC44LFxuICAgICAgICBpc0NpcmN1bGFyOiBmYWxzZSxcbiAgICAgICAgdGFnczogW1wiZmxvd1wiLCBcInByYWN0aWNlXCIsIFwiZ2VuZXJhdGVkXCJdLnNsaWNlKFxuICAgICAgICAgIDAsXG4gICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMykgKyAxXG4gICAgICAgICksXG4gICAgICAgIG1ldGFkYXRhOiB7IHNjYW5uZWQ6IHRydWUsIGluZGV4OiBpIH0sXG4gICAgICB9O1xuXG4gICAgICAvLyBBZGQgb3B0aW9uYWwgcHJvcGVydGllcyBjb25kaXRpb25hbGx5XG4gICAgICBpZiAoYXV0aG9yKSByZXN1bHQuYXV0aG9yID0gYXV0aG9yO1xuICAgICAgaWYgKGdyaWRNb2RlKSByZXN1bHQuZ3JpZE1vZGUgPSBncmlkTW9kZTtcbiAgICAgIGlmIChkaWZmaWN1bHR5KSByZXN1bHQuZGlmZmljdWx0eUxldmVsID0gZGlmZmljdWx0eTtcblxuICAgICAgcmVzdWx0LnNlcXVlbmNlTGVuZ3RoID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCkgKyAzO1xuICAgICAgcmVzdWx0LmxldmVsID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNCkgKyAxO1xuICAgICAgcmVzdWx0LmRhdGVBZGRlZCA9IG5ldyBEYXRlKFxuICAgICAgICBEYXRlLm5vdygpIC0gTWF0aC5yYW5kb20oKSAqIDM2NSAqIDI0ICogNjAgKiA2MCAqIDEwMDBcbiAgICAgICk7XG4gICAgICByZXN1bHQucHJvcFR5cGUgPSBcImZhbnNcIjtcbiAgICAgIHJlc3VsdC5zdGFydGluZ1Bvc2l0aW9uID0gXCJjZW50ZXJcIjtcblxuICAgICAgc2VxdWVuY2VzLnB1c2gocmVzdWx0KTtcbiAgICB9XG5cbiAgICByZXR1cm4gc2VxdWVuY2VzO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiJBQWlCTyxhQUFNLHFCQUFzRDtBQUFBLEVBQ3pELGdCQUFpRDtBQUFBLEVBQ2pELGNBQWtDO0FBQUEsRUFDbEMsY0FBYyxvQkFBSSxJQUFvQztBQUFBLEVBRTlELE1BQU0sb0JBQXVEO0FBQzNELFFBQUksS0FBSyxrQkFBa0IsTUFBTTtBQUMvQixhQUFPLEtBQUs7QUFBQSxJQUNkO0FBRUEsUUFBSTtBQUVGLFVBQUksS0FBSyxrQkFBa0IsTUFBTTtBQUMvQixhQUFLLGdCQUFnQixNQUFNLEtBQUssc0JBQXNCO0FBQUEsTUFDeEQ7QUFHQSxVQUFJLEtBQUssZUFBZTtBQUN0QixjQUFNLEtBQUssaUJBQWlCLEtBQUssYUFBYTtBQUFBLE1BQ2hEO0FBRUEsYUFBTyxLQUFLLGlCQUFpQixDQUFDO0FBQUEsSUFDaEMsU0FBUyxPQUFPO0FBQ2QsY0FBUSxNQUFNLGtDQUFrQyxLQUFLO0FBRXJELFdBQUssZ0JBQWdCLENBQUM7QUFDdEIsYUFBTyxDQUFDO0FBQUEsSUFDVjtBQUFBLEVBQ0Y7QUFBQSxFQUVBLE1BQU0saUJBQWlCLFdBQW9EO0FBQ3pFLFNBQUssY0FBYztBQUFBLE1BQ2pCLFdBQVcsb0JBQUksSUFBSTtBQUFBLE1BQ25CLGFBQWEsb0JBQUksSUFBSTtBQUFBLE1BQ3JCLFVBQVUsb0JBQUksSUFBSTtBQUFBLE1BQ2xCLGVBQWUsb0JBQUksSUFBSTtBQUFBLElBQ3pCO0FBRUEsU0FBSyxZQUFZLE1BQU07QUFFdkIsZUFBVyxZQUFZLFdBQVc7QUFDaEMsV0FBSyxZQUFZLElBQUksU0FBUyxJQUFJLFFBQVE7QUFHMUMsV0FBSztBQUFBLFFBQ0gsS0FBSyxZQUFZO0FBQUEsUUFDakIsU0FBUyxLQUFLLFlBQVk7QUFBQSxRQUMxQixTQUFT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