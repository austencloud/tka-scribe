export class NavigationService {
  async generateNavigationSections(sequences, favorites) {
    const sections = [
      await this.generateFavoritesSection(sequences, favorites),
      await this.generateDateSection(sequences),
      await this.generateLengthSection(sequences),
      await this.generateLetterSection(sequences),
      await this.generateLevelSection(sequences),
      await this.generateAuthorSection(sequences)
    ];
    return sections;
  }
  toggleSectionExpansion(sectionId, sections) {
    return sections.map((section) => ({
      ...section,
      isExpanded: section.id === sectionId ? !section.isExpanded : section.isExpanded
    }));
  }
  setActiveItem(sectionId, itemId, sections) {
    return sections.map((section) => ({
      ...section,
      items: section.items.map((item) => ({
        ...item,
        isActive: section.id === sectionId && item.id === itemId
      }))
    }));
  }
  clearActiveStates(sections) {
    return sections.map((section) => ({
      ...section,
      items: section.items.map((item) => ({
        ...item,
        isActive: false
      }))
    }));
  }
  getSequencesForNavigationItem(item, sectionType, allSequences) {
    switch (sectionType) {
      case "length": {
        const length = parseInt(item.value);
        return allSequences.filter((seq) => seq.sequenceLength === length);
      }
      case "letter":
        return allSequences.filter(
          (seq) => seq.word.startsWith(item.value)
        );
      case "level":
        return allSequences.filter((seq) => seq.difficultyLevel === item.value);
      case "author":
        return allSequences.filter((seq) => seq.author === item.value);
      case "date":
        return allSequences.filter((seq) => {
          if (!seq.dateAdded) return false;
          const itemDate = new Date(item.value);
          const seqDate = new Date(seq.dateAdded);
          return seqDate.toDateString() === itemDate.toDateString();
        });
      case "favorites":
        return allSequences;
      default:
        return allSequences;
    }
  }
  updateSectionCounts(sections, sequences, favorites) {
    return sections.map((section) => ({
      ...section,
      totalCount: this.calculateSectionCount(section, sequences, favorites),
      items: section.items.map((item) => ({
        ...item,
        count: this.getSequencesForNavigationItem(item, section.type, sequences).length
      }))
    }));
  }
  // Private helper methods
  async generateFavoritesSection(sequences, favorites) {
    const favoriteSequences = sequences.filter(
      (seq) => favorites.includes(seq.id)
    );
    return {
      id: "favorites",
      title: "â­ Favorites",
      type: "favorites",
      items: [
        {
          id: "all-favorites",
          label: "All Favorites",
          value: "favorites",
          count: favoriteSequences.length,
          isActive: false,
          sequences: favoriteSequences
        }
      ],
      isExpanded: false,
      totalCount: favoriteSequences.length
    };
  }
  async generateDateSection(sequences) {
    const dateGroups = /* @__PURE__ */ new Map();
    sequences.forEach((seq) => {
      if (seq.dateAdded) {
        const date = new Date(seq.dateAdded);
        const dateKey = date.toDateString();
        if (!dateGroups.has(dateKey)) {
          dateGroups.set(dateKey, []);
        }
        const group = dateGroups.get(dateKey);
        if (group) {
          group.push(seq);
        }
      }
    });
    const items = Array.from(dateGroups.entries()).sort(([a], [b]) => new Date(b).getTime() - new Date(a).getTime()).slice(0, 10).map(([date, seqs]) => ({
      id: `date-${date}`,
      label: this.formatDateLabel(new Date(date)),
      value: date,
      count: seqs.length,
      isActive: false,
      sequences: seqs
    }));
    return {
      id: "date",
      title: "ðŸ“… Recently Added",
      type: "date",
      items,
      isExpanded: false,
      totalCount: sequences.filter((seq) => seq.dateAdded).length
    };
  }
  async generateLengthSection(sequences) {
    const lengthGroups = /* @__PURE__ */ new Map();
    sequences.forEach((seq) => {
      const length = seq.sequenceLength || seq.word.length;
      if (!lengthGroups.has(length)) {
        lengthGroups.set(length, []);
      }
      const group = lengthGroups.get(length);
      if (group) {
        group.push(seq);
      }
    });
    const items = Array.from(lengthGroups.entries()).sort(([a], [b]) => a - b).map(([length, seqs]) => ({
      id: `length-${length}`,
      label: `${length} beats`,
      value: length,
      count: seqs.length,
      isActive: false,
      sequences: seqs
    }));
    return {
      id: "length",
      title: "ðŸ“ Length",
      type: "length",
      items,
      isExpanded: false,
      totalCount: sequences.length
    };
  }
  async generateLetterSection(sequences) {
    const letterGroups = /* @__PURE__ */ new Map();
    sequences.forEach((seq) => {
      const firstLetter = seq.word.charAt(0).toUpperCase();
      if (!letterGroups.has(firstLetter)) {
        letterGroups.set(firstLetter, []);
      }
      const group = letterGroups.get(firstLetter);
      if (group) {
        group.push(seq);
      }
    });
    const items = Array.from(letterGroups.entries()).sort(([a], [b]) => a.localeCompare(b)).map(([letter, seqs]) => ({
      id: `letter-${letter}`,
      label: letter,
      value: letter,
      count: seqs.length,
      isActive: false,
      sequences: seqs
    }));
    return {
      id: "letter",
      title: "ðŸ”¤ Starting Letter",
      type: "letter",
      items,
      isExpanded: true,
      // Default expanded like desktop
      totalCount: sequences.length
    };
  }
  async generateLevelSection(sequences) {
    const levelGroups = /* @__PURE__ */ new Map();
    sequences.forEach((seq) => {
      const level = seq.difficultyLevel || "unknown";
      if (!levelGroups.has(level)) {
        levelGroups.set(level, []);
      }
      const group = levelGroups.get(level);
      if (group) {
        group.push(seq);
      }
    });
    const levelOrder = ["beginner", "intermediate", "advanced", "unknown"];
    const items = levelOrder.filter((level) => levelGroups.has(level)).map((level) => ({
      id: `level-${level}`,
      label: level.charAt(0).toUpperCase() + level.slice(1),
      value: level,
      count: levelGroups.get(level)?.length || 0,
      isActive: false,
      sequences: levelGroups.get(level) ?? []
    }));
    return {
      id: "level",
      title: "ðŸ“Š Difficulty",
      type: "level",
      items,
      isExpanded: false,
      totalCount: sequences.length
    };
  }
  async generateAuthorSection(sequences) {
    const authorGroups = /* @__PURE__ */ new Map();
    sequences.forEach((seq) => {
      const author = seq.author || "Unknown";
      if (!authorGroups.has(author)) {
        authorGroups.set(author, []);
      }
      const group = authorGroups.get(author);
      if (group) {
        group.push(seq);
      }
    });
    const items = Array.from(authorGroups.entries()).sort(([a], [b]) => a.localeCompare(b)).map(([author, seqs]) => ({
      id: `author-${author}`,
      label: author,
      value: author,
      count: seqs.length,
      isActive: false,
      sequences: seqs
    }));
    return {
      id: "author",
      title: "ðŸ‘¤ Author",
      type: "author",
      items,
      isExpanded: false,
      totalCount: sequences.length
    };
  }
  calculateSectionCount(section, sequences, favorites) {
    switch (section.type) {
      case "favorites":
        return sequences.filter((seq) => favorites.includes(seq.id)).length;
      default:
        return sequences.length;
    }
  }
  formatDateLabel(date) {
    const now = /* @__PURE__ */ new Date();
    const diffTime = now.getTime() - date.getTime();
    const diffDays = Math.floor(diffTime / (1e3 * 60 * 60 * 24));
    if (diffDays === 0) return "Today";
    if (diffDays === 1) return "Yesterday";
    if (diffDays < 7) return `${diffDays} days ago`;
    if (diffDays < 30) return `${Math.floor(diffDays / 7)} weeks ago`;
    return date.toLocaleDateString();
  }
  // Additional methods required by browse-interfaces.ts
  async buildNavigationStructure(sequences) {
    return this.generateNavigationSections(sequences, []);
  }
  async getNavigationItem(_sectionId, _itemId) {
    return null;
  }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk5hdmlnYXRpb25TZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTmF2aWdhdGlvbiBTZXJ2aWNlIC0gTWFuYWdlcyBicm93c2UgdGFiIG5hdmlnYXRpb25cbiAqXG4gKiBIYW5kbGVzIHNpZGViYXIgbmF2aWdhdGlvbiBzZWN0aW9ucywgb3JnYW5pemF0aW9uLCBhbmQgc3RhdGUgbWFuYWdlbWVudFxuICogZm9sbG93aW5nIHRoZSBtaWNyb3NlcnZpY2VzIGFyY2hpdGVjdHVyZSBwYXR0ZXJuLlxuICovXG5cbmltcG9ydCB0eXBlIHsgQnJvd3NlU2VxdWVuY2VNZXRhZGF0YSB9IGZyb20gXCIuLi8uLi9pbnRlcmZhY2VzL2RvbWFpbi10eXBlc1wiO1xuXG5leHBvcnQgaW50ZXJmYWNlIE5hdmlnYXRpb25TZWN0aW9uIHtcbiAgaWQ6IHN0cmluZztcbiAgdGl0bGU6IHN0cmluZztcbiAgdHlwZTogXCJkYXRlXCIgfCBcImxlbmd0aFwiIHwgXCJsZXR0ZXJcIiB8IFwibGV2ZWxcIiB8IFwiYXV0aG9yXCIgfCBcImZhdm9yaXRlc1wiO1xuICBpdGVtczogTmF2aWdhdGlvbkl0ZW1bXTtcbiAgaXNFeHBhbmRlZDogYm9vbGVhbjtcbiAgdG90YWxDb3VudDogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE5hdmlnYXRpb25JdGVtIHtcbiAgaWQ6IHN0cmluZztcbiAgbGFiZWw6IHN0cmluZztcbiAgdmFsdWU6IHN0cmluZyB8IG51bWJlcjtcbiAgY291bnQ6IG51bWJlcjtcbiAgaXNBY3RpdmU6IGJvb2xlYW47XG4gIHNlcXVlbmNlczogQnJvd3NlU2VxdWVuY2VNZXRhZGF0YVtdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElOYXZpZ2F0aW9uU2VydmljZSB7XG4gIC8qKiBHZW5lcmF0ZSBuYXZpZ2F0aW9uIHNlY3Rpb25zIGZyb20gc2VxdWVuY2VzICovXG4gIGdlbmVyYXRlTmF2aWdhdGlvblNlY3Rpb25zKFxuICAgIHNlcXVlbmNlczogQnJvd3NlU2VxdWVuY2VNZXRhZGF0YVtdLFxuICAgIGZhdm9yaXRlczogc3RyaW5nW11cbiAgKTogUHJvbWlzZTxOYXZpZ2F0aW9uU2VjdGlvbltdPjtcblxuICAvKiogVG9nZ2xlIHNlY3Rpb24gZXhwYW5zaW9uIHN0YXRlICovXG4gIHRvZ2dsZVNlY3Rpb25FeHBhbnNpb24oXG4gICAgc2VjdGlvbklkOiBzdHJpbmcsXG4gICAgc2VjdGlvbnM6IE5hdmlnYXRpb25TZWN0aW9uW11cbiAgKTogTmF2aWdhdGlvblNlY3Rpb25bXTtcblxuICAvKiogU2V0IGFjdGl2ZSBuYXZpZ2F0aW9uIGl0ZW0gKi9cbiAgc2V0QWN0aXZlSXRlbShcbiAgICBzZWN0aW9uSWQ6IHN0cmluZyxcbiAgICBpdGVtSWQ6IHN0cmluZyxcbiAgICBzZWN0aW9uczogTmF2aWdhdGlvblNlY3Rpb25bXVxuICApOiBOYXZpZ2F0aW9uU2VjdGlvbltdO1xuXG4gIC8qKiBDbGVhciBhbGwgYWN0aXZlIHN0YXRlcyAqL1xuICBjbGVhckFjdGl2ZVN0YXRlcyhzZWN0aW9uczogTmF2aWdhdGlvblNlY3Rpb25bXSk6IE5hdmlnYXRpb25TZWN0aW9uW107XG5cbiAgLyoqIEdldCBzZXF1ZW5jZXMgZm9yIG5hdmlnYXRpb24gaXRlbSAqL1xuICBnZXRTZXF1ZW5jZXNGb3JOYXZpZ2F0aW9uSXRlbShcbiAgICBpdGVtOiBOYXZpZ2F0aW9uSXRlbSxcbiAgICBzZWN0aW9uVHlwZTogTmF2aWdhdGlvblNlY3Rpb25bXCJ0eXBlXCJdLFxuICAgIGFsbFNlcXVlbmNlczogQnJvd3NlU2VxdWVuY2VNZXRhZGF0YVtdXG4gICk6IEJyb3dzZVNlcXVlbmNlTWV0YWRhdGFbXTtcblxuICAvKiogVXBkYXRlIHNlY3Rpb24gY291bnRzIGJhc2VkIG9uIGN1cnJlbnQgc2VxdWVuY2VzICovXG4gIHVwZGF0ZVNlY3Rpb25Db3VudHMoXG4gICAgc2VjdGlvbnM6IE5hdmlnYXRpb25TZWN0aW9uW10sXG4gICAgc2VxdWVuY2VzOiBCcm93c2VTZXF1ZW5jZU1ldGFkYXRhW10sXG4gICAgZmF2b3JpdGVzOiBzdHJpbmdbXVxuICApOiBOYXZpZ2F0aW9uU2VjdGlvbltdO1xufVxuXG5leHBvcnQgY2xhc3MgTmF2aWdhdGlvblNlcnZpY2UgaW1wbGVtZW50cyBJTmF2aWdhdGlvblNlcnZpY2Uge1xuICBhc3luYyBnZW5lcmF0ZU5hdmlnYXRpb25TZWN0aW9ucyhcbiAgICBzZXF1ZW5jZXM6IEJyb3dzZVNlcXVlbmNlTWV0YWRhdGFbXSxcbiAgICBmYXZvcml0ZXM6IHN0cmluZ1tdXG4gICk6IFByb21pc2U8TmF2aWdhdGlvblNlY3Rpb25bXT4ge1xuICAgIGNvbnN0IHNlY3Rpb25zOiBOYXZpZ2F0aW9uU2VjdGlvbltdID0gW1xuICAgICAgYXdhaXQgdGhpcy5nZW5lcmF0ZUZhdm9yaXRlc1NlY3Rpb24oc2VxdWVuY2VzLCBmYXZvcml0ZXMpLFxuICAgICAgYXdhaXQgdGhpcy5nZW5lcmF0ZURhdGVTZWN0aW9uKHNlcXVlbmNlcyksXG4gICAgICBhd2FpdCB0aGlzLmdlbmVyYXRlTGVuZ3RoU2VjdGlvbihzZXF1ZW5jZXMpLFxuICAgICAgYXdhaXQgdGhpcy5nZW5lcmF0ZUxldHRlclNlY3Rpb24oc2VxdWVuY2VzKSxcbiAgICAgIGF3YWl0IHRoaXMuZ2VuZXJhdGVMZXZlbFNlY3Rpb24oc2VxdWVuY2VzKSxcbiAgICAgIGF3YWl0IHRoaXMuZ2VuZXJhdGVBdXRob3JTZWN0aW9uKHNlcXVlbmNlcyksXG4gICAgXTtcblxuICAgIHJldHVybiBzZWN0aW9ucztcbiAgfVxuXG4gIHRvZ2dsZVNlY3Rpb25FeHBhbnNpb24oXG4gICAgc2VjdGlvbklkOiBzdHJpbmcsXG4gICAgc2VjdGlvbnM6IE5hdmlnYXRpb25TZWN0aW9uW11cbiAgKTogTmF2aWdhdGlvblNlY3Rpb25bXSB7XG4gICAgcmV0dXJuIHNlY3Rpb25zLm1hcCgoc2VjdGlvbikgPT4gKHtcbiAgICAgIC4uLnNlY3Rpb24sXG4gICAgICBpc0V4cGFuZGVkOlxuICAgICAgICBzZWN0aW9uLmlkID09PSBzZWN0aW9uSWQgPyAhc2VjdGlvbi5pc0V4cGFuZGVkIDogc2VjdGlvbi5pc0V4cGFuZGVkLFxuICAgIH0pKTtcbiAgfVxuXG4gIHNldEFjdGl2ZUl0ZW0oXG4gICAgc2VjdGlvbklkOiBzdHJpbmcsXG4gICAgaXRlbUlkOiBzdHJpbmcsXG4gICAgc2VjdGlvbnM6IE5hdmlnYXRpb25TZWN0aW9uW11cbiAgKTogTmF2aWdhdGlvblNlY3Rpb25bXSB7XG4gICAgcmV0dXJuIHNlY3Rpb25zLm1hcCgoc2VjdGlvbikgPT4gKHtcbiAgICAgIC4uLnNlY3Rpb24sXG4gICAgICBpdGVtczogc2VjdGlvbi5pdGVtcy5tYXAoKGl0ZW0pID0+ICh7XG4gICAgICAgIC4uLml0ZW0sXG4gICAgICAgIGlzQWN0aXZlOiBzZWN0aW9uLmlkID09PSBzZWN0aW9uSWQgJiYgaXRlbS5pZCA9PT0gaXRlbUlkLFxuICAgICAgfSkpLFxuICAgIH0pKTtcbiAgfVxuXG4gIGNsZWFyQWN0aXZlU3RhdGVzKHNlY3Rpb25zOiBOYXZpZ2F0aW9uU2VjdGlvbltdKTogTmF2aWdhdGlvblNlY3Rpb25bXSB7XG4gICAgcmV0dXJuIHNlY3Rpb25zLm1hcCgoc2VjdGlvbikgPT4gKHtcbiAgICAgIC4uLnNlY3Rpb24sXG4gICAgICBpdGVtczogc2VjdGlvbi5pdGVtcy5tYXAoKGl0ZW0pID0+ICh7XG4gICAgICAgIC4uLml0ZW0sXG4gICAgICAgIGlzQWN0aXZlOiBmYWxzZSxcbiAgICAgIH0pKSxcbiAgICB9KSk7XG4gIH1cblxuICBnZXRTZXF1ZW5jZXNGb3JOYXZpZ2F0aW9uSXRlbShcbiAgICBpdGVtOiBOYXZpZ2F0aW9uSXRlbSxcbiAgICBzZWN0aW9uVHlwZTogTmF2aWdhdGlvblNlY3Rpb25bXCJ0eXBlXCJdLFxuICAgIGFsbFNlcXVlbmNlczogQnJvd3NlU2VxdWVuY2VNZXRhZGF0YVtdXG4gICk6IEJyb3dzZVNlcXVlbmNlTWV0YWRhdGFbXSB7XG4gICAgc3dpdGNoIChzZWN0aW9uVHlwZSkge1xuICAgICAgY2FzZSBcImxlbmd0aFwiOiB7XG4gICAgICAgIGNvbnN0IGxlbmd0aCA9IHBhcnNlSW50KGl0ZW0udmFsdWUgYXMgc3RyaW5nKTtcbiAgICAgICAgcmV0dXJuIGFsbFNlcXVlbmNlcy5maWx0ZXIoKHNlcSkgPT4gc2VxLnNlcXVlbmNlTGVuZ3RoID09PSBsZW5ndGgpO1xuICAgICAgfVxuXG4gICAgICBjYXNlIFwibGV0dGVyXCI6XG4gICAgICAgIHJldHVybiBhbGxTZXF1ZW5jZXMuZmlsdGVyKChzZXEpID0+XG4gICAgICAgICAgc2VxLndvcmQuc3RhcnRzV2l0aChpdGVtLnZhbHVlIGFzIHN0cmluZylcbiAgICAgICAgKTtcblxuICAgICAgY2FzZSBcImxldmVsXCI6XG4gICAgICAgIHJldHVybiBhbGxTZXF1ZW5jZXMuZmlsdGVyKChzZXEpID0+IHNlcS5kaWZmaWN1bHR5TGV2ZWwgPT09IGl0ZW0udmFsdWUpO1xuXG4gICAgICBjYXNlIFwiYXV0aG9yXCI6XG4gICAgICAgIHJldHVybiBhbGxTZXF1ZW5jZXMuZmlsdGVyKChzZXEpID0+IHNlcS5hdXRob3IgPT09IGl0ZW0udmFsdWUpO1xuXG4gICAgICBjYXNlIFwiZGF0ZVwiOlxuICAgICAgICAvLyBJbXBsZW1lbnRhdGlvbiBkZXBlbmRzIG9uIGRhdGUgZm9ybWF0XG4gICAgICAgIHJldHVybiBhbGxTZXF1ZW5jZXMuZmlsdGVyKChzZXEpID0+IHtcbiAgICAgICAgICBpZiAoIXNlcS5kYXRlQWRkZWQpIHJldHVybiBmYWxzZTtcbiAgICAgICAgICBjb25zdCBpdGVtRGF0ZSA9IG5ldyBEYXRlKGl0ZW0udmFsdWUgYXMgc3RyaW5nKTtcbiAgICAgICAgICBjb25zdCBzZXFEYXRlID0gbmV3IERhdGUoc2VxLmRhdGVBZGRlZCk7XG4gICAgICAgICAgcmV0dXJuIHNlcURhdGUudG9EYXRlU3RyaW5nKCkgPT09IGl0ZW1EYXRlLnRvRGF0ZVN0cmluZygpO1xuICAgICAgICB9KTtcblxuICAgICAgY2FzZSBcImZhdm9yaXRlc1wiOlxuICAgICAgICAvLyBXaWxsIGJlIGhhbmRsZWQgYnkgZmF2b3JpdGVzIGZpbHRlclxuICAgICAgICByZXR1cm4gYWxsU2VxdWVuY2VzO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gYWxsU2VxdWVuY2VzO1xuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZVNlY3Rpb25Db3VudHMoXG4gICAgc2VjdGlvbnM6IE5hdmlnYXRpb25TZWN0aW9uW10sXG4gICAgc2VxdWVuY2VzOiBCcm93c2VTZXF1ZW5jZU1ldGFkYXRhW10sXG4gICAgZmF2b3JpdGVzOiBzdHJpbmdbXVxuICApOiBOYXZpZ2F0aW9uU2VjdGlvbltdIHtcbiAgICByZXR1cm4gc2VjdGlvbnMubWFwKChzZWN0aW9uKSA9PiAoe1xuICAgICAgLi4uc2VjdGlvbixcbiAgICAgIHRvdGFsQ291bnQ6IHRoaXMuY2FsY3VsYXRlU2VjdGlvbkNvdW50KHNlY3Rpb24sIHNlcXVlbmNlcywgZmF2b3JpdGVzKSxcbiAgICAgIGl0ZW1zOiBzZWN0aW9uLml0ZW1zLm1hcCgoaXRlbSkgPT4gKHtcbiAgICAgICAgLi4uaXRlbSxcbiAgICAgICAgY291bnQ6IHRoaXMuZ2V0U2VxdWVuY2VzRm9yTmF2aWdhdGlvbkl0ZW0oaXRlbSwgc2VjdGlvbi50eXBlLCBzZXF1ZW5jZXMpXG4gICAgICAgICAgLmxlbmd0aCxcbiAgICAgIH0pKSxcbiAgICB9KSk7XG4gIH1cblxuICAvLyBQcml2YXRlIGhlbHBlciBtZXRob2RzXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVGYXZvcml0ZXNTZWN0aW9uKFxuICAgIHNlcXVlbmNlczogQnJvd3NlU2VxdWVuY2VNZXRhZGF0YVtdLFxuICAgIGZhdm9yaXRlczogc3RyaW5nW11cbiAgKTogUHJvbWlzZTxOYXZpZ2F0aW9uU2VjdGlvbj4ge1xuICAgIGNvbnN0IGZhdm9yaXRlU2VxdWVuY2VzID0gc2VxdWVuY2VzLmZpbHRlcigoc2VxKSA9PlxuICAgICAgZmF2b3JpdGVzLmluY2x1ZGVzKHNlcS5pZClcbiAgICApO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBcImZhdm9yaXRlc1wiLFxuICAgICAgdGl0bGU6IFwi4q2QIEZhdm9yaXRlc1wiLFxuICAgICAgdHlwZTogXCJmYXZvcml0ZXNcIixcbiAgICAgIGl0ZW1zOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogXCJhbGwtZmF2b3JpdGVzXCIsXG4gICAgICAgICAgbGFiZWw6IFwiQWxsIEZhdm9yaXRlc1wiLFxuICAgICAgICAgIHZhbHVlOiBcImZhdm9yaXRlc1wiLFxuICAgICAgICAgIGNvdW50OiBmYXZvcml0ZVNlcXVlbmNlcy5sZW5ndGgsXG4gICAgICAgICAgaXNBY3RpdmU6IGZhbHNlLFxuICAgICAgICAgIHNlcXVlbmNlczogZmF2b3JpdGVTZXF1ZW5jZXMsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgaXNFeHBhbmRlZDogZmFsc2UsXG4gICAgICB0b3RhbENvdW50OiBmYXZvcml0ZVNlcXVlbmNlcy5sZW5ndGgsXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVEYXRlU2VjdGlvbihcbiAgICBzZXF1ZW5jZXM6IEJyb3dzZVNlcXVlbmNlTWV0YWRhdGFbXVxuICApOiBQcm9taXNlPE5hdmlnYXRpb25TZWN0aW9uPiB7XG4gICAgY29uc3QgZGF0ZUdyb3VwcyA9IG5ldyBNYXA8c3RyaW5nLCBCcm93c2VTZXF1ZW5jZU1ldGFkYXRhW10+KCk7XG5cbiAgICBzZXF1ZW5jZXMuZm9yRWFjaCgoc2VxKSA9PiB7XG4gICAgICBpZiAoc2VxLmRhdGVBZGRlZCkge1xuICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoc2VxLmRhdGVBZGRlZCk7XG4gICAgICAgIGNvbnN0IGRhdGVLZXkgPSBkYXRlLnRvRGF0ZVN0cmluZygpO1xuICAgICAgICBpZiAoIWRhdGVHcm91cHMuaGFzKGRhdGVLZXkpKSB7XG4gICAgICAgICAgZGF0ZUdyb3Vwcy5zZXQoZGF0ZUtleSwgW10pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGdyb3VwID0gZGF0ZUdyb3Vwcy5nZXQoZGF0ZUtleSk7XG4gICAgICAgIGlmIChncm91cCkge1xuICAgICAgICAgIGdyb3VwLnB1c2goc2VxKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgaXRlbXM6IE5hdmlnYXRpb25JdGVtW10gPSBBcnJheS5mcm9tKGRhdGVHcm91cHMuZW50cmllcygpKVxuICAgICAgLnNvcnQoKFthXSwgW2JdKSA9PiBuZXcgRGF0ZShiKS5nZXRUaW1lKCkgLSBuZXcgRGF0ZShhKS5nZXRUaW1lKCkpXG4gICAgICAuc2xpY2UoMCwgMTApIC8vIFNob3cgbGFzdCAxMCBkYXRlc1xuICAgICAgLm1hcCgoW2RhdGUsIHNlcXNdKSA9PiAoe1xuICAgICAgICBpZDogYGRhdGUtJHtkYXRlfWAsXG4gICAgICAgIGxhYmVsOiB0aGlzLmZvcm1hdERhdGVMYWJlbChuZXcgRGF0ZShkYXRlKSksXG4gICAgICAgIHZhbHVlOiBkYXRlLFxuICAgICAgICBjb3VudDogc2Vxcy5sZW5ndGgsXG4gICAgICAgIGlzQWN0aXZlOiBmYWxzZSxcbiAgICAgICAgc2VxdWVuY2VzOiBzZXFzLFxuICAgICAgfSkpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBcImRhdGVcIixcbiAgICAgIHRpdGxlOiBcIvCfk4UgUmVjZW50bHkgQWRkZWRcIixcbiAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgaXRlbXMsXG4gICAgICBpc0V4cGFuZGVkOiBmYWxzZSxcbiAgICAgIHRvdGFsQ291bnQ6IHNlcXVlbmNlcy5maWx0ZXIoKHNlcSkgPT4gc2VxLmRhdGVBZGRlZCkubGVuZ3RoLFxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlTGVuZ3RoU2VjdGlvbihcbiAgICBzZXF1ZW5jZXM6IEJyb3dzZVNlcXVlbmNlTWV0YWRhdGFbXVxuICApOiBQcm9taXNlPE5hdmlnYXRpb25TZWN0aW9uPiB7XG4gICAgY29uc3QgbGVuZ3RoR3JvdXBzID0gbmV3IE1hcDxudW1iZXIsIEJyb3dzZVNlcXVlbmNlTWV0YWRhdGFbXT4oKTtcblxuICAgIHNlcXVlbmNlcy5mb3JFYWNoKChzZXEpID0+IHtcbiAgICAgIGNvbnN0IGxlbmd0aCA9IHNlcS5zZXF1ZW5jZUxlbmd0aCB8fCBzZXEud29yZC5sZW5ndGg7XG4gICAgICBpZiAoIWxlbmd0aEdyb3Vwcy5oYXMobGVuZ3RoKSkge1xuICAgICAgICBsZW5ndGhHcm91cHMuc2V0KGxlbmd0aCwgW10pO1xuICAgICAgfVxuICAgICAgY29uc3QgZ3JvdXAgPSBsZW5ndGhHcm91cHMuZ2V0KGxlbmd0aCk7XG4gICAgICBpZiAoZ3JvdXApIHtcbiAgICAgICAgZ3JvdXAucHVzaChzZXEpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgaXRlbXM6IE5hdmlnYXRpb25JdGVtW10gPSBBcnJheS5mcm9tKGxlbmd0aEdyb3Vwcy5lbnRyaWVzKCkpXG4gICAgICAuc29ydCgoW2FdLCBbYl0pID0+IGEgLSBiKVxuICAgICAgLm1hcCgoW2xlbmd0aCwgc2Vxc10pID0+ICh7XG4gICAgICAgIGlkOiBgbGVuZ3RoLSR7bGVuZ3RofWAsXG4gICAgICAgIGxhYmVsOiBgJHtsZW5ndGh9IGJlYXRzYCxcbiAgICAgICAgdmFsdWU6IGxlbmd0aCxcbiAgICAgICAgY291bnQ6IHNlcXMubGVuZ3RoLFxuICAgICAgICBpc0FjdGl2ZTogZmFsc2UsXG4gICAgICAgIHNlcXVlbmNlczogc2VxcyxcbiAgICAgIH0pKTtcblxuICAgIHJldHVybiB7XG4gICAgICBpZDogXCJsZW5ndGhcIixcbiAgICAgIHRpdGxlOiBcIvCfk48gTGVuZ3RoXCIsXG4gICAgICB0eXBlOiBcImxlbmd0aFwiLFxuICAgICAgaXRlbXMsXG4gICAgICBpc0V4cGFuZGVkOiBmYWxzZSxcbiAgICAgIHRvdGFsQ291bnQ6IHNlcXVlbmNlcy5sZW5ndGgsXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVMZXR0ZXJTZWN0aW9uKFxuICAgIHNlcXVlbmNlczogQnJvd3NlU2VxdWVuY2VNZXRhZGF0YVtdXG4gICk6IFByb21pc2U8TmF2aWdhdGlvblNlY3Rpb24+IHtcbiAgICBjb25zdCBsZXR0ZXJHcm91cHMgPSBuZXcgTWFwPHN0cmluZywgQnJvd3NlU2VxdWVuY2VNZXRhZGF0YVtdPigpO1xuXG4gICAgc2VxdWVuY2VzLmZvckVhY2goKHNlcSkgPT4ge1xuICAgICAgY29uc3QgZmlyc3RMZXR0ZXIgPSBzZXEud29yZC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKTtcbiAgICAgIGlmICghbGV0dGVyR3JvdXBzLmhhcyhmaXJzdExldHRlcikpIHtcbiAgICAgICAgbGV0dGVyR3JvdXBzLnNldChmaXJzdExldHRlciwgW10pO1xuICAgICAgfVxuICAgICAgY29uc3QgZ3JvdXAgPSBsZXR0ZXJHcm91cHMuZ2V0KGZpcnN0TGV0dGVyKTtcbiAgICAgIGlmIChncm91cCkge1xuICAgICAgICBncm91cC5wdXNoKHNlcSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBpdGVtczogTmF2aWdhdGlvbkl0ZW1bXSA9IEFycmF5LmZyb20obGV0dGVyR3JvdXBzLmVudHJpZXMoKSlcbiAgICAgIC5zb3J0KChbYV0sIFtiXSkgPT4gYS5sb2NhbGVDb21wYXJlKGIpKVxuICAgICAgLm1hcCgoW2xldHRlciwgc2Vxc10pID0+ICh7XG4gICAgICAgIGlkOiBgbGV0dGVyLSR7bGV0dGVyfWAsXG4gICAgICAgIGxhYmVsOiBsZXR0ZXIsXG4gICAgICAgIHZhbHVlOiBsZXR0ZXIsXG4gICAgICAgIGNvdW50OiBzZXFzLmxlbmd0aCxcbiAgICAgICAgaXNBY3RpdmU6IGZhbHNlLFxuICAgICAgICBzZXF1ZW5jZXM6IHNlcXMsXG4gICAgICB9KSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IFwibGV0dGVyXCIsXG4gICAgICB0aXRsZTogXCLwn5SkIFN0YXJ0aW5nIExldHRlclwiLFxuICAgICAgdHlwZTogXCJsZXR0ZXJcIixcbiAgICAgIGl0ZW1zLFxuICAgICAgaXNFeHBhbmRlZDogdHJ1ZSwgLy8gRGVmYXVsdCBleHBhbmRlZCBsaWtlIGRlc2t0b3BcbiAgICAgIHRvdGFsQ291bnQ6IHNlcXVlbmNlcy5sZW5ndGgsXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVMZXZlbFNlY3Rpb24oXG4gICAgc2VxdWVuY2VzOiBCcm93c2VTZXF1ZW5jZU1ldGFkYXRhW11cbiAgKTogUHJvbWlzZTxOYXZpZ2F0aW9uU2VjdGlvbj4ge1xuICAgIGNvbnN0IGxldmVsR3JvdXBzID0gbmV3IE1hcDxzdHJpbmcsIEJyb3dzZVNlcXVlbmNlTWV0YWRhdGFbXT4oKTtcblxuICAgIHNlcXVlbmNlcy5mb3JFYWNoKChzZXEpID0+IHtcbiAgICAgIGNvbnN0IGxldmVsID0gc2VxLmRpZmZpY3VsdHlMZXZlbCB8fCBcInVua25vd25cIjtcbiAgICAgIGlmICghbGV2ZWxHcm91cHMuaGFzKGxldmVsKSkge1xuICAgICAgICBsZXZlbEdyb3Vwcy5zZXQobGV2ZWwsIFtdKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGdyb3VwID0gbGV2ZWxHcm91cHMuZ2V0KGxldmVsKTtcbiAgICAgIGlmIChncm91cCkge1xuICAgICAgICBncm91cC5wdXNoKHNlcSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBsZXZlbE9yZGVyID0gW1wiYmVnaW5uZXJcIiwgXCJpbnRlcm1lZGlhdGVcIiwgXCJhZHZhbmNlZFwiLCBcInVua25vd25cIl07XG4gICAgY29uc3QgaXRlbXM6IE5hdmlnYXRpb25JdGVtW10gPSBsZXZlbE9yZGVyXG4gICAgICAuZmlsdGVyKChsZXZlbCkgPT4gbGV2ZWxHcm91cHMuaGFzKGxldmVsKSlcbiAgICAgIC5tYXAoKGxldmVsKSA9PiAoe1xuICAgICAgICBpZDogYGxldmVsLSR7bGV2ZWx9YCxcbiAgICAgICAgbGFiZWw6IGxldmVsLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbGV2ZWwuc2xpY2UoMSksXG4gICAgICAgIHZhbHVlOiBsZXZlbCxcbiAgICAgICAgY291bnQ6IGxldmVsR3JvdXBzLmdldChsZXZlbCk/Lmxlbmd0aCB8fCAwLFxuICAgICAgICBpc0FjdGl2ZTogZmFsc2UsXG4gICAgICAgIHNlcXVlbmNlczogbGV2ZWxHcm91cHMuZ2V0KGxldmVsKSA/PyBbXSxcbiAgICAgIH0pKTtcblxuICAgIHJldHVybiB7XG4gICAgICBpZDogXCJsZXZlbFwiLFxuICAgICAgdGl0bGU6IFwi8J+TiiBEaWZmaWN1bHR5XCIsXG4gICAgICB0eXBlOiBcImxldmVsXCIsXG4gICAgICBpdGVtcyxcbiAgICAgIGlzRXhwYW5kZWQ6IGZhbHNlLFxuICAgICAgdG90YWxDb3VudDogc2VxdWVuY2VzLmxlbmd0aCxcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZUF1dGhvclNlY3Rpb24oXG4gICAgc2VxdWVuY2VzOiBCcm93c2VTZXF1ZW5jZU1ldGFkYXRhW11cbiAgKTogUHJvbWlzZTxOYXZpZ2F0aW9uU2VjdGlvbj4ge1xuICAgIGNvbnN0IGF1dGhvckdyb3VwcyA9IG5ldyBNYXA8c3RyaW5nLCBCcm93c2VTZXF1ZW5jZU1ldGFkYXRhW10+KCk7XG5cbiAgICBzZXF1ZW5jZXMuZm9yRWFjaCgoc2VxKSA9PiB7XG4gICAgICBjb25zdCBhdXRob3IgPSBzZXEuYXV0aG9yIHx8IFwiVW5rbm93blwiO1xuICAgICAgaWYgKCFhdXRob3JHcm91cHMuaGFzKGF1dGhvcikpIHtcbiAgICAgICAgYXV0aG9yR3JvdXBzLnNldChhdXRob3IsIFtdKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGdyb3VwID0gYXV0aG9yR3JvdXBzLmdldChhdXRob3IpO1xuICAgICAgaWYgKGdyb3VwKSB7XG4gICAgICAgIGdyb3VwLnB1c2goc2VxKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IGl0ZW1zOiBOYXZpZ2F0aW9uSXRlbVtdID0gQXJyYXkuZnJvbShhdXRob3JHcm91cHMuZW50cmllcygpKVxuICAgICAgLnNvcnQoKFthXSwgW2JdKSA9PiBhLmxvY2FsZUNvbXBhcmUoYikpXG4gICAgICAubWFwKChbYXV0aG9yLCBzZXFzXSkgPT4gKHtcbiAgICAgICAgaWQ6IGBhdXRob3ItJHthdXRob3J9YCxcbiAgICAgICAgbGFiZWw6IGF1dGhvcixcbiAgICAgICAgdmFsdWU6IGF1dGhvcixcbiAgICAgICAgY291bnQ6IHNlcXMubGVuZ3RoLFxuICAgICAgICBpc0FjdGl2ZTogZmFsc2UsXG4gICAgICAgIHNlcXVlbmNlczogc2VxcyxcbiAgICAgIH0pKTtcblxuICAgIHJldHVybiB7XG4gICAgICBpZDogXCJhdXRob3JcIixcbiAgICAgIHRpdGxlOiBcIvCfkaQgQXV0aG9yXCIsXG4gICAgICB0eXBlOiBcImF1dGhvclwiLFxuICAgICAgaXRlbXMsXG4gICAgICBpc0V4cGFuZGVkOiBmYWxzZSxcbiAgICAgIHRvdGFsQ291bnQ6IHNlcXVlbmNlcy5sZW5ndGgsXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgY2FsY3VsYXRlU2VjdGlvbkNvdW50KFxuICAgIHNlY3Rpb246IE5hdmlnYXRpb25TZWN0aW9uLFxuICAgIHNlcXVlbmNlczogQnJvd3NlU2VxdWVuY2VNZXRhZGF0YVtdLFxuICAgIGZhdm9yaXRlczogc3RyaW5nW11cbiAgKTogbnVtYmVyIHtcbiAgICBzd2l0Y2ggKHNlY3Rpb24udHlwZSkge1xuICAgICAgY2FzZSBcImZhdm9yaXRlc1wiOlxuICAgICAgICByZXR1cm4gc2VxdWVuY2VzLmZpbHRlcigoc2VxKSA9PiBmYXZvcml0ZXMuaW5jbHVkZXMoc2VxLmlkKSkubGVuZ3RoO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIHNlcXVlbmNlcy5sZW5ndGg7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBmb3JtYXREYXRlTGFiZWwoZGF0ZTogRGF0ZSk6IHN0cmluZyB7XG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgICBjb25zdCBkaWZmVGltZSA9IG5vdy5nZXRUaW1lKCkgLSBkYXRlLmdldFRpbWUoKTtcbiAgICBjb25zdCBkaWZmRGF5cyA9IE1hdGguZmxvb3IoZGlmZlRpbWUgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpO1xuXG4gICAgaWYgKGRpZmZEYXlzID09PSAwKSByZXR1cm4gXCJUb2RheVwiO1xuICAgIGlmIChkaWZmRGF5cyA9PT0gMSkgcmV0dXJuIFwiWWVzdGVyZGF5XCI7XG4gICAgaWYgKGRpZmZEYXlzIDwgNykgcmV0dXJuIGAke2RpZmZEYXlzfSBkYXlzIGFnb2A7XG4gICAgaWYgKGRpZmZEYXlzIDwgMzApIHJldHVybiBgJHtNYXRoLmZsb29yKGRpZmZEYXlzIC8gNyl9IHdlZWtzIGFnb2A7XG5cbiAgICByZXR1cm4gZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKTtcbiAgfVxuXG4gIC8vIEFkZGl0aW9uYWwgbWV0aG9kcyByZXF1aXJlZCBieSBicm93c2UtaW50ZXJmYWNlcy50c1xuICBhc3luYyBidWlsZE5hdmlnYXRpb25TdHJ1Y3R1cmUoXG4gICAgc2VxdWVuY2VzOiBCcm93c2VTZXF1ZW5jZU1ldGFkYXRhW11cbiAgKTogUHJvbWlzZTxOYXZpZ2F0aW9uU2VjdGlvbltdPiB7XG4gICAgLy8gVXNlIHRoZSBleGlzdGluZyBnZW5lcmF0ZU5hdmlnYXRpb25TZWN0aW9ucyBtZXRob2RcbiAgICByZXR1cm4gdGhpcy5nZW5lcmF0ZU5hdmlnYXRpb25TZWN0aW9ucyhzZXF1ZW5jZXMsIFtdKTtcbiAgfVxuXG4gIGFzeW5jIGdldE5hdmlnYXRpb25JdGVtKFxuICAgIF9zZWN0aW9uSWQ6IHN0cmluZyxcbiAgICBfaXRlbUlkOiBzdHJpbmdcbiAgKTogUHJvbWlzZTxOYXZpZ2F0aW9uSXRlbSB8IG51bGw+IHtcbiAgICAvLyBUaGlzIHdvdWxkIG5lZWQgdG8gYmUgaW1wbGVtZW50ZWQgYmFzZWQgb24gdGhlIGN1cnJlbnQgbmF2aWdhdGlvbiBzdGF0ZVxuICAgIC8vIEZvciBub3csIHJldHVybiBudWxsIGFzIGEgcGxhY2Vob2xkZXJcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuIl0sIm1hcHBpbmdz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