export class ScrollLayoutMetricsUtil {
  /**
   * Calculates sophisticated layout metrics based on container dimensions and device info
   */
  static calculateLayoutMetrics(containerWidth, containerHeight, deviceInfo, foldableInfo, layoutConfig) {
    const metrics = {
      shouldUseCompactLayout: containerHeight < 400,
      shouldUseMobileLayout: deviceInfo.deviceType === "mobile" || deviceInfo.deviceType === "smallMobile",
      shouldUseTabletLayout: deviceInfo.deviceType === "tablet",
      isFoldableDevice: foldableInfo.isFoldable,
      isUnfoldedFoldable: foldableInfo.isFoldable && foldableInfo.isUnfolded,
      shouldAdjustForFoldable: foldableInfo.isFoldable && foldableInfo.foldableType === "zfold",
      aspectRatio: containerWidth / containerHeight,
      isLandscape: containerWidth > containerHeight,
      isPortrait: containerHeight > containerWidth,
      effectiveScaleFactor: layoutConfig.scaleFactor,
      contentPadding: 8,
      sectionSpacing: 12
    };
    if (metrics.shouldAdjustForFoldable) {
      metrics.contentPadding = metrics.isUnfoldedFoldable ? 12 : 6;
      metrics.sectionSpacing = metrics.isUnfoldedFoldable ? 16 : 8;
    }
    if (metrics.shouldUseMobileLayout) {
      metrics.contentPadding = 6;
      metrics.sectionSpacing = 8;
    }
    return metrics;
  }
  /**
   * Calculates scroll behavior configuration based on layout metrics
   */
  static calculateScrollBehavior(layoutMetrics, foldableInfo) {
    return {
      smoothScrolling: !layoutMetrics.shouldUseMobileLayout || foldableInfo.isUnfolded,
      scrollbarWidth: layoutMetrics.shouldUseMobileLayout ? "4px" : "8px",
      scrollbarOpacity: foldableInfo.isFoldable ? 0.3 : 0.2
    };
  }
  /**
   * Generates CSS custom properties for layout metrics
   */
  static generateCSSProperties(layoutMetrics, scrollBehavior) {
    return {
      "--scroll-width": scrollBehavior.scrollbarWidth,
      "--scroll-opacity": scrollBehavior.scrollbarOpacity,
      "--content-padding": `${layoutMetrics.contentPadding}px`,
      "--section-spacing": `${layoutMetrics.sectionSpacing}px`,
      "--scale-factor": layoutMetrics.effectiveScaleFactor
    };
  }
  /**
   * Generates CSS classes based on layout metrics
   */
  static generateCSSClasses(layoutMetrics, _foldableInfo) {
    const classes = [];
    if (layoutMetrics.shouldUseMobileLayout) classes.push("mobile");
    if (layoutMetrics.shouldUseTabletLayout) classes.push("tablet");
    if (layoutMetrics.isFoldableDevice) classes.push("foldable");
    if (layoutMetrics.isUnfoldedFoldable) classes.push("unfolded");
    if (layoutMetrics.shouldUseCompactLayout) classes.push("compact");
    if (layoutMetrics.isLandscape) classes.push("landscape");
    if (layoutMetrics.isPortrait) classes.push("portrait");
    return classes;
  }
  /**
   * Provides responsive breakpoint checks for advanced layouts
   */
  static getResponsiveBreakpoints(containerWidth, containerHeight) {
    return {
      isSmallMobile: containerWidth <= 375,
      isMobile: containerWidth <= 480,
      isTablet: containerWidth <= 768,
      isDesktop: containerWidth <= 1280,
      isLargeDesktop: containerWidth > 1280,
      isVeryTall: containerHeight > containerWidth * 1.5,
      isVeryWide: containerWidth > containerHeight * 2
    };
  }
  /**
   * Validates container dimensions and provides warnings for edge cases
   */
  static validateContainerDimensions(containerWidth, containerHeight) {
    const warnings = [];
    const recommendations = [];
    let isValid = true;
    if (containerWidth <= 0 || containerHeight <= 0) {
      warnings.push("Container dimensions are not positive values");
      isValid = false;
    }
    if (containerWidth < 200) {
      warnings.push("Container width is very narrow");
      recommendations.push("Consider minimum width of 200px for usability");
    }
    if (containerHeight < 300) {
      warnings.push("Container height is very short");
      recommendations.push(
        "Consider minimum height of 300px for content visibility"
      );
    }
    if (containerWidth > 2e3) {
      warnings.push("Container width is extremely wide");
      recommendations.push(
        "Consider maximum width constraints for optimal layout"
      );
    }
    const aspectRatio = containerWidth / containerHeight;
    if (aspectRatio > 3 || aspectRatio < 0.3) {
      warnings.push("Container has extreme aspect ratio");
      recommendations.push(
        "Consider more balanced aspect ratio for better user experience"
      );
    }
    return { isValid, warnings, recommendations };
  }
}
export function calculateQuickLayoutMetrics(containerWidth, containerHeight, deviceInfo, layoutConfig = {
  gridColumns: "repeat(4, minmax(0, 1fr))",
  optionSize: "100px",
  gridGap: "8px",
  gridClass: "",
  aspectClass: "",
  scaleFactor: 1
}) {
  const metrics = ScrollLayoutMetricsUtil.calculateLayoutMetrics(
    containerWidth,
    containerHeight,
    deviceInfo,
    deviceInfo.foldableInfo,
    layoutConfig
  );
  const scrollBehavior = ScrollLayoutMetricsUtil.calculateScrollBehavior(
    metrics,
    deviceInfo.foldableInfo
  );
  const cssProperties = ScrollLayoutMetricsUtil.generateCSSProperties(
    metrics,
    scrollBehavior
  );
  const cssClasses = ScrollLayoutMetricsUtil.generateCSSClasses(
    metrics,
    deviceInfo.foldableInfo
  );
  return {
    metrics,
    scrollBehavior,
    cssProperties,
    cssClasses
  };
}
export function createLayoutMetricsCalculator(containerWidth, containerHeight, deviceInfo, layoutConfig) {
  return {
    get metrics() {
      return ScrollLayoutMetricsUtil.calculateLayoutMetrics(
        containerWidth(),
        containerHeight(),
        deviceInfo(),
        deviceInfo().foldableInfo,
        layoutConfig()
      );
    },
    get scrollBehavior() {
      const metrics = ScrollLayoutMetricsUtil.calculateLayoutMetrics(
        containerWidth(),
        containerHeight(),
        deviceInfo(),
        deviceInfo().foldableInfo,
        layoutConfig()
      );
      return ScrollLayoutMetricsUtil.calculateScrollBehavior(
        metrics,
        deviceInfo().foldableInfo
      );
    },
    get cssProperties() {
      const metrics = ScrollLayoutMetricsUtil.calculateLayoutMetrics(
        containerWidth(),
        containerHeight(),
        deviceInfo(),
        deviceInfo().foldableInfo,
        layoutConfig()
      );
      const scrollBehavior = ScrollLayoutMetricsUtil.calculateScrollBehavior(
        metrics,
        deviceInfo().foldableInfo
      );
      return ScrollLayoutMetricsUtil.generateCSSProperties(
        metrics,
        scrollBehavior
      );
    },
    get cssClasses() {
      const metrics = ScrollLayoutMetricsUtil.calculateLayoutMetrics(
        containerWidth(),
        containerHeight(),
        deviceInfo(),
        deviceInfo().foldableInfo,
        layoutConfig()
      );
      return ScrollLayoutMetricsUtil.generateCSSClasses(
        metrics,
        deviceInfo().foldableInfo
      );
    }
  };
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcm9sbExheW91dE1ldHJpY3MudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBTY3JvbGxMYXlvdXRNZXRyaWNzVXRpbCAtIEFkdmFuY2VkIGxheW91dCBtZXRyaWNzIGNhbGN1bGF0aW9uIGZvciBzY3JvbGwgY29udGFpbmVyc1xuICpcbiAqIEV4dHJhY3RlZCBmcm9tIE9wdGlvblBpY2tlclNjcm9sbC5zdmVsdGUgdG8gcHJvdmlkZSByZXVzYWJsZSBsYXlvdXQgY2FsY3VsYXRpb24gbG9naWMuXG4gKiBIYW5kbGVzIHNvcGhpc3RpY2F0ZWQgZGV2aWNlIGRldGVjdGlvbiwgZm9sZGFibGUgZGV2aWNlcywgYW5kIHJlc3BvbnNpdmUgbGF5b3V0IGNhbGN1bGF0aW9ucy5cbiAqL1xuXG5pbXBvcnQgdHlwZSB7IFJlc3BvbnNpdmVMYXlvdXRDb25maWcgfSBmcm9tIFwiLi4vY29uZmlnXCI7XG5pbXBvcnQgdHlwZSB7IEZvbGRhYmxlRGV0ZWN0aW9uUmVzdWx0IH0gZnJvbSBcIi4vZGV2aWNlRGV0ZWN0aW9uXCI7XG5cbi8vID09PT09IFR5cGVzID09PT09XG5leHBvcnQgaW50ZXJmYWNlIExheW91dE1ldHJpY3Mge1xuICBzaG91bGRVc2VDb21wYWN0TGF5b3V0OiBib29sZWFuO1xuICBzaG91bGRVc2VNb2JpbGVMYXlvdXQ6IGJvb2xlYW47XG4gIHNob3VsZFVzZVRhYmxldExheW91dDogYm9vbGVhbjtcbiAgaXNGb2xkYWJsZURldmljZTogYm9vbGVhbjtcbiAgaXNVbmZvbGRlZEZvbGRhYmxlOiBib29sZWFuO1xuICBzaG91bGRBZGp1c3RGb3JGb2xkYWJsZTogYm9vbGVhbjtcbiAgYXNwZWN0UmF0aW86IG51bWJlcjtcbiAgaXNMYW5kc2NhcGU6IGJvb2xlYW47XG4gIGlzUG9ydHJhaXQ6IGJvb2xlYW47XG4gIGVmZmVjdGl2ZVNjYWxlRmFjdG9yOiBudW1iZXI7XG4gIGNvbnRlbnRQYWRkaW5nOiBudW1iZXI7XG4gIHNlY3Rpb25TcGFjaW5nOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2Nyb2xsQmVoYXZpb3JDb25maWcge1xuICBzbW9vdGhTY3JvbGxpbmc6IGJvb2xlYW47XG4gIHNjcm9sbGJhcldpZHRoOiBzdHJpbmc7XG4gIHNjcm9sbGJhck9wYWNpdHk6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEZXZpY2VJbmZvIHtcbiAgZGV2aWNlVHlwZTogc3RyaW5nO1xuICBpc0ZvbGRhYmxlOiBib29sZWFuO1xuICBmb2xkYWJsZUluZm86IEZvbGRhYmxlRGV0ZWN0aW9uUmVzdWx0O1xufVxuXG4vLyA9PT09PSBNYWluIFV0aWxpdHkgQ2xhc3MgPT09PT1cbmV4cG9ydCBjbGFzcyBTY3JvbGxMYXlvdXRNZXRyaWNzVXRpbCB7XG4gIC8qKlxuICAgKiBDYWxjdWxhdGVzIHNvcGhpc3RpY2F0ZWQgbGF5b3V0IG1ldHJpY3MgYmFzZWQgb24gY29udGFpbmVyIGRpbWVuc2lvbnMgYW5kIGRldmljZSBpbmZvXG4gICAqL1xuICBzdGF0aWMgY2FsY3VsYXRlTGF5b3V0TWV0cmljcyhcbiAgICBjb250YWluZXJXaWR0aDogbnVtYmVyLFxuICAgIGNvbnRhaW5lckhlaWdodDogbnVtYmVyLFxuICAgIGRldmljZUluZm86IERldmljZUluZm8sXG4gICAgZm9sZGFibGVJbmZvOiBGb2xkYWJsZURldGVjdGlvblJlc3VsdCxcbiAgICBsYXlvdXRDb25maWc6IFJlc3BvbnNpdmVMYXlvdXRDb25maWdcbiAgKTogTGF5b3V0TWV0cmljcyB7XG4gICAgY29uc3QgbWV0cmljczogTGF5b3V0TWV0cmljcyA9IHtcbiAgICAgIHNob3VsZFVzZUNvbXBhY3RMYXlvdXQ6IGNvbnRhaW5lckhlaWdodCA8IDQwMCxcbiAgICAgIHNob3VsZFVzZU1vYmlsZUxheW91dDpcbiAgICAgICAgZGV2aWNlSW5mby5kZXZpY2VUeXBlID09PSBcIm1vYmlsZVwiIHx8XG4gICAgICAgIGRldmljZUluZm8uZGV2aWNlVHlwZSA9PT0gXCJzbWFsbE1vYmlsZVwiLFxuICAgICAgc2hvdWxkVXNlVGFibGV0TGF5b3V0OiBkZXZpY2VJbmZvLmRldmljZVR5cGUgPT09IFwidGFibGV0XCIsXG4gICAgICBpc0ZvbGRhYmxlRGV2aWNlOiBmb2xkYWJsZUluZm8uaXNGb2xkYWJsZSxcbiAgICAgIGlzVW5mb2xkZWRGb2xkYWJsZTogZm9sZGFibGVJbmZvLmlzRm9sZGFibGUgJiYgZm9sZGFibGVJbmZvLmlzVW5mb2xkZWQsXG4gICAgICBzaG91bGRBZGp1c3RGb3JGb2xkYWJsZTpcbiAgICAgICAgZm9sZGFibGVJbmZvLmlzRm9sZGFibGUgJiYgZm9sZGFibGVJbmZvLmZvbGRhYmxlVHlwZSA9PT0gXCJ6Zm9sZFwiLFxuICAgICAgYXNwZWN0UmF0aW86IGNvbnRhaW5lcldpZHRoIC8gY29udGFpbmVySGVpZ2h0LFxuICAgICAgaXNMYW5kc2NhcGU6IGNvbnRhaW5lcldpZHRoID4gY29udGFpbmVySGVpZ2h0LFxuICAgICAgaXNQb3J0cmFpdDogY29udGFpbmVySGVpZ2h0ID4gY29udGFpbmVyV2lkdGgsXG4gICAgICBlZmZlY3RpdmVTY2FsZUZhY3RvcjogbGF5b3V0Q29uZmlnLnNjYWxlRmFjdG9yLFxuICAgICAgY29udGVudFBhZGRpbmc6IDgsXG4gICAgICBzZWN0aW9uU3BhY2luZzogMTIsXG4gICAgfTtcblxuICAgIC8vIEFkanVzdCBtZXRyaWNzIGZvciBmb2xkYWJsZSBkZXZpY2VzXG4gICAgaWYgKG1ldHJpY3Muc2hvdWxkQWRqdXN0Rm9yRm9sZGFibGUpIHtcbiAgICAgIG1ldHJpY3MuY29udGVudFBhZGRpbmcgPSBtZXRyaWNzLmlzVW5mb2xkZWRGb2xkYWJsZSA/IDEyIDogNjtcbiAgICAgIG1ldHJpY3Muc2VjdGlvblNwYWNpbmcgPSBtZXRyaWNzLmlzVW5mb2xkZWRGb2xkYWJsZSA/IDE2IDogODtcbiAgICB9XG5cbiAgICAvLyBBZGp1c3QgZm9yIG1vYmlsZSBkZXZpY2VzXG4gICAgaWYgKG1ldHJpY3Muc2hvdWxkVXNlTW9iaWxlTGF5b3V0KSB7XG4gICAgICBtZXRyaWNzLmNvbnRlbnRQYWRkaW5nID0gNjtcbiAgICAgIG1ldHJpY3Muc2VjdGlvblNwYWNpbmcgPSA4O1xuICAgIH1cblxuICAgIHJldHVybiBtZXRyaWNzO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZXMgc2Nyb2xsIGJlaGF2aW9yIGNvbmZpZ3VyYXRpb24gYmFzZWQgb24gbGF5b3V0IG1ldHJpY3NcbiAgICovXG4gIHN0YXRpYyBjYWxjdWxhdGVTY3JvbGxCZWhhdmlvcihcbiAgICBsYXlvdXRNZXRyaWNzOiBMYXlvdXRNZXRyaWNzLFxuICAgIGZvbGRhYmxlSW5mbzogRm9sZGFibGVEZXRlY3Rpb25SZXN1bHRcbiAgKTogU2Nyb2xsQmVoYXZpb3JDb25maWcge1xuICAgIHJldHVybiB7XG4gICAgICBzbW9vdGhTY3JvbGxpbmc6XG4gICAgICAgICFsYXlvdXRNZXRyaWNzLnNob3VsZFVzZU1vYmlsZUxheW91dCB8fCBmb2xkYWJsZUluZm8uaXNVbmZvbGRlZCxcbiAgICAgIHNjcm9sbGJhcldpZHRoOiBsYXlvdXRNZXRyaWNzLnNob3VsZFVzZU1vYmlsZUxheW91dCA/IFwiNHB4XCIgOiBcIjhweFwiLFxuICAgICAgc2Nyb2xsYmFyT3BhY2l0eTogZm9sZGFibGVJbmZvLmlzRm9sZGFibGUgPyAwLjMgOiAwLjIsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZXMgQ1NTIGN1c3RvbSBwcm9wZXJ0aWVzIGZvciBsYXlvdXQgbWV0cmljc1xuICAgKi9cbiAgc3RhdGljIGdlbmVyYXRlQ1NTUHJvcGVydGllcyhcbiAgICBsYXlvdXRNZXRyaWNzOiBMYXlvdXRNZXRyaWNzLFxuICAgIHNjcm9sbEJlaGF2aW9yOiBTY3JvbGxCZWhhdmlvckNvbmZpZ1xuICApOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBudW1iZXI+IHtcbiAgICByZXR1cm4ge1xuICAgICAgXCItLXNjcm9sbC13aWR0aFwiOiBzY3JvbGxCZWhhdmlvci5zY3JvbGxiYXJXaWR0aCxcbiAgICAgIFwiLS1zY3JvbGwtb3BhY2l0eVwiOiBzY3JvbGxCZWhhdmlvci5zY3JvbGxiYXJPcGFjaXR5LFxuICAgICAgXCItLWNvbnRlbnQtcGFkZGluZ1wiOiBgJHtsYXlvdXRNZXRyaWNzLmNvbnRlbnRQYWRkaW5nfXB4YCxcbiAgICAgIFwiLS1zZWN0aW9uLXNwYWNpbmdcIjogYCR7bGF5b3V0TWV0cmljcy5zZWN0aW9uU3BhY2luZ31weGAsXG4gICAgICBcIi0tc2NhbGUtZmFjdG9yXCI6IGxheW91dE1ldHJpY3MuZWZmZWN0aXZlU2NhbGVGYWN0b3IsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZXMgQ1NTIGNsYXNzZXMgYmFzZWQgb24gbGF5b3V0IG1ldHJpY3NcbiAgICovXG4gIHN0YXRpYyBnZW5lcmF0ZUNTU0NsYXNzZXMoXG4gICAgbGF5b3V0TWV0cmljczogTGF5b3V0TWV0cmljcyxcbiAgICBfZm9sZGFibGVJbmZvOiBGb2xkYWJsZURldGVjdGlvblJlc3VsdFxuICApOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgY2xhc3Nlczogc3RyaW5nW10gPSBbXTtcblxuICAgIGlmIChsYXlvdXRNZXRyaWNzLnNob3VsZFVzZU1vYmlsZUxheW91dCkgY2xhc3Nlcy5wdXNoKFwibW9iaWxlXCIpO1xuICAgIGlmIChsYXlvdXRNZXRyaWNzLnNob3VsZFVzZVRhYmxldExheW91dCkgY2xhc3Nlcy5wdXNoKFwidGFibGV0XCIpO1xuICAgIGlmIChsYXlvdXRNZXRyaWNzLmlzRm9sZGFibGVEZXZpY2UpIGNsYXNzZXMucHVzaChcImZvbGRhYmxlXCIpO1xuICAgIGlmIChsYXlvdXRNZXRyaWNzLmlzVW5mb2xkZWRGb2xkYWJsZSkgY2xhc3Nlcy5wdXNoKFwidW5mb2xkZWRcIik7XG4gICAgaWYgKGxheW91dE1ldHJpY3Muc2hvdWxkVXNlQ29tcGFjdExheW91dCkgY2xhc3Nlcy5wdXNoKFwiY29tcGFjdFwiKTtcbiAgICBpZiAobGF5b3V0TWV0cmljcy5pc0xhbmRzY2FwZSkgY2xhc3Nlcy5wdXNoKFwibGFuZHNjYXBlXCIpO1xuICAgIGlmIChsYXlvdXRNZXRyaWNzLmlzUG9ydHJhaXQpIGNsYXNzZXMucHVzaChcInBvcnRyYWl0XCIpO1xuXG4gICAgcmV0dXJuIGNsYXNzZXM7XG4gIH1cblxuICAvKipcbiAgICogUHJvdmlkZXMgcmVzcG9uc2l2ZSBicmVha3BvaW50IGNoZWNrcyBmb3IgYWR2YW5jZWQgbGF5b3V0c1xuICAgKi9cbiAgc3RhdGljIGdldFJlc3BvbnNpdmVCcmVha3BvaW50cyhcbiAgICBjb250YWluZXJXaWR0aDogbnVtYmVyLFxuICAgIGNvbnRhaW5lckhlaWdodDogbnVtYmVyXG4gICk6IHtcbiAgICBpc1NtYWxsTW9iaWxlOiBib29sZWFuO1xuICAgIGlzTW9iaWxlOiBib29sZWFuO1xuICAgIGlzVGFibGV0OiBib29sZWFuO1xuICAgIGlzRGVza3RvcDogYm9vbGVhbjtcbiAgICBpc0xhcmdlRGVza3RvcDogYm9vbGVhbjtcbiAgICBpc1ZlcnlUYWxsOiBib29sZWFuO1xuICAgIGlzVmVyeVdpZGU6IGJvb2xlYW47XG4gIH0ge1xuICAgIHJldHVybiB7XG4gICAgICBpc1NtYWxsTW9iaWxlOiBjb250YWluZXJXaWR0aCA8PSAzNzUsXG4gICAgICBpc01vYmlsZTogY29udGFpbmVyV2lkdGggPD0gNDgwLFxuICAgICAgaXNUYWJsZXQ6IGNvbnRhaW5lcldpZHRoIDw9IDc2OCxcbiAgICAgIGlzRGVza3RvcDogY29udGFpbmVyV2lkdGggPD0gMTI4MCxcbiAgICAgIGlzTGFyZ2VEZXNrdG9wOiBjb250YWluZXJXaWR0aCA+IDEyODAsXG4gICAgICBpc1ZlcnlUYWxsOiBjb250YWluZXJIZWlnaHQgPiBjb250YWluZXJXaWR0aCAqIDEuNSxcbiAgICAgIGlzVmVyeVdpZGU6IGNvbnRhaW5lcldpZHRoID4gY29udGFpbmVySGVpZ2h0ICogMixcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlcyBjb250YWluZXIgZGltZW5zaW9ucyBhbmQgcHJvdmlkZXMgd2FybmluZ3MgZm9yIGVkZ2UgY2FzZXNcbiAgICovXG4gIHN0YXRpYyB2YWxpZGF0ZUNvbnRhaW5lckRpbWVuc2lvbnMoXG4gICAgY29udGFpbmVyV2lkdGg6IG51bWJlcixcbiAgICBjb250YWluZXJIZWlnaHQ6IG51bWJlclxuICApOiB7XG4gICAgaXNWYWxpZDogYm9vbGVhbjtcbiAgICB3YXJuaW5nczogc3RyaW5nW107XG4gICAgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXTtcbiAgfSB7XG4gICAgY29uc3Qgd2FybmluZ3M6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgIGxldCBpc1ZhbGlkID0gdHJ1ZTtcblxuICAgIGlmIChjb250YWluZXJXaWR0aCA8PSAwIHx8IGNvbnRhaW5lckhlaWdodCA8PSAwKSB7XG4gICAgICB3YXJuaW5ncy5wdXNoKFwiQ29udGFpbmVyIGRpbWVuc2lvbnMgYXJlIG5vdCBwb3NpdGl2ZSB2YWx1ZXNcIik7XG4gICAgICBpc1ZhbGlkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRhaW5lcldpZHRoIDwgMjAwKSB7XG4gICAgICB3YXJuaW5ncy5wdXNoKFwiQ29udGFpbmVyIHdpZHRoIGlzIHZlcnkgbmFycm93XCIpO1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goXCJDb25zaWRlciBtaW5pbXVtIHdpZHRoIG9mIDIwMHB4IGZvciB1c2FiaWxpdHlcIik7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRhaW5lckhlaWdodCA8IDMwMCkge1xuICAgICAgd2FybmluZ3MucHVzaChcIkNvbnRhaW5lciBoZWlnaHQgaXMgdmVyeSBzaG9ydFwiKTtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKFxuICAgICAgICBcIkNvbnNpZGVyIG1pbmltdW0gaGVpZ2h0IG9mIDMwMHB4IGZvciBjb250ZW50IHZpc2liaWxpdHlcIlxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGFpbmVyV2lkdGggPiAyMDAwKSB7XG4gICAgICB3YXJuaW5ncy5wdXNoKFwiQ29udGFpbmVyIHdpZHRoIGlzIGV4dHJlbWVseSB3aWRlXCIpO1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goXG4gICAgICAgIFwiQ29uc2lkZXIgbWF4aW11bSB3aWR0aCBjb25zdHJhaW50cyBmb3Igb3B0aW1hbCBsYXlvdXRcIlxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCBhc3BlY3RSYXRpbyA9IGNvbnRhaW5lcldpZHRoIC8gY29udGFpbmVySGVpZ2h0O1xuICAgIGlmIChhc3BlY3RSYXRpbyA+IDMgfHwgYXNwZWN0UmF0aW8gPCAwLjMpIHtcbiAgICAgIHdhcm5pbmdzLnB1c2goXCJDb250YWluZXIgaGFzIGV4dHJlbWUgYXNwZWN0IHJhdGlvXCIpO1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goXG4gICAgICAgIFwiQ29uc2lkZXIgbW9yZSBiYWxhbmNlZCBhc3BlY3QgcmF0aW8gZm9yIGJldHRlciB1c2VyIGV4cGVyaWVuY2VcIlxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBpc1ZhbGlkLCB3YXJuaW5ncywgcmVjb21tZW5kYXRpb25zIH07XG4gIH1cbn1cblxuLy8gPT09PT0gQ29udmVuaWVuY2UgRnVuY3Rpb25zID09PT09XG5cbi8qKlxuICogUXVpY2sgbGF5b3V0IG1ldHJpY3MgY2FsY3VsYXRpb24gZm9yIHNpbXBsZSB1c2UgY2FzZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNhbGN1bGF0ZVF1aWNrTGF5b3V0TWV0cmljcyhcbiAgY29udGFpbmVyV2lkdGg6IG51bWJlcixcbiAgY29udGFpbmVySGVpZ2h0OiBudW1iZXIsXG4gIGRldmljZUluZm86IERldmljZUluZm8sXG4gIGxheW91dENvbmZpZzogUmVzcG9uc2l2ZUxheW91dENvbmZpZyA9IHtcbiAgICBncmlkQ29sdW1uczogXCJyZXBlYXQoNCwgbWlubWF4KDAsIDFmcikpXCIsXG4gICAgb3B0aW9uU2l6ZTogXCIxMDBweFwiLFxuICAgIGdyaWRHYXA6IFwiOHB4XCIsXG4gICAgZ3JpZENsYXNzOiBcIlwiLFxuICAgIGFzcGVjdENsYXNzOiBcIlwiLFxuICAgIHNjYWxlRmFjdG9yOiAxLjAsXG4gIH1cbik6IHtcbiAgbWV0cmljczogTGF5b3V0TWV0cmljcztcbiAgc2Nyb2xsQmVoYXZpb3I6IFNjcm9sbEJlaGF2aW9yQ29uZmlnO1xuICBjc3NQcm9wZXJ0aWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBudW1iZXI+O1xuICBjc3NDbGFzc2VzOiBzdHJpbmdbXTtcbn0ge1xuICBjb25zdCBtZXRyaWNzID0gU2Nyb2xsTGF5b3V0TWV0cmljc1V0aWwuY2FsY3VsYXRlTGF5b3V0TWV0cmljcyhcbiAgICBjb250YWluZXJXaWR0aCxcbiAgICBjb250YWluZXJIZWlnaHQsXG4gICAgZGV2aWNlSW5mbyxcbiAgICBkZXZpY2VJbmZvLmZvbGRhYmxlSW5mbyxcbiAgICBsYXlvdXRDb25maWdcbiAgKTtcblxuICBjb25zdCBzY3JvbGxCZWhhdmlvciA9IFNjcm9sbExheW91dE1ldHJpY3NVdGlsLmNhbGN1bGF0ZVNjcm9sbEJlaGF2aW9yKFxuICAgIG1ldHJpY3MsXG4gICAgZGV2aWNlSW5mby5mb2xkYWJsZUluZm9cbiAgKTtcblxuICBjb25zdCBjc3NQcm9wZXJ0aWVzID0gU2Nyb2xsTGF5b3V0TWV0cmljc1V0aWwuZ2VuZXJhdGVDU1NQcm9wZXJ0aWVzKFxuICAgIG1ldHJpY3MsXG4gICAgc2Nyb2xsQmVoYXZpb3JcbiAgKTtcbiAgY29uc3QgY3NzQ2xhc3NlcyA9IFNjcm9sbExheW91dE1ldHJpY3NVdGlsLmdlbmVyYXRlQ1NTQ2xhc3NlcyhcbiAgICBtZXRyaWNzLFxuICAgIGRldmljZUluZm8uZm9sZGFibGVJbmZvXG4gICk7XG5cbiAgcmV0dXJuIHtcbiAgICBtZXRyaWNzLFxuICAgIHNjcm9sbEJlaGF2aW9yLFxuICAgIGNzc1Byb3BlcnRpZXMsXG4gICAgY3NzQ2xhc3NlcyxcbiAgfTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgcmVhY3RpdmUgbGF5b3V0IG1ldHJpY3MgY2FsY3VsYXRvciB1c2luZyBTdmVsdGUgcnVuZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUxheW91dE1ldHJpY3NDYWxjdWxhdG9yKFxuICBjb250YWluZXJXaWR0aDogKCkgPT4gbnVtYmVyLFxuICBjb250YWluZXJIZWlnaHQ6ICgpID0+IG51bWJlcixcbiAgZGV2aWNlSW5mbzogKCkgPT4gRGV2aWNlSW5mbyxcbiAgbGF5b3V0Q29uZmlnOiAoKSA9PiBSZXNwb25zaXZlTGF5b3V0Q29uZmlnXG4pIHtcbiAgcmV0dXJuIHtcbiAgICBnZXQgbWV0cmljcygpIHtcbiAgICAgIHJldHVybiBTY3JvbGxMYXlvdXRNZXRyaWNzVXRpbC5jYWxjdWxhdGVMYXlvdXRNZXRyaWNzKFxuICAgICAgICBjb250YWluZXJXaWR0aCgpLFxuICAgICAgICBjb250YWluZXJIZWlnaHQoKSxcbiAgICAgICAgZGV2aWNlSW5mbygpLFxuICAgICAgICBkZXZpY2VJbmZvKCkuZm9sZGFibGVJbmZvLFxuICAgICAgICBsYXlvdXRDb25maWcoKVxuICAgICAgKTtcbiAgICB9LFxuICAgIGdldCBzY3JvbGxCZWhhdmlvcigpIHtcbiAgICAgIGNvbnN0IG1ldHJpY3MgPSBTY3JvbGxMYXlvdXRNZXRyaWNzVXRpbC5jYWxjdWxhdGVMYXlvdXRNZXRyaWNzKFxuICAgICAgICBjb250YWluZXJXaWR0aCgpLFxuICAgICAgICBjb250YWluZXJIZWlnaHQoKSxcbiAgICAgICAgZGV2aWNlSW5mbygpLFxuICAgICAgICBkZXZpY2VJbmZvKCkuZm9sZGFibGVJbmZvLFxuICAgICAgICBsYXlvdXRDb25maWcoKVxuICAgICAgKTtcbiAgICAgIHJldHVybiBTY3JvbGxMYXlvdXRNZXRyaWNzVXRpbC5jYWxjdWxhdGVTY3JvbGxCZWhhdmlvcihcbiAgICAgICAgbWV0cmljcyxcbiAgICAgICAgZGV2aWNlSW5mbygpLmZvbGRhYmxlSW5mb1xuICAgICAgKTtcbiAgICB9LFxuICAgIGdldCBjc3NQcm9wZXJ0aWVzKCkge1xuICAgICAgY29uc3QgbWV0cmljcyA9IFNjcm9sbExheW91dE1ldHJpY3NVdGlsLmNhbGN1bGF0ZUxheW91dE1ldHJpY3MoXG4gICAgICAgIGNvbnRhaW5lcldpZHRoKCksXG4gICAgICAgIGNvbnRhaW5lckhlaWdodCgpLFxuICAgICAgICBkZXZpY2VJbmZvKCksXG4gICAgICAgIGRldmljZUluZm8oKS5mb2xkYWJsZUluZm8sXG4gICAgICAgIGxheW91dENvbmZpZygpXG4gICAgICApO1xuICAgICAgY29uc3Qgc2Nyb2xsQmVoYXZpb3IgPSBTY3JvbGxMYXlvdXRNZXRyaWNzVXRpbC5jYWxjdWxhdGVTY3JvbGxCZWhhdmlvcihcbiAgICAgICAgbWV0cmljcyxcbiAgICAgICAgZGV2aWNlSW5mbygpLmZvbGRhYmxlSW5mb1xuICAgICAgKTtcbiAgICAgIHJldHVybiBTY3JvbGxMYXlvdXRNZXRyaWNzVXRpbC5nZW5lcmF0ZUNTU1Byb3BlcnRpZXMoXG4gICAgICAgIG1ldHJpY3MsXG4gICAgICAgIHNjcm9sbEJlaGF2aW9yXG4gICAgICApO1xuICAgIH0sXG4gICAgZ2V0IGNzc0NsYXNzZXMoKSB7XG4gICAgICBjb25zdCBtZXRyaWNzID0gU2Nyb2xsTGF5b3V0TWV0cmljc1V0aWwuY2FsY3VsYXRlTGF5b3V0TWV0cmljcyhcbiAgICAgICAgY29udGFpbmVyV2lkdGgoKSxcbiAgICAgICAgY29udGFpbmVySGVpZ2h0KCksXG4gICAgICAgIGRldmljZUluZm8oKSxcbiAgICAgICAgZGV2aWNlSW5mbygpLmZvbGRhYmxlSW5mbyxcbiAgICAgICAgbGF5b3V0Q29uZmlnKClcbiAgICAgICk7XG4gICAgICByZXR1cm4gU2Nyb2xsTGF5b3V0TWV0cmljc1V0aWwuZ2VuZXJhdGVDU1NDbGFzc2VzKFxuICAgICAgICBtZXRyaWNzLFxuICAgICAgICBkZXZpY2VJbmZvKCkuZm9sZGFibGVJbmZvXG4gICAgICApO1xuICAgIH0sXG4gIH07XG59XG4iXSwibWFw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