import { createArrowData } from "/src/lib/domain/ArrowData.ts";
import { createGridData } from "/src/lib/domain/GridData.ts";
import { createPropData } from "/src/lib/domain/PropData.ts";
import {
  ArrowType,
  Direction,
  GridPosition,
  LetterType,
  MotionColor,
  Timing
} from "/src/lib/domain/enums.ts";
export function createPictographData(data = {}) {
  const arrows = {
    blue: createArrowData({
      arrowType: ArrowType.BLUE,
      color: MotionColor.BLUE
    }),
    red: createArrowData({ arrowType: ArrowType.RED, color: MotionColor.RED }),
    ...data.arrows
  };
  const props = {
    blue: createPropData({ color: MotionColor.BLUE }),
    red: createPropData({ color: MotionColor.RED }),
    ...data.props
  };
  return {
    id: data.id ?? crypto.randomUUID(),
    gridData: data.gridData ?? createGridData(),
    arrows,
    props,
    motions: data.motions ?? {},
    letter: data.letter ?? null,
    startPosition: data.startPosition ?? null,
    endPosition: data.endPosition ?? null,
    beat: data.beat ?? 0,
    timing: data.timing ?? null,
    direction: data.direction ?? null,
    duration: data.duration ?? null,
    letterType: data.letterType ?? null,
    isBlank: data.isBlank ?? false,
    isMirrored: data.isMirrored ?? false,
    metadata: data.metadata ?? {}
  };
}
export function updatePictographData(pictograph, updates) {
  return {
    ...pictograph,
    ...updates
  };
}
export function updateArrow(pictograph, color, updates) {
  if (!(color in pictograph.arrows)) {
    throw new Error(`Arrow color '${color}' not found`);
  }
  const currentArrow = pictograph.arrows[color];
  const updatedArrow = { ...currentArrow, ...updates };
  const newArrows = { ...pictograph.arrows, [color]: updatedArrow };
  return { ...pictograph, arrows: newArrows };
}
export function updateProp(pictograph, color, updates) {
  if (!(color in pictograph.props)) {
    throw new Error(`Prop color '${color}' not found`);
  }
  const currentProp = pictograph.props[color];
  const updatedProp = { ...currentProp, ...updates };
  const newProps = { ...pictograph.props, [color]: updatedProp };
  return { ...pictograph, props: newProps };
}
export function getBlueArrow(pictograph) {
  return pictograph.arrows.blue ?? createArrowData({ arrowType: ArrowType.BLUE, color: MotionColor.BLUE });
}
export function getRedArrow(pictograph) {
  return pictograph.arrows.red ?? createArrowData({ arrowType: ArrowType.RED, color: MotionColor.RED });
}
export function getBlueProp(pictograph) {
  return pictograph.props.blue ?? createPropData({ color: MotionColor.BLUE });
}
export function getRedProp(pictograph) {
  return pictograph.props.red ?? createPropData({ color: MotionColor.RED });
}
export function pictographDataToObject(pictograph) {
  return {
    id: pictograph.id,
    gridData: pictograph.gridData,
    arrows: pictograph.arrows,
    props: pictograph.props,
    motions: pictograph.motions,
    letter: pictograph.letter,
    startPosition: pictograph.startPosition,
    endPosition: pictograph.endPosition,
    beat: pictograph.beat,
    timing: pictograph.timing,
    direction: pictograph.direction,
    duration: pictograph.duration,
    letterType: pictograph.letterType,
    isBlank: pictograph.isBlank,
    isMirrored: pictograph.isMirrored,
    metadata: pictograph.metadata
  };
}
export function pictographDataFromObject(data) {
  const pictographData = {};
  if (data.id !== void 0) {
    pictographData.id = data.id;
  }
  if (data.gridData !== void 0) {
    pictographData.gridData = data.gridData;
  }
  if (data.arrows !== void 0) {
    pictographData.arrows = data.arrows;
  }
  if (data.props !== void 0) {
    pictographData.props = data.props;
  }
  if (data.motions !== void 0) {
    pictographData.motions = data.motions;
  }
  if (data.letter !== void 0) {
    pictographData.letter = data.letter;
  }
  if (data.startPosition !== void 0) {
    pictographData.startPosition = data.startPosition;
  }
  if (data.endPosition !== void 0) {
    pictographData.endPosition = data.endPosition;
  }
  if (data.beat !== void 0) {
    pictographData.beat = data.beat;
  }
  if (data.timing !== void 0) {
    pictographData.timing = data.timing;
  }
  if (data.direction !== void 0) {
    pictographData.direction = data.direction;
  }
  if (data.duration !== void 0) {
    pictographData.duration = data.duration;
  }
  if (data.letterType !== void 0) {
    pictographData.letterType = data.letterType;
  }
  if (data.isBlank !== void 0) {
    pictographData.isBlank = data.isBlank;
  }
  if (data.isMirrored !== void 0) {
    pictographData.isMirrored = data.isMirrored;
  }
  if (data.metadata !== void 0) {
    pictographData.metadata = data.metadata;
  }
  return createPictographData(pictographData);
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlBpY3RvZ3JhcGhEYXRhLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUGljdG9ncmFwaCBEb21haW4gTW9kZWxcbiAqXG4gKiBJbW11dGFibGUgZGF0YSBmb3IgYSBjb21wbGV0ZSBwaWN0b2dyYXBoLlxuICogQmFzZWQgb24gbW9kZXJuIGRlc2t0b3AgYXBwJ3MgcGljdG9ncmFwaERhdGEucHlcbiAqL1xuXG5pbXBvcnQgdHlwZSB7IEFycm93RGF0YSB9IGZyb20gXCIuL0Fycm93RGF0YVwiO1xuaW1wb3J0IHsgY3JlYXRlQXJyb3dEYXRhIH0gZnJvbSBcIi4vQXJyb3dEYXRhXCI7XG5pbXBvcnQgdHlwZSB7IEdyaWREYXRhIH0gZnJvbSBcIi4vR3JpZERhdGFcIjtcbmltcG9ydCB7IGNyZWF0ZUdyaWREYXRhIH0gZnJvbSBcIi4vR3JpZERhdGFcIjtcbmltcG9ydCB0eXBlIHsgTW90aW9uRGF0YSB9IGZyb20gXCIuL01vdGlvbkRhdGFcIjtcbmltcG9ydCB0eXBlIHsgUHJvcERhdGEgfSBmcm9tIFwiLi9Qcm9wRGF0YVwiO1xuaW1wb3J0IHsgY3JlYXRlUHJvcERhdGEgfSBmcm9tIFwiLi9Qcm9wRGF0YVwiO1xuaW1wb3J0IHtcbiAgQXJyb3dUeXBlLFxuICBEaXJlY3Rpb24sXG4gIEdyaWRQb3NpdGlvbixcbiAgTGV0dGVyVHlwZSxcbiAgTW90aW9uQ29sb3IsXG4gIFRpbWluZyxcbn0gZnJvbSBcIi4vZW51bXNcIjtcblxuZXhwb3J0IGludGVyZmFjZSBQaWN0b2dyYXBoRGF0YSB7XG4gIC8vIENvcmUgaWRlbnRpdHlcbiAgcmVhZG9ubHkgaWQ6IHN0cmluZztcblxuICAvLyBHcmlkIGNvbmZpZ3VyYXRpb25cbiAgcmVhZG9ubHkgZ3JpZERhdGE6IEdyaWREYXRhO1xuXG4gIC8vIEFycm93cywgcHJvcHMsIGFuZCBtb3Rpb25zIChjb25zaXN0ZW50IGRpY3Rpb25hcnkgYXBwcm9hY2gpXG4gIHJlYWRvbmx5IGFycm93czogUmVjb3JkPHN0cmluZywgQXJyb3dEYXRhPjsgLy8gXCJibHVlXCIsIFwicmVkXCJcbiAgcmVhZG9ubHkgcHJvcHM6IFJlY29yZDxzdHJpbmcsIFByb3BEYXRhPjsgLy8gXCJibHVlXCIsIFwicmVkXCJcbiAgcmVhZG9ubHkgbW90aW9uczogUmVjb3JkPHN0cmluZywgTW90aW9uRGF0YT47IC8vIFwiYmx1ZVwiLCBcInJlZFwiXG5cbiAgLy8gTGV0dGVyIGFuZCBwb3NpdGlvbiBkYXRhXG4gIHJlYWRvbmx5IGxldHRlcj86IHN0cmluZyB8IG51bGw7XG4gIHJlYWRvbmx5IHN0YXJ0UG9zaXRpb24/OiBHcmlkUG9zaXRpb24gfCBudWxsO1xuICByZWFkb25seSBlbmRQb3NpdGlvbj86IEdyaWRQb3NpdGlvbiB8IG51bGw7XG5cbiAgLy8gTGVnYWN5IGNvbXBhdGliaWxpdHkgcHJvcGVydGllc1xuICByZWFkb25seSBncmlkTW9kZT86IHN0cmluZyB8IG51bGw7XG5cbiAgLy8gTGV0dGVyIGRldGVybWluYXRpb24gZmllbGRzXG4gIHJlYWRvbmx5IGJlYXQ6IG51bWJlcjtcbiAgcmVhZG9ubHkgdGltaW5nPzogVGltaW5nIHwgbnVsbDtcbiAgcmVhZG9ubHkgZGlyZWN0aW9uPzogRGlyZWN0aW9uIHwgbnVsbDtcbiAgcmVhZG9ubHkgZHVyYXRpb24/OiBudW1iZXIgfCBudWxsO1xuICByZWFkb25seSBsZXR0ZXJUeXBlPzogTGV0dGVyVHlwZSB8IG51bGw7XG5cbiAgLy8gVmlzdWFsIHN0YXRlXG4gIHJlYWRvbmx5IGlzQmxhbms6IGJvb2xlYW47XG4gIHJlYWRvbmx5IGlzTWlycm9yZWQ6IGJvb2xlYW47XG5cbiAgLy8gTWV0YWRhdGFcbiAgcmVhZG9ubHkgbWV0YWRhdGE6IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUGljdG9ncmFwaERhdGEoXG4gIGRhdGE6IFBhcnRpYWw8UGljdG9ncmFwaERhdGE+ID0ge31cbik6IFBpY3RvZ3JhcGhEYXRhIHtcbiAgLy8gRW5zdXJlIHdlIGhhdmUgYmx1ZSBhbmQgcmVkIGFycm93c1xuICBjb25zdCBhcnJvd3MgPSB7XG4gICAgYmx1ZTogY3JlYXRlQXJyb3dEYXRhKHtcbiAgICAgIGFycm93VHlwZTogQXJyb3dUeXBlLkJMVUUsXG4gICAgICBjb2xvcjogTW90aW9uQ29sb3IuQkxVRSxcbiAgICB9KSxcbiAgICByZWQ6IGNyZWF0ZUFycm93RGF0YSh7IGFycm93VHlwZTogQXJyb3dUeXBlLlJFRCwgY29sb3I6IE1vdGlvbkNvbG9yLlJFRCB9KSxcbiAgICAuLi5kYXRhLmFycm93cyxcbiAgfTtcblxuICAvLyBFbnN1cmUgd2UgaGF2ZSBibHVlIGFuZCByZWQgcHJvcHNcbiAgY29uc3QgcHJvcHMgPSB7XG4gICAgYmx1ZTogY3JlYXRlUHJvcERhdGEoeyBjb2xvcjogTW90aW9uQ29sb3IuQkxVRSB9KSxcbiAgICByZWQ6IGNyZWF0ZVByb3BEYXRhKHsgY29sb3I6IE1vdGlvbkNvbG9yLlJFRCB9KSxcbiAgICAuLi5kYXRhLnByb3BzLFxuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaWQ6IGRhdGEuaWQgPz8gY3J5cHRvLnJhbmRvbVVVSUQoKSxcbiAgICBncmlkRGF0YTogZGF0YS5ncmlkRGF0YSA/PyBjcmVhdGVHcmlkRGF0YSgpLFxuICAgIGFycm93cyxcbiAgICBwcm9wcyxcbiAgICBtb3Rpb25zOiBkYXRhLm1vdGlvbnMgPz8ge30sXG4gICAgbGV0dGVyOiBkYXRhLmxldHRlciA/PyBudWxsLFxuICAgIHN0YXJ0UG9zaXRpb246IGRhdGEuc3RhcnRQb3NpdGlvbiA/PyBudWxsLFxuICAgIGVuZFBvc2l0aW9uOiBkYXRhLmVuZFBvc2l0aW9uID8/IG51bGwsXG4gICAgYmVhdDogZGF0YS5iZWF0ID8/IDAsXG4gICAgdGltaW5nOiBkYXRhLnRpbWluZyA/PyBudWxsLFxuICAgIGRpcmVjdGlvbjogZGF0YS5kaXJlY3Rpb24gPz8gbnVsbCxcbiAgICBkdXJhdGlvbjogZGF0YS5kdXJhdGlvbiA/PyBudWxsLFxuICAgIGxldHRlclR5cGU6IGRhdGEubGV0dGVyVHlwZSA/PyBudWxsLFxuICAgIGlzQmxhbms6IGRhdGEuaXNCbGFuayA/PyBmYWxzZSxcbiAgICBpc01pcnJvcmVkOiBkYXRhLmlzTWlycm9yZWQgPz8gZmFsc2UsXG4gICAgbWV0YWRhdGE6IGRhdGEubWV0YWRhdGEgPz8ge30sXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVQaWN0b2dyYXBoRGF0YShcbiAgcGljdG9ncmFwaDogUGljdG9ncmFwaERhdGEsXG4gIHVwZGF0ZXM6IFBhcnRpYWw8UGljdG9ncmFwaERhdGE+XG4pOiBQaWN0b2dyYXBoRGF0YSB7XG4gIHJldHVybiB7XG4gICAgLi4ucGljdG9ncmFwaCxcbiAgICAuLi51cGRhdGVzLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQXJyb3coXG4gIHBpY3RvZ3JhcGg6IFBpY3RvZ3JhcGhEYXRhLFxuICBjb2xvcjogc3RyaW5nLFxuICB1cGRhdGVzOiBQYXJ0aWFsPEFycm93RGF0YT5cbik6IFBpY3RvZ3JhcGhEYXRhIHtcbiAgaWYgKCEoY29sb3IgaW4gcGljdG9ncmFwaC5hcnJvd3MpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBBcnJvdyBjb2xvciAnJHtjb2xvcn0nIG5vdCBmb3VuZGApO1xuICB9XG5cbiAgY29uc3QgY3VycmVudEFycm93ID0gcGljdG9ncmFwaC5hcnJvd3NbY29sb3JdO1xuICBjb25zdCB1cGRhdGVkQXJyb3cgPSB7IC4uLmN1cnJlbnRBcnJvdywgLi4udXBkYXRlcyB9O1xuICBjb25zdCBuZXdBcnJvd3MgPSB7IC4uLnBpY3RvZ3JhcGguYXJyb3dzLCBbY29sb3JdOiB1cGRhdGVkQXJyb3cgfSBhcyBSZWNvcmQ8XG4gICAgc3RyaW5nLFxuICAgIEFycm93RGF0YVxuICA+O1xuICByZXR1cm4geyAuLi5waWN0b2dyYXBoLCBhcnJvd3M6IG5ld0Fycm93cyB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlUHJvcChcbiAgcGljdG9ncmFwaDogUGljdG9ncmFwaERhdGEsXG4gIGNvbG9yOiBzdHJpbmcsXG4gIHVwZGF0ZXM6IFBhcnRpYWw8UHJvcERhdGE+XG4pOiBQaWN0b2dyYXBoRGF0YSB7XG4gIGlmICghKGNvbG9yIGluIHBpY3RvZ3JhcGgucHJvcHMpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBQcm9wIGNvbG9yICcke2NvbG9yfScgbm90IGZvdW5kYCk7XG4gIH1cblxuICBjb25zdCBjdXJyZW50UHJvcCA9IHBpY3RvZ3JhcGgucHJvcHNbY29sb3JdO1xuICBjb25zdCB1cGRhdGVkUHJvcCA9IHsgLi4uY3VycmVudFByb3AsIC4uLnVwZGF0ZXMgfTtcbiAgY29uc3QgbmV3UHJvcHMgPSB7IC4uLnBpY3RvZ3JhcGgucHJvcHMsIFtjb2xvcl06IHVwZGF0ZWRQcm9wIH0gYXMgUmVjb3JkPFxuICAgIHN0cmluZyxcbiAgICBQcm9wRGF0YVxuICA+O1xuICByZXR1cm4geyAuLi5waWN0b2dyYXBoLCBwcm9wczogbmV3UHJvcHMgfTtcbn1cblxuLy8gQ29udmVuaWVuY2UgZ2V0dGVyc1xuZXhwb3J0IGZ1bmN0aW9uIGdldEJsdWVBcnJvdyhwaWN0b2dyYXBoOiBQaWN0b2dyYXBoRGF0YSk6IEFycm93RGF0YSB7XG4gIHJldHVybiAoXG4gICAgcGljdG9ncmFwaC5hcnJvd3MuYmx1ZSA/P1xuICAgIGNyZWF0ZUFycm93RGF0YSh7IGFycm93VHlwZTogQXJyb3dUeXBlLkJMVUUsIGNvbG9yOiBNb3Rpb25Db2xvci5CTFVFIH0pXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZWRBcnJvdyhwaWN0b2dyYXBoOiBQaWN0b2dyYXBoRGF0YSk6IEFycm93RGF0YSB7XG4gIHJldHVybiAoXG4gICAgcGljdG9ncmFwaC5hcnJvd3MucmVkID8/XG4gICAgY3JlYXRlQXJyb3dEYXRhKHsgYXJyb3dUeXBlOiBBcnJvd1R5cGUuUkVELCBjb2xvcjogTW90aW9uQ29sb3IuUkVEIH0pXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRCbHVlUHJvcChwaWN0b2dyYXBoOiBQaWN0b2dyYXBoRGF0YSk6IFByb3BEYXRhIHtcbiAgcmV0dXJuIHBpY3RvZ3JhcGgucHJvcHMuYmx1ZSA/PyBjcmVhdGVQcm9wRGF0YSh7IGNvbG9yOiBNb3Rpb25Db2xvci5CTFVFIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmVkUHJvcChwaWN0b2dyYXBoOiBQaWN0b2dyYXBoRGF0YSk6IFByb3BEYXRhIHtcbiAgcmV0dXJuIHBpY3RvZ3JhcGgucHJvcHMucmVkID8/IGNyZWF0ZVByb3BEYXRhKHsgY29sb3I6IE1vdGlvbkNvbG9yLlJFRCB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBpY3RvZ3JhcGhEYXRhVG9PYmplY3QoXG4gIHBpY3RvZ3JhcGg6IFBpY3RvZ3JhcGhEYXRhXG4pOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IHBpY3RvZ3JhcGguaWQsXG4gICAgZ3JpZERhdGE6IHBpY3RvZ3JhcGguZ3JpZERhdGEsXG4gICAgYXJyb3dzOiBwaWN0b2dyYXBoLmFycm93cyxcbiAgICBwcm9wczogcGljdG9ncmFwaC5wcm9wcyxcbiAgICBtb3Rpb25zOiBwaWN0b2dyYXBoLm1vdGlvbnMsXG4gICAgbGV0dGVyOiBwaWN0b2dyYXBoLmxldHRlcixcbiAgICBzdGFydFBvc2l0aW9uOiBwaWN0b2dyYXBoLnN0YXJ0UG9zaXRpb24sXG4gICAgZW5kUG9zaXRpb246IHBpY3RvZ3JhcGguZW5kUG9zaXRpb24sXG4gICAgYmVhdDogcGljdG9ncmFwaC5iZWF0LFxuICAgIHRpbWluZzogcGljdG9ncmFwaC50aW1pbmcsXG4gICAgZGlyZWN0aW9uOiBwaWN0b2dyYXBoLmRpcmVjdGlvbixcbiAgICBkdXJhdGlvbjogcGljdG9ncmFwaC5kdXJhdGlvbixcbiAgICBsZXR0ZXJUeXBlOiBwaWN0b2dyYXBoLmxldHRlclR5cGUsXG4gICAgaXNCbGFuazogcGljdG9ncmFwaC5pc0JsYW5rLFxuICAgIGlzTWlycm9yZWQ6IHBpY3RvZ3JhcGguaXNNaXJyb3JlZCxcbiAgICBtZXRhZGF0YTogcGljdG9ncmFwaC5tZXRhZGF0YSxcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBpY3RvZ3JhcGhEYXRhRnJvbU9iamVjdChcbiAgZGF0YTogUmVjb3JkPHN0cmluZywgdW5rbm93bj5cbik6IFBpY3RvZ3JhcGhEYXRhIHtcbiAgY29uc3QgcGljdG9ncmFwaERhdGE6IFJlY29yZDxzdHJpbmcsIHVua25vd24+ID0ge307XG5cbiAgaWYgKGRhdGEuaWQgIT09IHVuZGVmaW5lZCkge1xuICAgIHBpY3RvZ3JhcGhEYXRhLmlkID0gZGF0YS5pZDtcbiAgfVxuICBpZiAoZGF0YS5ncmlkRGF0YSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcGljdG9ncmFwaERhdGEuZ3JpZERhdGEgPSBkYXRhLmdyaWREYXRhO1xuICB9XG4gIGlmIChkYXRhLmFycm93cyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcGljdG9ncmFwaERhdGEuYXJyb3dzID0gZGF0YS5hcnJvd3M7XG4gIH1cbiAgaWYgKGRhdGEucHJvcHMgIT09IHVuZGVmaW5lZCkge1xuICAgIHBpY3RvZ3JhcGhEYXRhLnByb3BzID0gZGF0YS5wcm9wcztcbiAgfVxuICBpZiAoZGF0YS5tb3Rpb25zICE9PSB1bmRlZmluZWQpIHtcbiAgICBwaWN0b2dyYXBoRGF0YS5tb3Rpb25zID0gZGF0YS5tb3Rpb25zO1xuICB9XG4gIGlmIChkYXRhLmxldHRlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcGljdG9ncmFwaERhdGEubGV0dGVyID0gZGF0YS5sZXR0ZXI7XG4gIH1cbiAgaWYgKGRhdGEuc3RhcnRQb3NpdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcGljdG9ncmFwaERhdGEuc3RhcnRQb3NpdGlvbiA9IGRhdGEuc3RhcnRQb3NpdGlvbjtcbiAgfVxuICBpZiAoZGF0YS5lbmRQb3NpdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcGljdG9ncmFwaERhdGEuZW5kUG9zaXRpb24gPSBkYXRhLmVuZFBvc2l0aW9uO1xuICB9XG4gIGlmIChkYXRhLmJlYXQgIT09IHVuZGVmaW5lZCkge1xuICAgIHBpY3RvZ3JhcGhEYXRhLmJlYXQgPSBkYXRhLmJlYXQ7XG4gIH1cbiAgaWYgKGRhdGEudGltaW5nICE9PSB1bmRlZmluZWQpIHtcbiAgICBwaWN0b2dyYXBoRGF0YS50aW1pbmcgPSBkYXRhLnRpbWluZztcbiAgfVxuICBpZiAoZGF0YS5kaXJlY3Rpb24gIT09IHVuZGVmaW5lZCkge1xuICAgIHBpY3RvZ3JhcGhEYXRhLmRpcmVjdGlvbiA9IGRhdGEuZGlyZWN0aW9uO1xuICB9XG4gIGlmIChkYXRhLmR1cmF0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICBwaWN0b2dyYXBoRGF0YS5kdXJhdGlvbiA9IGRhdGEuZHVyYXRpb247XG4gIH1cbiAgaWYgKGRhdGEubGV0dGVyVHlwZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcGljdG9ncmFwaERhdGEubGV0dGVyVHlwZSA9IGRhdGEubGV0dGVyVHlwZTtcbiAgfVxuICBpZiAoZGF0YS5pc0JsYW5rICE9PSB1bmRlZmluZWQpIHtcbiAgICBwaWN0b2dyYXBoRGF0YS5pc0JsYW5rID0gZGF0YS5pc0JsYW5rO1xuICB9XG4gIGlmIChkYXRhLmlzTWlycm9yZWQgIT09IHVuZGVmaW5lZCkge1xuICAgIHBpY3RvZ3JhcGhEYXRhLmlzTWlycm9yZWQgPSBkYXRhLmlzTWlycm9yZWQ7XG4gIH1cbiAgaWYgKGRhdGEubWV0YWRhdGEgIT09IHVuZGVmaW5lZCkge1xuICAgIHBpY3RvZ3JhcGhEYXRhLm1ldGFkYXRhID0gZGF0YS5tZXRhZGF0YTtcbiAgfVxuXG4gIHJldHVybiBjcmVhdGVQaWN0b2dyYXBoRGF0YShwaWN0b2dyYXBoRGF0YSBhcyBQYXJ0aWFsPFBpY3RvZ3JhcGhEYXRhPik7XG59XG4iXSwibWFwcGluZ3MiOiJBQVFBLFNBQVMsdUJBQXVCO0FBRWhDLFNBQVMsc0JBQXNCO0FBRy9CLFNBQVMsc0JBQXNCO0FBQy9CO0FBQUEsRUFDRTtBQUFBLEVBQ0E7QUFBQSxF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