import {
  getContainerAspect
} from "/src/lib/components/construct/option-picker/config.ts";
import {
  detectFoldableDevice
} from "/src/lib/components/construct/option-picker/utils/deviceDetection.ts";
import {
  getEnhancedDeviceType,
  getResponsiveLayout
} from "/src/lib/components/construct/option-picker/utils/layoutUtils.ts";
export class OptionPickerLayoutManager {
  static lastCalculationKey = "";
  static lastCalculationResult = null;
  /**
   * Calculate sophisticated responsive layout using the advanced layout system
   */
  static calculateLayout(params) {
    const {
      count,
      containerWidth,
      containerHeight,
      windowWidth = containerWidth,
      windowHeight = containerHeight,
      isMobileUserAgent = false
    } = params;
    const cacheKey = `${count}:${containerWidth}:${containerHeight}:${windowWidth}:${windowHeight}:${isMobileUserAgent}`;
    if (this.lastCalculationKey === cacheKey && this.lastCalculationResult) {
      return this.lastCalculationResult;
    }
    const foldableInfo = detectFoldableDevice();
    const enhancedDeviceInfo = getEnhancedDeviceType(
      containerWidth,
      isMobileUserAgent
    );
    const deviceType = enhancedDeviceInfo.deviceType;
    const isMobile = deviceType === "smallMobile" || deviceType === "mobile";
    const isTablet = deviceType === "tablet";
    const isPortrait = containerHeight > containerWidth;
    const containerAspect = getContainerAspect(containerWidth, containerHeight);
    const layoutConfig = getResponsiveLayout(
      count,
      containerHeight,
      containerWidth,
      isMobile,
      isPortrait,
      foldableInfo
    );
    const columnsMatch = layoutConfig.gridColumns.match(/repeat\((\d+),/);
    const optionsPerRow = columnsMatch && columnsMatch[1] ? parseInt(columnsMatch[1], 10) : 4;
    const optionSizeMatch = layoutConfig.optionSize.match(/(\d+)px/);
    const optionSize = optionSizeMatch && optionSizeMatch[1] ? parseInt(optionSizeMatch[1], 10) : 100;
    const result = {
      optionsPerRow,
      optionSize,
      gridGap: layoutConfig.gridGap,
      gridColumns: layoutConfig.gridColumns,
      gridClass: layoutConfig.gridClass,
      aspectClass: layoutConfig.aspectClass,
      scaleFactor: layoutConfig.scaleFactor,
      deviceType,
      containerAspect,
      isMobile,
      isTablet,
      isPortrait,
      foldableInfo,
      layoutConfig
    };
    this.lastCalculationKey = cacheKey;
    this.lastCalculationResult = result;
    return result;
  }
  /**
   * Legacy compatibility method - simplified interface
   */
  static calculateSimpleLayout(containerWidth) {
    const result = this.calculateLayout({
      count: 10,
      // Default count for legacy compatibility
      containerWidth,
      containerHeight: 600
      // Default height
    });
    return {
      optionsPerRow: result.optionsPerRow,
      optionSize: result.optionSize
    };
  }
  /**
   * Get responsive layout configuration for a specific count and container dimensions
   */
  static getResponsiveConfig(count, containerWidth, containerHeight) {
    const result = this.calculateLayout({
      count,
      containerWidth,
      containerHeight
    });
    return result.layoutConfig;
  }
  /**
   * Determine if the current layout should use mobile optimizations
   */
  static shouldUseMobileLayout(containerWidth, _isMobileUserAgent) {
    const result = this.calculateLayout({
      count: 1,
      // Minimal count for device detection
      containerWidth,
      containerHeight: 400
      // Default height for detection
    });
    return result.isMobile;
  }
  /**
   * Get device information for the current container dimensions
   */
  static getDeviceInfo(containerWidth, _isMobileUserAgent) {
    const result = this.calculateLayout({
      count: 1,
      containerWidth,
      containerHeight: 400
    });
    return {
      deviceType: result.deviceType,
      isMobile: result.isMobile,
      isTablet: result.isTablet,
      foldableInfo: result.foldableInfo
    };
  }
  /**
   * Calculate optimal option size for given parameters
   */
  static calculateOptimalOptionSize(count, containerWidth, containerHeight, targetColumns) {
    if (targetColumns) {
      const padding = 24;
      const gapSize = 8;
      const totalGap = (targetColumns - 1) * gapSize;
      const availableWidth = containerWidth - padding - totalGap;
      return Math.floor(availableWidth / targetColumns);
    }
    const result = this.calculateLayout({
      count,
      containerWidth,
      containerHeight
    });
    return result.optionSize;
  }
  /**
   * Get grid gap for given parameters
   */
  static calculateGridGap(count, containerWidth, containerHeight) {
    const result = this.calculateLayout({
      count,
      containerWidth,
      containerHeight
    });
    return result.gridGap;
  }
  /**
   * Clear the layout calculation cache
   */
  static clearCache() {
    this.lastCalculationKey = "";
    this.lastCalculationResult = null;
  }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk9wdGlvblBpY2tlckxheW91dE1hbmFnZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBPcHRpb25QaWNrZXJMYXlvdXRNYW5hZ2VyIC0gU29waGlzdGljYXRlZCBsYXlvdXQgY2FsY3VsYXRpb25zIHVzaW5nIHRoZSBhZHZhbmNlZCBsYXlvdXQgc3lzdGVtXG4gKlxuICogUmVwbGFjZXMgdGhlIHNpbXBsZSBsYXlvdXQgY2FsY3VsYXRpb25zIHdpdGggdGhlIGZ1bGwgc29waGlzdGljYXRlZCBzeXN0ZW1cbiAqIGZyb20gdGhlIGxlZ2FjeSBpbXBsZW1lbnRhdGlvbiwgaW5jbHVkaW5nIGRldmljZSBkZXRlY3Rpb24sIHJlc3BvbnNpdmUgbGF5b3V0cyxcbiAqIGFuZCBwZXJmb3JtYW5jZSBvcHRpbWl6YXRpb25zLlxuICovXG5cbmltcG9ydCB7XG4gIGdldENvbnRhaW5lckFzcGVjdCxcbiAgdHlwZSBDb250YWluZXJBc3BlY3QsXG4gIHR5cGUgRGV2aWNlVHlwZSxcbiAgdHlwZSBSZXNwb25zaXZlTGF5b3V0Q29uZmlnLFxufSBmcm9tIFwiLi9jb25maWdcIjtcbmltcG9ydCB7XG4gIGRldGVjdEZvbGRhYmxlRGV2aWNlLFxuICB0eXBlIEZvbGRhYmxlRGV0ZWN0aW9uUmVzdWx0LFxufSBmcm9tIFwiLi91dGlscy9kZXZpY2VEZXRlY3Rpb25cIjtcbmltcG9ydCB7XG4gIGdldEVuaGFuY2VkRGV2aWNlVHlwZSxcbiAgZ2V0UmVzcG9uc2l2ZUxheW91dCxcbn0gZnJvbSBcIi4vdXRpbHMvbGF5b3V0VXRpbHNcIjtcblxuZXhwb3J0IGludGVyZmFjZSBMYXlvdXRDYWxjdWxhdGlvblBhcmFtcyB7XG4gIGNvdW50OiBudW1iZXI7XG4gIGNvbnRhaW5lcldpZHRoOiBudW1iZXI7XG4gIGNvbnRhaW5lckhlaWdodDogbnVtYmVyO1xuICB3aW5kb3dXaWR0aD86IG51bWJlcjtcbiAgd2luZG93SGVpZ2h0PzogbnVtYmVyO1xuICBpc01vYmlsZVVzZXJBZ2VudD86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGF5b3V0Q2FsY3VsYXRpb25SZXN1bHQge1xuICBvcHRpb25zUGVyUm93OiBudW1iZXI7XG4gIG9wdGlvblNpemU6IG51bWJlcjtcbiAgZ3JpZEdhcDogc3RyaW5nO1xuICBncmlkQ29sdW1uczogc3RyaW5nO1xuICBncmlkQ2xhc3M6IHN0cmluZztcbiAgYXNwZWN0Q2xhc3M6IHN0cmluZztcbiAgc2NhbGVGYWN0b3I6IG51bWJlcjtcbiAgZGV2aWNlVHlwZTogRGV2aWNlVHlwZTtcbiAgY29udGFpbmVyQXNwZWN0OiBDb250YWluZXJBc3BlY3Q7XG4gIGlzTW9iaWxlOiBib29sZWFuO1xuICBpc1RhYmxldDogYm9vbGVhbjtcbiAgaXNQb3J0cmFpdDogYm9vbGVhbjtcbiAgZm9sZGFibGVJbmZvOiBGb2xkYWJsZURldGVjdGlvblJlc3VsdDtcbiAgbGF5b3V0Q29uZmlnOiBSZXNwb25zaXZlTGF5b3V0Q29uZmlnO1xufVxuXG5leHBvcnQgY2xhc3MgT3B0aW9uUGlja2VyTGF5b3V0TWFuYWdlciB7XG4gIHByaXZhdGUgc3RhdGljIGxhc3RDYWxjdWxhdGlvbktleTogc3RyaW5nID0gXCJcIjtcbiAgcHJpdmF0ZSBzdGF0aWMgbGFzdENhbGN1bGF0aW9uUmVzdWx0OiBMYXlvdXRDYWxjdWxhdGlvblJlc3VsdCB8IG51bGwgPSBudWxsO1xuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgc29waGlzdGljYXRlZCByZXNwb25zaXZlIGxheW91dCB1c2luZyB0aGUgYWR2YW5jZWQgbGF5b3V0IHN5c3RlbVxuICAgKi9cbiAgc3RhdGljIGNhbGN1bGF0ZUxheW91dChcbiAgICBwYXJhbXM6IExheW91dENhbGN1bGF0aW9uUGFyYW1zXG4gICk6IExheW91dENhbGN1bGF0aW9uUmVzdWx0IHtcbiAgICBjb25zdCB7XG4gICAgICBjb3VudCxcbiAgICAgIGNvbnRhaW5lcldpZHRoLFxuICAgICAgY29udGFpbmVySGVpZ2h0LFxuICAgICAgd2luZG93V2lkdGggPSBjb250YWluZXJXaWR0aCxcbiAgICAgIHdpbmRvd0hlaWdodCA9IGNvbnRhaW5lckhlaWdodCxcbiAgICAgIGlzTW9iaWxlVXNlckFnZW50ID0gZmFsc2UsXG4gICAgfSA9IHBhcmFtcztcblxuICAgIC8vIENyZWF0ZSBhIGNhY2hlIGtleSBmb3IgdGhpcyBjYWxjdWxhdGlvblxuICAgIGNvbnN0IGNhY2hlS2V5ID0gYCR7Y291bnR9OiR7Y29udGFpbmVyV2lkdGh9OiR7Y29udGFpbmVySGVpZ2h0fToke3dpbmRvd1dpZHRofToke3dpbmRvd0hlaWdodH06JHtpc01vYmlsZVVzZXJBZ2VudH1gO1xuXG4gICAgLy8gUmV0dXJuIGNhY2hlZCByZXN1bHQgaWYgdGhlIHBhcmFtZXRlcnMgaGF2ZW4ndCBjaGFuZ2VkXG4gICAgaWYgKHRoaXMubGFzdENhbGN1bGF0aW9uS2V5ID09PSBjYWNoZUtleSAmJiB0aGlzLmxhc3RDYWxjdWxhdGlvblJlc3VsdCkge1xuICAgICAgcmV0dXJuIHRoaXMubGFzdENhbGN1bGF0aW9uUmVzdWx0O1xuICAgIH1cblxuICAgIC8vIERldGVjdCBmb2xkYWJsZSBkZXZpY2VcbiAgICBjb25zdCBmb2xkYWJsZUluZm8gPSBkZXRlY3RGb2xkYWJsZURldmljZSgpO1xuXG4gICAgLy8gR2V0IGVuaGFuY2VkIGRldmljZSBpbmZvcm1hdGlvblxuICAgIGNvbnN0IGVuaGFuY2VkRGV2aWNlSW5mbyA9IGdldEVuaGFuY2VkRGV2aWNlVHlwZShcbiAgICAgIGNvbnRhaW5lcldpZHRoLFxuICAgICAgaXNNb2JpbGVVc2VyQWdlbnRcbiAgICApO1xuICAgIGNvbnN0IGRldmljZVR5cGUgPSBlbmhhbmNlZERldmljZUluZm8uZGV2aWNlVHlwZTtcbiAgICBjb25zdCBpc01vYmlsZSA9IGRldmljZVR5cGUgPT09IFwic21hbGxNb2JpbGVcIiB8fCBkZXZpY2VUeXBlID09PSBcIm1vYmlsZVwiO1xuICAgIGNvbnN0IGlzVGFibGV0ID0gZGV2aWNlVHlwZSA9PT0gXCJ0YWJsZXRcIjtcbiAgICBjb25zdCBpc1BvcnRyYWl0ID0gY29udGFpbmVySGVpZ2h0ID4gY29udGFpbmVyV2lkdGg7XG4gICAgY29uc3QgY29udGFpbmVyQXNwZWN0ID0gZ2V0Q29udGFpbmVyQXNwZWN0KGNvbnRhaW5lcldpZHRoLCBjb250YWluZXJIZWlnaHQpO1xuXG4gICAgLy8gR2V0IHRoZSBzb3BoaXN0aWNhdGVkIHJlc3BvbnNpdmUgbGF5b3V0IGNvbmZpZ3VyYXRpb25cbiAgICBjb25zdCBsYXlvdXRDb25maWcgPSBnZXRSZXNwb25zaXZlTGF5b3V0KFxuICAgICAgY291bnQsXG4gICAgICBjb250YWluZXJIZWlnaHQsXG4gICAgICBjb250YWluZXJXaWR0aCxcbiAgICAgIGlzTW9iaWxlLFxuICAgICAgaXNQb3J0cmFpdCxcbiAgICAgIGZvbGRhYmxlSW5mb1xuICAgICk7XG5cbiAgICAvLyBFeHRyYWN0IGdyaWQgY29sdW1ucyBjb3VudCBmcm9tIHRoZSBDU1MgZ3JpZCB0ZW1wbGF0ZVxuICAgIGNvbnN0IGNvbHVtbnNNYXRjaCA9IGxheW91dENvbmZpZy5ncmlkQ29sdW1ucy5tYXRjaCgvcmVwZWF0XFwoKFxcZCspLC8pO1xuICAgIGNvbnN0IG9wdGlvbnNQZXJSb3cgPVxuICAgICAgY29sdW1uc01hdGNoICYmIGNvbHVtbnNNYXRjaFsxXSA/IHBhcnNlSW50KGNvbHVtbnNNYXRjaFsxXSwgMTApIDogNDtcblxuICAgIC8vIFBhcnNlIG9wdGlvbiBzaXplIChyZW1vdmUgJ3B4JyBzdWZmaXgpXG4gICAgY29uc3Qgb3B0aW9uU2l6ZU1hdGNoID0gbGF5b3V0Q29uZmlnLm9wdGlvblNpemUubWF0Y2goLyhcXGQrKXB4Lyk7XG4gICAgY29uc3Qgb3B0aW9uU2l6ZSA9XG4gICAgICBvcHRpb25TaXplTWF0Y2ggJiYgb3B0aW9uU2l6ZU1hdGNoWzFdXG4gICAgICAgID8gcGFyc2VJbnQob3B0aW9uU2l6ZU1hdGNoWzFdLCAxMClcbiAgICAgICAgOiAxMDA7XG5cbiAgICBjb25zdCByZXN1bHQ6IExheW91dENhbGN1bGF0aW9uUmVzdWx0ID0ge1xuICAgICAgb3B0aW9uc1BlclJvdyxcbiAgICAgIG9wdGlvblNpemUsXG4gICAgICBncmlkR2FwOiBsYXlvdXRDb25maWcuZ3JpZEdhcCxcbiAgICAgIGdyaWRDb2x1bW5zOiBsYXlvdXRDb25maWcuZ3JpZENvbHVtbnMsXG4gICAgICBncmlkQ2xhc3M6IGxheW91dENvbmZpZy5ncmlkQ2xhc3MsXG4gICAgICBhc3BlY3RDbGFzczogbGF5b3V0Q29uZmlnLmFzcGVjdENsYXNzLFxuICAgICAgc2NhbGVGYWN0b3I6IGxheW91dENvbmZpZy5zY2FsZUZhY3RvcixcbiAgICAgIGRldmljZVR5cGUsXG4gICAgICBjb250YWluZXJBc3BlY3QsXG4gICAgICBpc01vYmlsZSxcbiAgICAgIGlzVGFibGV0LFxuICAgICAgaXNQb3J0cmFpdCxcbiAgICAgIGZvbGRhYmxlSW5mbyxcbiAgICAgIGxheW91dENvbmZpZyxcbiAgICB9O1xuXG4gICAgLy8gQ2FjaGUgdGhlIHJlc3VsdFxuICAgIHRoaXMubGFzdENhbGN1bGF0aW9uS2V5ID0gY2FjaGVLZXk7XG4gICAgdGhpcy5sYXN0Q2FsY3VsYXRpb25SZXN1bHQgPSByZXN1bHQ7XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIExlZ2FjeSBjb21wYXRpYmlsaXR5IG1ldGhvZCAtIHNpbXBsaWZpZWQgaW50ZXJmYWNlXG4gICAqL1xuICBzdGF0aWMgY2FsY3VsYXRlU2ltcGxlTGF5b3V0KGNvbnRhaW5lcldpZHRoOiBudW1iZXIpOiB7XG4gICAgb3B0aW9uc1BlclJvdzogbnVtYmVyO1xuICAgIG9wdGlvblNpemU6IG51bWJlcjtcbiAgfSB7XG4gICAgY29uc3QgcmVzdWx0ID0gdGhpcy5jYWxjdWxhdGVMYXlvdXQoe1xuICAgICAgY291bnQ6IDEwLCAvLyBEZWZhdWx0IGNvdW50IGZvciBsZWdhY3kgY29tcGF0aWJpbGl0eVxuICAgICAgY29udGFpbmVyV2lkdGgsXG4gICAgICBjb250YWluZXJIZWlnaHQ6IDYwMCwgLy8gRGVmYXVsdCBoZWlnaHRcbiAgICB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICBvcHRpb25zUGVyUm93OiByZXN1bHQub3B0aW9uc1BlclJvdyxcbiAgICAgIG9wdGlvblNpemU6IHJlc3VsdC5vcHRpb25TaXplLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogR2V0IHJlc3BvbnNpdmUgbGF5b3V0IGNvbmZpZ3VyYXRpb24gZm9yIGEgc3BlY2lmaWMgY291bnQgYW5kIGNvbnRhaW5lciBkaW1lbnNpb25zXG4gICAqL1xuICBzdGF0aWMgZ2V0UmVzcG9uc2l2ZUNvbmZpZyhcbiAgICBjb3VudDogbnVtYmVyLFxuICAgIGNvbnRhaW5lcldpZHRoOiBudW1iZXIsXG4gICAgY29udGFpbmVySGVpZ2h0OiBudW1iZXJcbiAgKTogUmVzcG9uc2l2ZUxheW91dENvbmZpZyB7XG4gICAgY29uc3QgcmVzdWx0ID0gdGhpcy5jYWxjdWxhdGVMYXlvdXQoe1xuICAgICAgY291bnQsXG4gICAgICBjb250YWluZXJXaWR0aCxcbiAgICAgIGNvbnRhaW5lckhlaWdodCxcbiAgICB9KTtcblxuICAgIHJldHVybiByZXN1bHQubGF5b3V0Q29uZmlnO1xuICB9XG5cbiAgLyoqXG4gICAqIERldGVybWluZSBpZiB0aGUgY3VycmVudCBsYXlvdXQgc2hvdWxkIHVzZSBtb2JpbGUgb3B0aW1pemF0aW9uc1xuICAgKi9cbiAgc3RhdGljIHNob3VsZFVzZU1vYmlsZUxheW91dChcbiAgICBjb250YWluZXJXaWR0aDogbnVtYmVyLFxuICAgIF9pc01vYmlsZVVzZXJBZ2VudD86IGJvb2xlYW5cbiAgKTogYm9vbGVhbiB7XG4gICAgY29uc3QgcmVzdWx0ID0gdGhpcy5jYWxjdWxhdGVMYXlvdXQoe1xuICAgICAgY291bnQ6IDEsIC8vIE1pbmltYWwgY291bnQgZm9yIGRldmljZSBkZXRlY3Rpb25cbiAgICAgIGNvbnRhaW5lcldpZHRoLFxuICAgICAgY29udGFpbmVySGVpZ2h0OiA0MDAsIC8vIERlZmF1bHQgaGVpZ2h0IGZvciBkZXRlY3Rpb25cbiAgICB9KTtcblxuICAgIHJldHVybiByZXN1bHQuaXNNb2JpbGU7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGRldmljZSBpbmZvcm1hdGlvbiBmb3IgdGhlIGN1cnJlbnQgY29udGFpbmVyIGRpbWVuc2lvbnNcbiAgICovXG4gIHN0YXRpYyBnZXREZXZpY2VJbmZvKGNvbnRhaW5lcldpZHRoOiBudW1iZXIsIF9pc01vYmlsZVVzZXJBZ2VudD86IGJvb2xlYW4pIHtcbiAgICBjb25zdCByZXN1bHQgPSB0aGlzLmNhbGN1bGF0ZUxheW91dCh7XG4gICAgICBjb3VudDogMSxcbiAgICAgIGNvbnRhaW5lcldpZHRoLFxuICAgICAgY29udGFpbmVySGVpZ2h0OiA0MDAsXG4gICAgfSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgZGV2aWNlVHlwZTogcmVzdWx0LmRldmljZVR5cGUsXG4gICAgICBpc01vYmlsZTogcmVzdWx0LmlzTW9iaWxlLFxuICAgICAgaXNUYWJsZXQ6IHJlc3VsdC5pc1RhYmxldCxcbiAgICAgIGZvbGRhYmxlSW5mbzogcmVzdWx0LmZvbGRhYmxlSW5mbyxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSBvcHRpbWFsIG9wdGlvbiBzaXplIGZvciBnaXZlbiBwYXJhbWV0ZXJzXG4gICAqL1xuICBzdGF0aWMgY2FsY3VsYXRlT3B0aW1hbE9wdGlvblNpemUoXG4gICAgY291bnQ6IG51bWJlcixcbiAgICBjb250YWluZXJXaWR0aDogbnVtYmVyLFxuICAgIGNvbnRhaW5lckhlaWdodDogbnVtYmVyLFxuICAgIHRhcmdldENvbHVtbnM/OiBudW1iZXJcbiAgKTogbnVtYmVyIHtcbiAgICBpZiAodGFyZ2V0Q29sdW1ucykge1xuICAgICAgLy8gSWYgc3BlY2lmaWMgY29sdW1uIGNvdW50IGlzIHJlcXVlc3RlZCwgY2FsY3VsYXRlIGRpcmVjdGx5XG4gICAgICBjb25zdCBwYWRkaW5nID0gMjQ7IC8vIFRvdGFsIGhvcml6b250YWwgcGFkZGluZ1xuICAgICAgY29uc3QgZ2FwU2l6ZSA9IDg7IC8vIEVzdGltYXRlZCBnYXAgc2l6ZVxuICAgICAgY29uc3QgdG90YWxHYXAgPSAodGFyZ2V0Q29sdW1ucyAtIDEpICogZ2FwU2l6ZTtcbiAgICAgIGNvbnN0IGF2YWlsYWJsZVdpZHRoID0gY29udGFpbmVyV2lkdGggLSBwYWRkaW5nIC0gdG90YWxHYXA7XG4gICAgICByZXR1cm4gTWF0aC5mbG9vcihhdmFpbGFibGVXaWR0aCAvIHRhcmdldENvbHVtbnMpO1xuICAgIH1cblxuICAgIC8vIFVzZSB0aGUgc29waGlzdGljYXRlZCBsYXlvdXQgc3lzdGVtXG4gICAgY29uc3QgcmVzdWx0ID0gdGhpcy5jYWxjdWxhdGVMYXlvdXQoe1xuICAgICAgY291bnQsXG4gICAgICBjb250YWluZXJXaWR0aCxcbiAgICAgIGNvbnRhaW5lckhlaWdodCxcbiAgICB9KTtcblxuICAgIHJldHVybiByZXN1bHQub3B0aW9uU2l6ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZ3JpZCBnYXAgZm9yIGdpdmVuIHBhcmFtZXRlcnNcbiAgICovXG4gIHN0YXRpYyBjYWxjdWxhdGVHcmlkR2FwKFxuICAgIGNvdW50OiBudW1iZXIsXG4gICAgY29udGFpbmVyV2lkdGg6IG51bWJlcixcbiAgICBjb250YWluZXJIZWlnaHQ6IG51bWJlclxuICApOiBzdHJpbmcge1xuICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuY2FsY3VsYXRlTGF5b3V0KHtcbiAgICAgIGNvdW50LFxuICAgICAgY29udGFpbmVyV2lkdGgsXG4gICAgICBjb250YWluZXJIZWlnaHQsXG4gICAgfSk7XG5cbiAgICByZXR1cm4gcmVzdWx0LmdyaWRHYXA7XG4gIH1cblxuICAvKipcbiAgICogQ2xlYXIgdGhlIGxheW91dCBjYWxjdWxhdGlvbiBjYWNoZVxuICAgKi9cbiAgc3RhdGljIGNsZWFyQ2FjaGUoKSB7XG4gICAgdGhpcy5sYXN0Q2FsY3VsYXRpb25LZXkgPSBcIlwiO1xuICAg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