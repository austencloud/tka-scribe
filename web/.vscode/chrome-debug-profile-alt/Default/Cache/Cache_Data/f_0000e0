import {
  IApplicationInitializationServiceInterface,
  IArrowRenderingServiceInterface,
  IConstructTabCoordinationServiceInterface,
  IDeviceDetectionServiceInterface,
  IExportServiceInterface,
  IGridRenderingServiceInterface,
  IMotionGenerationServiceInterface,
  IOrientationCalculationServiceInterface,
  IOverlayRenderingServiceInterface,
  IPanelManagementServiceInterface,
  IPersistenceServiceInterface,
  IPictographRenderingServiceInterface,
  IPictographServiceInterface,
  IPropCoordinatorServiceInterface,
  ISequenceDomainServiceInterface,
  ISequenceGenerationServiceInterface,
  ISequenceServiceInterface,
  ISettingsServiceInterface,
  IStartPositionServiceInterface,
  ISvgConfigurationInterface,
  ISvgUtilityServiceInterface,
  IPrintablePageLayoutServiceInterface,
  IPageFactoryServiceInterface,
  IPageImageExportServiceInterface,
  ISequenceCardExportIntegrationServiceInterface,
  IDataTransformationServiceInterface,
  IStartPositionSelectionServiceInterface
} from "/src/lib/services/di/interfaces/core-interfaces.ts";
import { ILetterQueryServiceInterface } from "/src/lib/services/di/interfaces/codex-interfaces.ts";
import { ApplicationInitializationService } from "/src/lib/services/implementations/application/ApplicationInitializationService.ts";
import { ConstructTabCoordinationService } from "/src/lib/services/implementations/construct/ConstructTabCoordinationService.ts";
import { PictographRenderingService } from "/src/lib/services/implementations/rendering/PictographRenderingService.ts";
import { SequenceService } from "/src/lib/services/implementations/sequence/SequenceService.ts";
import { SequenceGenerationService } from "/src/lib/services/implementations/generation/SequenceGenerationService.ts";
import { IArrowPositioningOrchestratorInterface } from "/src/lib/services/di/interfaces/positioning-interfaces.ts";
export async function registerCoreServices(container) {
  container.registerSingletonClass(ISequenceDomainServiceInterface);
  container.registerSingletonClass(IPersistenceServiceInterface);
  container.registerSingletonClass(ISettingsServiceInterface);
  container.registerSingletonClass(IDeviceDetectionServiceInterface);
  container.registerSingletonClass(IPanelManagementServiceInterface);
  container.registerSingletonClass(IStartPositionServiceInterface);
  container.registerSingletonClass(IStartPositionSelectionServiceInterface);
  container.registerSingletonClass(ISvgConfigurationInterface);
  container.registerSingletonClass(ISvgUtilityServiceInterface);
  container.registerSingletonClass(IDataTransformationServiceInterface);
  container.registerSingletonClass(IGridRenderingServiceInterface);
  container.registerSingletonClass(IArrowRenderingServiceInterface);
  container.registerSingletonClass(IOverlayRenderingServiceInterface);
  container.registerSingletonClass(IPropCoordinatorServiceInterface);
  container.registerFactory(ISequenceServiceInterface, () => {
    const sequenceDomainService = container.resolve(
      ISequenceDomainServiceInterface
    );
    const persistenceService = container.resolve(IPersistenceServiceInterface);
    return new SequenceService(sequenceDomainService, persistenceService);
  });
  container.registerFactory(IConstructTabCoordinationServiceInterface, () => {
    const sequenceService = container.resolve(ISequenceServiceInterface);
    const startPositionService = container.resolve(
      IStartPositionServiceInterface
    );
    return new ConstructTabCoordinationService(
      sequenceService,
      startPositionService
    );
  });
  container.registerFactory(IPictographRenderingServiceInterface, () => {
    const arrowPositioning = container.resolve(
      IArrowPositioningOrchestratorInterface
    );
    const svgUtility = container.resolve(ISvgUtilityServiceInterface);
    const gridRendering = container.resolve(IGridRenderingServiceInterface);
    const arrowRendering = container.resolve(IArrowRenderingServiceInterface);
    const overlayRendering = container.resolve(
      IOverlayRenderingServiceInterface
    );
    const dataTransformation = container.resolve(
      IDataTransformationServiceInterface
    );
    return new PictographRenderingService(
      arrowPositioning,
      null,
      // âœ… FIXED: PropRenderingService is deprecated, pass null
      svgUtility,
      gridRendering,
      arrowRendering,
      overlayRendering,
      dataTransformation
    );
  });
  container.registerSingletonClass(IPictographServiceInterface);
  container.registerSingletonClass(IExportServiceInterface);
  container.registerSingletonClass(IMotionGenerationServiceInterface);
  container.registerSingletonClass(IOrientationCalculationServiceInterface);
  container.registerFactory(ISequenceGenerationServiceInterface, () => {
    const letterQueryService = container.resolve(ILetterQueryServiceInterface);
    const orientationCalculationService = container.resolve(
      IOrientationCalculationServiceInterface
    );
    return new SequenceGenerationService(
      letterQueryService,
      orientationCalculationService
    );
  });
  container.registerSingletonClass(IPrintablePageLayoutServiceInterface);
  container.registerSingletonClass(IPageImageExportServiceInterface);
  container.registerFactory(IPageFactoryServiceInterface, () => {
    const layoutService = container.resolve(
      IPrintablePageLayoutServiceInterface
    );
    return new IPageFactoryServiceInterface.implementation(layoutService);
  });
  container.registerFactory(
    ISequenceCardExportIntegrationServiceInterface,
    () => {
      const pageImageExportService = container.resolve(
        IPageImageExportServiceInterface
      );
      return new ISequenceCardExportIntegrationServiceInterface.implementation(
        pageImageExportService
      );
    }
  );
  container.registerFactory(IApplicationInitializationServiceInterface, () => {
    const settingsService = container.resolve(ISettingsServiceInterface);
    const persistenceService = container.resolve(IPersistenceServiceInterface);
    return new ApplicationInitializationService(
      settingsService,
      persistenceService
    );
  });
}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiQzovVEtBL3dlYi9zcmMvbGliL3NlcnZpY2VzL2RpL3JlZ2lzdHJhdGlvbi9jb3JlLXNlcnZpY2VzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyIvKipcbiAqIENvcmUgU2VydmljZXMgUmVnaXN0cmF0aW9uXG4gKiBIYW5kbGVzIHJlZ2lzdHJhdGlvbiBvZiBjb3JlIGJ1c2luZXNzIGxvZ2ljIGFuZCBpbmZyYXN0cnVjdHVyZSBzZXJ2aWNlc1xuICovXG5cbmltcG9ydCB0eXBlIHsgU2VydmljZUNvbnRhaW5lciB9IGZyb20gXCIuLi9TZXJ2aWNlQ29udGFpbmVyXCI7XG5pbXBvcnQge1xuICBJQXBwbGljYXRpb25Jbml0aWFsaXphdGlvblNlcnZpY2VJbnRlcmZhY2UsXG4gIElBcnJvd1JlbmRlcmluZ1NlcnZpY2VJbnRlcmZhY2UsXG4gIElDb25zdHJ1Y3RUYWJDb29yZGluYXRpb25TZXJ2aWNlSW50ZXJmYWNlLFxuICBJRGV2aWNlRGV0ZWN0aW9uU2VydmljZUludGVyZmFjZSxcbiAgSUV4cG9ydFNlcnZpY2VJbnRlcmZhY2UsXG4gIElHcmlkUmVuZGVyaW5nU2VydmljZUludGVyZmFjZSxcbiAgSU1vdGlvbkdlbmVyYXRpb25TZXJ2aWNlSW50ZXJmYWNlLFxuICBJT3JpZW50YXRpb25DYWxjdWxhdGlvblNlcnZpY2VJbnRlcmZhY2UsXG4gIElPdmVybGF5UmVuZGVyaW5nU2VydmljZUludGVyZmFjZSxcbiAgSVBhbmVsTWFuYWdlbWVudFNlcnZpY2VJbnRlcmZhY2UsXG4gIElQZXJzaXN0ZW5jZVNlcnZpY2VJbnRlcmZhY2UsXG4gIElQaWN0b2dyYXBoUmVuZGVyaW5nU2VydmljZUludGVyZmFjZSxcbiAgSVBpY3RvZ3JhcGhTZXJ2aWNlSW50ZXJmYWNlLFxuICAvLyDinIUgUkVNT1ZFRDogUHJvcFJlbmRlcmluZ1NlcnZpY2UgaXMgZGVwcmVjYXRlZFxuICBJUHJvcENvb3JkaW5hdG9yU2VydmljZUludGVyZmFjZSxcbiAgSVNlcXVlbmNlRG9tYWluU2VydmljZUludGVyZmFjZSxcbiAgSVNlcXVlbmNlR2VuZXJhdGlvblNlcnZpY2VJbnRlcmZhY2UsXG4gIElTZXF1ZW5jZVNlcnZpY2VJbnRlcmZhY2UsXG4gIElTZXR0aW5nc1NlcnZpY2VJbnRlcmZhY2UsXG4gIElTdGFydFBvc2l0aW9uU2VydmljZUludGVyZmFjZSxcbiAgSVN2Z0NvbmZpZ3VyYXRpb25JbnRlcmZhY2UsXG4gIElTdmdVdGlsaXR5U2VydmljZUludGVyZmFjZSxcbiAgSVByaW50YWJsZVBhZ2VMYXlvdXRTZXJ2aWNlSW50ZXJmYWNlLFxuICBJUGFnZUZhY3RvcnlTZXJ2aWNlSW50ZXJmYWNlLFxuICBJUGFnZUltYWdlRXhwb3J0U2VydmljZUludGVyZmFjZSxcbiAgSVNlcXVlbmNlQ2FyZEV4cG9ydEludGVncmF0aW9uU2VydmljZUludGVyZmFjZSxcbiAgSURhdGFUcmFuc2Zvcm1hdGlvblNlcnZpY2VJbnRlcmZhY2UsXG4gIElTdGFydFBvc2l0aW9uU2VsZWN0aW9uU2VydmljZUludGVyZmFjZSxcbn0gZnJvbSBcIi4uL2ludGVyZmFjZXMvY29yZS1pbnRlcmZhY2VzXCI7XG5pbXBvcnQgeyBJTGV0dGVyUXVlcnlTZXJ2aWNlSW50ZXJmYWNlIH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvY29kZXgtaW50ZXJmYWNlc1wiO1xuXG5pbXBvcnQgeyBBcHBsaWNhdGlvbkluaXRpYWxpemF0aW9uU2VydmljZSB9IGZyb20gXCIuLi8uLi9pbXBsZW1lbnRhdGlvbnMvYXBwbGljYXRpb24vQXBwbGljYXRpb25Jbml0aWFsaXphdGlvblNlcnZpY2VcIjtcbmltcG9ydCB7IENvbnN0cnVjdFRhYkNvb3JkaW5hdGlvblNlcnZpY2UgfSBmcm9tIFwiLi4vLi4vaW1wbGVtZW50YXRpb25zL2NvbnN0cnVjdC9Db25zdHJ1Y3RUYWJDb29yZGluYXRpb25TZXJ2aWNlXCI7XG5pbXBvcnQgeyBQaWN0b2dyYXBoUmVuZGVyaW5nU2VydmljZSB9IGZyb20gXCIuLi8uLi9pbXBsZW1lbnRhdGlvbnMvcmVuZGVyaW5nL1BpY3RvZ3JhcGhSZW5kZXJpbmdTZXJ2aWNlXCI7XG5pbXBvcnQgeyBTZXF1ZW5jZVNlcnZpY2UgfSBmcm9tIFwiLi4vLi4vaW1wbGVtZW50YXRpb25zL3NlcXVlbmNlL1NlcXVlbmNlU2VydmljZVwiO1xuaW1wb3J0IHsgU2VxdWVuY2VHZW5lcmF0aW9uU2VydmljZSB9IGZyb20gXCIuLi8uLi9pbXBsZW1lbnRhdGlvbnMvZ2VuZXJhdGlvbi9TZXF1ZW5jZUdlbmVyYXRpb25TZXJ2aWNlXCI7XG5cbmltcG9ydCB7IElBcnJvd1Bvc2l0aW9uaW5nT3JjaGVzdHJhdG9ySW50ZXJmYWNlIH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvcG9zaXRpb25pbmctaW50ZXJmYWNlc1wiO1xuaW1wb3J0IHR5cGUgeyBJQXJyb3dQb3NpdGlvbmluZ09yY2hlc3RyYXRvciB9IGZyb20gXCIuLi8uLi9wb3NpdGlvbmluZy9jb3JlLXNlcnZpY2VzXCI7XG5cbi8qKlxuICogUmVnaXN0ZXIgYWxsIGNvcmUgc2VydmljZXMgd2l0aCB0aGVpciBkZXBlbmRlbmNpZXNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlZ2lzdGVyQ29yZVNlcnZpY2VzKFxuICBjb250YWluZXI6IFNlcnZpY2VDb250YWluZXJcbik6IFByb21pc2U8dm9pZD4ge1xuICAvLyBSZWdpc3RlciBkb21haW4gc2VydmljZXMgKG5vIGRlcGVuZGVuY2llcylcbiAgY29udGFpbmVyLnJlZ2lzdGVyU2luZ2xldG9uQ2xhc3MoSVNlcXVlbmNlRG9tYWluU2VydmljZUludGVyZmFjZSk7XG5cbiAgLy8gUmVnaXN0ZXIgaW5mcmFzdHJ1Y3R1cmUgc2VydmljZXNcbiAgY29udGFpbmVyLnJlZ2lzdGVyU2luZ2xldG9uQ2xhc3MoSVBlcnNpc3RlbmNlU2VydmljZUludGVyZmFjZSk7XG4gIGNvbnRhaW5lci5yZWdpc3RlclNpbmdsZXRvbkNsYXNzKElTZXR0aW5nc1NlcnZpY2VJbnRlcmZhY2UpO1xuICBjb250YWluZXIucmVnaXN0ZXJTaW5nbGV0b25DbGFzcyhJRGV2aWNlRGV0ZWN0aW9uU2VydmljZUludGVyZmFjZSk7XG4gIGNvbnRhaW5lci5yZWdpc3RlclNpbmdsZXRvbkNsYXNzKElQYW5lbE1hbmFnZW1lbnRTZXJ2aWNlSW50ZXJmYWNlKTtcblxuICAvLyBSZWdpc3RlciBjb25zdHJ1Y3QgdGFiIHNlcnZpY2VzXG4gIGNvbnRhaW5lci5yZWdpc3RlclNpbmdsZXRvbkNsYXNzKElTdGFydFBvc2l0aW9uU2VydmljZUludGVyZmFjZSk7XG4gIGNvbnRhaW5lci5yZWdpc3RlclNpbmdsZXRvbkNsYXNzKElTdGFydFBvc2l0aW9uU2VsZWN0aW9uU2VydmljZUludGVyZmFjZSk7XG5cbiAgLy8gUmVnaXN0ZXIgcmVuZGVyaW5nIG1pY3Jvc2VydmljZXMgKGluIGRlcGVuZGVuY3kgb3JkZXIpXG4gIGNvbnRhaW5lci5yZWdpc3RlclNpbmdsZXRvbkNsYXNzKElTdmdDb25maWd1cmF0aW9uSW50ZXJmYWNlKTtcbiAgY29udGFpbmVyLnJlZ2lzdGVyU2luZ2xldG9uQ2xhc3MoSVN2Z1V0aWxpdHlTZXJ2aWNlSW50ZXJmYWNlKTtcbiAgY29udGFpbmVyLnJlZ2lzdGVyU2luZ2xldG9uQ2xhc3MoSURhdGFUcmFuc2Zvcm1hdGlvblNlcnZpY2VJbnRlcmZhY2UpO1xuICBjb250YWluZXIucmVnaXN0ZXJTaW5nbGV0b25DbGFzcyhJR3JpZFJlbmRlcmluZ1NlcnZpY2VJbnRlcmZhY2UpO1xuICBjb250YWluZXIucmVnaXN0ZXJTaW5nbGV0b25DbGFzcyhJQXJyb3dSZW5kZXJpbmdTZXJ2aWNlSW50ZXJmYWNlKTtcbiAgY29udGFpbmVyLnJlZ2lzdGVyU2luZ2xldG9uQ2xhc3MoSU92ZXJsYXlSZW5kZXJpbmdTZXJ2aWNlSW50ZXJmYWNlKTtcblxuICAvLyBSZWdpc3RlciBtYWluIHJlbmRlcmluZyBzZXJ2aWNlc1xuICAvLyDinIUgUkVNT1ZFRDogUHJvcFJlbmRlcmluZ1NlcnZpY2UgaXMgZGVwcmVjYXRlZFxuICBjb250YWluZXIucmVnaXN0ZXJTaW5nbGV0b25DbGFzcyhJUHJvcENvb3JkaW5hdG9yU2VydmljZUludGVyZmFjZSk7XG5cbiAgLy8gUmVnaXN0ZXIgc2VydmljZXMgd2l0aCBkZXBlbmRlbmNpZXMgdXNpbmcgZmFjdG9yaWVzXG4gIGNvbnRhaW5lci5yZWdpc3RlckZhY3RvcnkoSVNlcXVlbmNlU2VydmljZUludGVyZmFjZSwgKCkgPT4ge1xuICAgIGNvbnN0IHNlcXVlbmNlRG9tYWluU2VydmljZSA9IGNvbnRhaW5lci5yZXNvbHZlKFxuICAgICAgSVNlcXVlbmNlRG9tYWluU2VydmljZUludGVyZmFjZVxuICAgICk7XG4gICAgY29uc3QgcGVyc2lzdGVuY2VTZXJ2aWNlID0gY29udGFpbmVyLnJlc29sdmUoSVBlcnNpc3RlbmNlU2VydmljZUludGVyZmFjZSk7XG4gICAgcmV0dXJuIG5ldyBTZXF1ZW5jZVNlcnZpY2Uoc2VxdWVuY2VEb21haW5TZXJ2aWNlLCBwZXJzaXN0ZW5jZVNlcnZpY2UpO1xuICB9KTtcblxuICBjb250YWluZXIucmVnaXN0ZXJGYWN0b3J5KElDb25zdHJ1Y3RUYWJDb29yZGluYXRpb25TZXJ2aWNlSW50ZXJmYWNlLCAoKSA9PiB7XG4gICAgY29uc3Qgc2VxdWVuY2VTZXJ2aWNlID0gY29udGFpbmVyLnJlc29sdmUoSVNlcXVlbmNlU2VydmljZUludGVyZmFjZSk7XG4gICAgY29uc3Qgc3RhcnRQb3NpdGlvblNlcnZpY2UgPSBjb250YWluZXIucmVzb2x2ZShcbiAgICAgIElTdGFydFBvc2l0aW9uU2VydmljZUludGVyZmFjZVxuICAgICk7XG4gICAgcmV0dXJuIG5ldyBDb25zdHJ1Y3RUYWJDb29yZGluYXRpb25TZXJ2aWNlKFxuICAgICAgc2VxdWVuY2VTZXJ2aWNlLFxuICAgICAgc3RhcnRQb3NpdGlvblNlcnZpY2VcbiAgICApO1xuICB9KTtcblxuICAvLyBSZWdpc3RlciBwaWN0b2dyYXBoIHJlbmRlcmluZyBzZXJ2aWNlIChkZXBlbmRzIG9uIHBvc2l0aW9uaW5nIGFuZCBtaWNyb3NlcnZpY2VzKVxuICBjb250YWluZXIucmVnaXN0ZXJGYWN0b3J5KElQaWN0b2dyYXBoUmVuZGVyaW5nU2VydmljZUludGVyZmFjZSwgKCkgPT4ge1xuICAgIGNvbnN0IGFycm93UG9zaXRpb25pbmcgPSBjb250YWluZXIucmVzb2x2ZShcbiAgICAgIElBcnJvd1Bvc2l0aW9uaW5nT3JjaGVzdHJhdG9ySW50ZXJmYWNlXG4gICAgKSBhcyBJQXJyb3dQb3NpdGlvbmluZ09yY2hlc3RyYXRvcjtcbiAgICAvLyDinIUgUkVNT1ZFRDogUHJvcFJlbmRlcmluZ1NlcnZpY2UgaXMgZGVwcmVjYXRlZFxuICAgIGNvbnN0IHN2Z1V0aWxpdHkgPSBjb250YWluZXIucmVzb2x2ZShJU3ZnVXRpbGl0eVNlcnZpY2VJbnRlcmZhY2UpO1xuICAgIGNvbnN0IGdyaWRSZW5kZXJpbmcgPSBjb250YWluZXIucmVzb2x2ZShJR3JpZFJlbmRlcmluZ1NlcnZpY2VJbnRlcmZhY2UpO1xuICAgIGNvbnN0IGFycm93UmVuZGVyaW5nID0gY29udGFpbmVyLnJlc29sdmUoSUFycm93UmVuZGVyaW5nU2VydmljZUludGVyZmFjZSk7XG4gICAgY29uc3Qgb3ZlcmxheVJlbmRlcmluZyA9IGNvbnRhaW5lci5yZXNvbHZlKFxuICAgICAgSU92ZXJsYXlSZW5kZXJpbmdTZXJ2aWNlSW50ZXJmYWNlXG4gICAgKTtcbiAgICBjb25zdCBkYXRhVHJhbnNmb3JtYXRpb24gPSBjb250YWluZXIucmVzb2x2ZShcbiAgICAgIElEYXRhVHJhbnNmb3JtYXRpb25TZXJ2aWNlSW50ZXJmYWNlXG4gICAgKTtcbiAgICByZXR1cm4gbmV3IFBpY3RvZ3JhcGhSZW5kZXJpbmdTZXJ2aWNlKFxuICAgICAgYXJyb3dQb3NpdGlvbmluZyxcbiAgICAgIG51bGwsIC8vIOKchSBGSVhFRDogUHJvcFJlbmRlcmluZ1NlcnZpY2UgaXMgZGVwcmVjYXRlZCwgcGFzcyBudWxsXG4gICAgICBzdmdVdGlsaXR5LFxuICAgICAgZ3JpZFJlbmRlcmluZyxcbiAgICAgIGFycm93UmVuZGVyaW5nLFxuICAgICAgb3ZlcmxheVJlbmRlcmluZyxcbiAgICAgIGRhdGFUcmFuc2Zvcm1hdGlvblxuICAgICk7XG4gIH0pO1xuXG4gIC8vIFJlZ2lzdGVyIHBpY3RvZ3JhcGggc2VydmljZSAobm8gZGVwZW5kZW5jaWVzIGFmdGVyIHJlbmRlcmluZyBpcyByZWdpc3RlcmVkKVxuICBjb250YWluZXIucmVnaXN0ZXJTaW5nbGV0b25DbGFzcyhJUGljdG9ncmFwaFNlcnZpY2VJbnRlcmZhY2UpO1xuXG4gIC8vIFJlZ2lzdGVyIGV4cG9ydCBzZXJ2aWNlXG4gIGNvbnRhaW5lci5yZWdpc3RlclNpbmdsZXRvbkNsYXNzKElFeHBvcnRTZXJ2aWNlSW50ZXJmYWNlKTtcblxuICAvLyBSZWdpc3RlciBnZW5lcmF0aW9uIHNlcnZpY2VzXG4gIGNvbnRhaW5lci5yZWdpc3RlclNpbmdsZXRvbkNsYXNzKElNb3Rpb25HZW5lcmF0aW9uU2VydmljZUludGVyZmFjZSk7XG4gIGNvbnRhaW5lci5yZWdpc3RlclNpbmdsZXRvbkNsYXNzKElPcmllbnRhdGlvbkNhbGN1bGF0aW9uU2VydmljZUludGVyZmFjZSk7XG5cbiAgLy8gUmVnaXN0ZXIgc2VxdWVuY2UgZ2VuZXJhdGlvbiBzZXJ2aWNlIHdpdGggZGVwZW5kZW5jaWVzXG4gIGNvbnRhaW5lci5yZWdpc3RlckZhY3RvcnkoSVNlcXVlbmNlR2VuZXJhdGlvblNlcnZpY2VJbnRlcmZhY2UsICgpID0+IHtcbiAgICBjb25zdCBsZXR0ZXJRdWVyeVNlcnZpY2UgPSBjb250YWluZXIucmVzb2x2ZShJTGV0dGVyUXVlcnlTZXJ2aWNlSW50ZXJmYWNlKTtcbiAgICBjb25zdCBvcmllbnRhdGlvbkNhbGN1bGF0aW9uU2VydmljZSA9IGNvbnRhaW5lci5yZXNvbHZlKFxuICAgICAgSU9yaWVudGF0aW9uQ2FsY3VsYXRpb25TZXJ2aWNlSW50ZXJmYWNlXG4gICAgKTtcbiAgICByZXR1cm4gbmV3IFNlcXVlbmNlR2VuZXJhdGlvblNlcnZpY2UoXG4gICAgICBsZXR0ZXJRdWVyeVNlcnZpY2UsXG4gICAgICBvcmllbnRhdGlvbkNhbGN1bGF0aW9uU2VydmljZVxuICAgICk7XG4gIH0pO1xuXG4gIC8vIFJlZ2lzdGVyIHBhZ2UgbGF5b3V0IGFuZCBleHBvcnQgc2VydmljZXNcbiAgY29udGFpbmVyLnJlZ2lzdGVyU2luZ2xldG9uQ2xhc3MoSVByaW50YWJsZVBhZ2VMYXlvdXRTZXJ2aWNlSW50ZXJmYWNlKTtcbiAgY29udGFpbmVyLnJlZ2lzdGVyU2luZ2xldG9uQ2xhc3MoSVBhZ2VJbWFnZUV4cG9ydFNlcnZpY2VJbnRlcmZhY2UpO1xuXG4gIC8vIFJlZ2lzdGVyIHBhZ2UgZmFjdG9yeSBzZXJ2aWNlIHdpdGggZGVwZW5kZW5jeVxuICBjb250YWluZXIucmVnaXN0ZXJGYWN0b3J5KElQYWdlRmFjdG9yeVNlcnZpY2VJbnRlcmZhY2UsICgpID0+IHtcbiAgICBjb25zdCBsYXlvdXRTZXJ2aWNlID0gY29udGFpbmVyLnJlc29sdmUoXG4gICAgICBJUHJpbnRhYmxlUGFnZUxheW91dFNlcnZpY2VJbnRlcmZhY2VcbiAgICApO1xuICAgIHJldHVybiBuZXcgSVBhZ2VGYWN0b3J5U2VydmljZUludGVyZmFjZS5pbXBsZW1lbnRhdGlvbihsYXlvdXRTZXJ2aWNlKTtcbiAgfSk7XG5cbiAgLy8gUmVnaXN0ZXIgZXhwb3J0IGludGVncmF0aW9uIHNlcnZpY2Ugd2l0aCBkZXBlbmRlbmN5XG4gIGNvbnRhaW5lci5yZWdpc3RlckZhY3RvcnkoXG4gICAgSVNlcXVlbmNlQ2FyZEV4cG9ydEludGVncmF0aW9uU2VydmljZUludGVyZmFjZSxcbiAgICAoKSA9PiB7XG4gICAgICBjb25zdCBwYWdlSW1hZ2VFeHBvcnRTZXJ2aWNlID0gY29udGFpbmVyLnJlc29sdmUoXG4gICAgICAgIElQYWdlSW1hZ2VFeHBvcnRTZXJ2aWNlSW50ZXJmYWNlXG4gICAgICApO1xuICAgICAgcmV0dXJuIG5ldyBJU2VxdWVuY2VDYXJkRXhwb3J0SW50ZWdyYXRpb25TZXJ2aWNlSW50ZXJmYWNlLmltcGxlbWVudGF0aW9uKFxuICAgICAgICBwYWdlSW1hZ2VFeHBvcnRTZXJ2aWNlXG4gICAgICApO1xuICAgIH1cbiAgKTtcblxuICAvLyBSZWdpc3RlciBhcHBsaWNhdGlvbiBpbml0aWFsaXphdGlvbiBzZXJ2aWNlIHdpdGggZmFjdG9yeVxuICBjb250YWluZXIucmVnaXN0ZXJGYWN0b3J5KElBcHBsaWNhdGlvbkluaXRpYWxpemF0aW9uU2VydmljZUludGVyZmFjZSwgKCkgPT4ge1xuICAgIGNvbnN0IHNldHRpbmdzU2VydmljZSA9IGNvbnRhaW5lci5yZXNvbHZlKElTZXR0aW5nc1NlcnZpY2VJbnRlcmZhY2UpO1xuICAgIGNvbnN0IHBlcnNpc3RlbmNlU2VydmljZSA9IGNvbnRhaW5lci5yZXNvbHZlKElQZXJzaXN0ZW5jZVNlcnZpY2VJbnRlcmZhY2UpO1xuICAgIHJldHVybiBuZXcgQXBwbGljYXRpb25Jbml0aWFsaXphdGlvblNlcnZpY2UoXG4gICAgICBzZXR0aW5nc1NlcnZpY2UsXG4gICAgICBwZXJzaXN0ZW5jZVNlcnZpY2VcbiAgICApO1xuICB9KTtcbn1cbiJdLAogICJtYXBwaW5ncyI6ICJBQU1BO0FBQUEsRUFDRTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBRUE7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsT0FDSztBQUNQLFNBQVMsb0NBQW9DO0FBRTdDLFNBQVMsd0NBQXdDO0FBQ2pELFNBQVMsdUNBQXVDO0FBQ2hELFNBQVMsa0NBQWtDO0FBQzNDLFNBQVMsdUJBQXVCO0FBQ2hDLFNBQVMsaUNBQWlDO0FBRTFD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
