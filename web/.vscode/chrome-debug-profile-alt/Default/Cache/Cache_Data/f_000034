export class TextRenderingService {
  // Font constants matching desktop application
  static WORD_FONT_FAMILY = "Georgia";
  static WORD_BASE_FONT_SIZE = 175;
  static WORD_FONT_WEIGHT = "600";
  // DemiBold
  static USER_INFO_FONT_FAMILY = "Georgia";
  static USER_INFO_BASE_FONT_SIZE = 50;
  static DIFFICULTY_FONT_FAMILY = "Georgia";
  // Kerning constant matching desktop
  static WORD_KERNING_BASE = 20;
  /**
   * Render sequence word/title text
   * Matches desktop WordDrawer exactly
   */
  renderWordText(canvas, word, options) {
    if (!word || !word.trim()) {
      return;
    }
    const ctx = canvas.getContext("2d");
    if (!ctx) {
      throw new Error("Canvas context not available");
    }
    let fontSize = Math.floor(
      TextRenderingService.WORD_BASE_FONT_SIZE * options.beatScale
    );
    const kerning = Math.floor(
      TextRenderingService.WORD_KERNING_BASE * options.beatScale
    );
    let font = this.createFont(
      TextRenderingService.WORD_FONT_FAMILY,
      fontSize,
      TextRenderingService.WORD_FONT_WEIGHT
    );
    ctx.font = font;
    let textWidth = this.measureTextWithKerning(ctx, word, kerning);
    const maxWidth = canvas.width - canvas.width / 4;
    const margin = options.margin;
    while (textWidth + 2 * margin > maxWidth && fontSize > 10) {
      fontSize--;
      font = this.createFont(
        TextRenderingService.WORD_FONT_FAMILY,
        fontSize,
        TextRenderingService.WORD_FONT_WEIGHT
      );
      ctx.font = font;
      textWidth = this.measureTextWithKerning(ctx, word, kerning);
    }
    const additionalHeightTop = options.additionalHeightTop || 0;
    const textHeight = fontSize;
    const y = additionalHeightTop / 2 + textHeight / 2 - textHeight / 10;
    const totalTextWidth = textWidth + kerning * (word.length - 1);
    const x = (canvas.width - totalTextWidth) / 2;
    ctx.fillStyle = "black";
    ctx.textBaseline = "middle";
    ctx.textAlign = "left";
    this.renderTextWithKerning(ctx, word, x, y, kerning);
  }
  /**
   * Render user information (name, date, notes)
   * Matches desktop UserInfoDrawer exactly with 3-column layout
   */
  renderUserInfo(canvas, userInfo, options) {
    const ctx = canvas.getContext("2d");
    if (!ctx) {
      throw new Error("Canvas context not available");
    }
    const margin = options.margin;
    const bottomY = canvas.height - margin;
    const baseFontSize = TextRenderingService.USER_INFO_BASE_FONT_SIZE;
    const { fontSize } = this.adjustFontAndMargin(
      baseFontSize,
      margin,
      3,
      options.beatScale
    );
    const formattedDate = this.formatExportDate(userInfo.exportDate);
    const notes = userInfo.notes || "Created using The Kinetic Alphabet";
    ctx.font = this.createFont(
      TextRenderingService.USER_INFO_FONT_FAMILY,
      fontSize,
      "bold",
      true
      // italic
    );
    ctx.fillStyle = "black";
    ctx.textAlign = "left";
    ctx.textBaseline = "bottom";
    ctx.fillText(userInfo.userName, margin, bottomY);
    ctx.font = this.createFont(
      TextRenderingService.USER_INFO_FONT_FAMILY,
      fontSize,
      "normal",
      true
      // italic
    );
    ctx.textAlign = "center";
    ctx.fillText(notes, canvas.width / 2, bottomY);
    ctx.textAlign = "right";
    ctx.fillText(formattedDate, canvas.width - margin, bottomY);
  }
  /**
   * Render difficulty level badge
   * Matches desktop ImageExportDifficultyLevelDrawer exactly
   */
  renderDifficultyBadge(canvas, level, position, size) {
    const ctx = canvas.getContext("2d");
    if (!ctx) {
      throw new Error("Canvas context not available");
    }
    if (level < 1 || level > 5) {
      throw new Error(`Invalid difficulty level: ${level}`);
    }
    const [x, y] = position;
    const gradient = this.createDifficultyGradient(ctx, level, x, y, size);
    ctx.fillStyle = gradient;
    ctx.beginPath();
    ctx.arc(x + size / 2, y + size / 2, size / 2, 0, 2 * Math.PI);
    ctx.fill();
    ctx.strokeStyle = "black";
    ctx.lineWidth = Math.max(1, size / 50);
    ctx.stroke();
    const fontSize = Math.floor(size / 1.75);
    ctx.font = this.createFont(
      TextRenderingService.DIFFICULTY_FONT_FAMILY,
      fontSize,
      "bold"
    );
    ctx.fillStyle = "black";
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    const yOffset = level === 3 ? -25 : -15;
    const textY = y + size / 2 + yOffset;
    ctx.fillText(level.toString(), x + size / 2, textY);
  }
  /**
   * Calculate text dimensions for layout planning
   */
  measureText(text, fontFamily, fontSize, fontWeight = "normal") {
    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");
    if (!ctx) {
      throw new Error("Failed to get 2D context for text measurement");
    }
    ctx.font = this.createFont(fontFamily, fontSize, fontWeight);
    const metrics = ctx.measureText(text);
    return {
      width: metrics.width,
      height: fontSize
      // Approximation
    };
  }
  /**
   * Apply custom kerning to text
   * Matches desktop kerning implementation exactly
   */
  renderTextWithKerning(ctx, text, x, y, kerning) {
    let currentX = x;
    for (const letter of text) {
      ctx.fillText(letter, currentX, y);
      const letterWidth = ctx.measureText(letter).width;
      currentX += letterWidth + kerning;
    }
  }
  /**
   * Create font string for canvas context
   */
  createFont(family, size, weight = "normal", italic = false) {
    const style = italic ? "italic" : "normal";
    return `${style} ${weight} ${size}px ${family}`;
  }
  /**
   * Measure text width including kerning
   */
  measureTextWithKerning(ctx, text, kerning) {
    let totalWidth = 0;
    for (const letter of text) {
      totalWidth += ctx.measureText(letter).width;
    }
    totalWidth += kerning * (text.length - 1);
    return totalWidth;
  }
  /**
   * Adjust font size and margin based on beat count
   * Matches desktop FontMarginHelper.adjust_font_and_margin exactly
   */
  adjustFontAndMargin(baseFontSize, baseMargin, beatCount, beatScale) {
    let fontScale;
    let marginScale;
    if (beatCount <= 1) {
      fontScale = 1 / 2.3;
      marginScale = 1 / 3;
    } else if (beatCount === 2) {
      fontScale = 1 / 1.5;
      marginScale = 1 / 2;
    } else {
      fontScale = 1;
      marginScale = 1;
    }
    const fontSize = Math.max(
      1,
      Math.floor(baseFontSize * fontScale * beatScale)
    );
    const margin = Math.max(
      1,
      Math.floor(baseMargin * marginScale * beatScale)
    );
    return { fontSize, margin };
  }
  /**
   * Format export date to match desktop formatting
   * Matches desktop _format_export_date exactly
   */
  formatExportDate(dateStr) {
    return dateStr.split("-").map((part) => parseInt(part).toString()).join("-");
  }
  /**
   * Create difficulty level gradient
   * Matches desktop DifficultyLevelGradients exactly
   */
  createDifficultyGradient(ctx, level, x, y, size) {
    const gradient = ctx.createLinearGradient(x, y, x + size, y + size);
    switch (level) {
      case 1:
        gradient.addColorStop(0, "#f5f5f5");
        break;
      case 2:
        gradient.addColorStop(0, "#aaaaaa");
        gradient.addColorStop(0.15, "#d2d2d2");
        gradient.addColorStop(0.3, "#787878");
        gradient.addColorStop(0.4, "#b4b4b4");
        gradient.addColorStop(0.55, "#bebebe");
        gradient.addColorStop(0.75, "#828282");
        gradient.addColorStop(1, "#6e6e6e");
        break;
      case 3:
        gradient.addColorStop(0, "#ffd700");
        gradient.addColorStop(0.2, "#eec900");
        gradient.addColorStop(0.4, "#daa520");
        gradient.addColorStop(0.6, "#b8860b");
        gradient.addColorStop(0.8, "#8b4513");
        gradient.addColorStop(1, "#556b2f");
        break;
      case 4:
        gradient.addColorStop(0, "#c8a2c8");
        gradient.addColorStop(0.3, "#aa84aa");
        gradient.addColorStop(0.6, "#9400d3");
        gradient.addColorStop(1, "#640096");
        break;
      case 5:
        gradient.addColorStop(0, "#ff4500");
        gradient.addColorStop(0.4, "#ff0000");
        gradient.addColorStop(0.8, "#8b0000");
        gradient.addColorStop(1, "#640000");
        break;
      default:
        gradient.addColorStop(0, "white");
        gradient.addColorStop(1, "white");
        break;
    }
    return gradient;
  }
  /**
   * Validate font loading and availability
   * Ensures fonts are ready for rendering
   */
  async validateFonts() {
    const requiredFonts = [
      TextRenderingService.WORD_FONT_FAMILY,
      TextRenderingService.USER_INFO_FONT_FAMILY,
      TextRenderingService.DIFFICULTY_FONT_FAMILY
    ];
    const missing = [];
    for (const font of requiredFonts) {
      if (!this.isFontAvailable(font)) {
        missing.push(font);
      }
    }
    return {
      available: missing.length === 0,
      missing
    };
  }
  /**
   * Check if font is available in the browser
   */
  isFontAvailable(fontFamily) {
    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");
    if (!ctx) {
      return false;
    }
    ctx.font = `12px ${fontFamily}, monospace`;
    const testWidth1 = ctx.measureText("test").width;
    ctx.font = "12px monospace";
    const testWidth2 = ctx.measureText("test").width;
    return testWidth1 !== testWidth2;
  }
  /**
   * Get recommended text settings for different contexts
   */
  getRecommendedTextSettings(context, beatCount, beatScale) {
    switch (context) {
      case "word": {
        const wordFontSize = Math.floor(
          TextRenderingService.WORD_BASE_FONT_SIZE * beatScale
        );
        return {
          fontFamily: TextRenderingService.WORD_FONT_FAMILY,
          fontSize: wordFontSize,
          fontWeight: TextRenderingService.WORD_FONT_WEIGHT,
          italic: false
        };
      }
      case "userInfo": {
        const { fontSize } = this.adjustFontAndMargin(
          TextRenderingService.USER_INFO_BASE_FONT_SIZE,
          50,
          beatCount,
          beatScale
        );
        return {
          fontFamily: TextRenderingService.USER_INFO_FONT_FAMILY,
          fontSize,
          fontWeight: "normal",
          italic: true
        };
      }
      case "difficulty":
        return {
          fontFamily: TextRenderingService.DIFFICULTY_FONT_FAMILY,
          fontSize: 24,
          // Will be calculated based on badge size
          fontWeight: "bold",
          italic: false
        };
      default:
        throw new Error(`Unknown context: ${context}`);
    }
  }
  /**
   * Debug method to test text rendering
   */
  debugTextRendering(canvas, testText = "Test") {
    const ctx = canvas.getContext("2d");
    if (!ctx) {
      throw new Error("Failed to get 2D context for font testing");
    }
    ctx.fillStyle = "white";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    this.renderWordText(canvas, testText, {
      margin: 50,
      beatScale: 1,
      additionalHeightTop: 300
    });
    this.renderUserInfo(
      canvas,
      {
        userName: "Test User",
        notes: "Test Notes",
        exportDate: "1-1-2024"
      },
      {
        margin: 50,
        beatScale: 1
      }
    );
    this.renderDifficultyBadge(canvas, 3, [50, 50], 100);
  }
}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiQzovVEtBL3dlYi9zcmMvbGliL3NlcnZpY2VzL2ltcGxlbWVudGF0aW9ucy9pbWFnZS1leHBvcnQvVGV4dFJlbmRlcmluZ1NlcnZpY2UudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbIi8qKlxuICogVGV4dCBSZW5kZXJpbmcgU2VydmljZVxuICpcbiAqIEhhbmRsZXMgYWxsIHRleHQgcmVuZGVyaW5nIGZvciBUS0EgaW1hZ2UgZXhwb3J0LCBwcm92aWRpbmcgcGl4ZWwtcGVyZmVjdFxuICogY29tcGF0aWJpbGl0eSB3aXRoIGRlc2t0b3AgdHlwb2dyYXBoeS4gVGhpcyBzZXJ2aWNlIGltcGxlbWVudHMgdGhlIGV4YWN0XG4gKiBmb250IHNjYWxpbmcsIGtlcm5pbmcsIGFuZCBwb3NpdGlvbmluZyBsb2dpYyBmcm9tIHRoZSBkZXNrdG9wIFdvcmREcmF3ZXIsXG4gKiBVc2VySW5mb0RyYXdlciwgYW5kIEltYWdlRXhwb3J0RGlmZmljdWx0eUxldmVsRHJhd2VyLlxuICpcbiAqIENyaXRpY2FsOiBGb250IHNpemVzLCBrZXJuaW5nLCBhbmQgcG9zaXRpb25pbmcgbXVzdCBtYXRjaCBkZXNrdG9wIGV4YWN0bHkuXG4gKi9cblxuaW1wb3J0IHR5cGUge1xuICBJVGV4dFJlbmRlcmluZ1NlcnZpY2UsXG4gIFRleHRSZW5kZXJPcHRpb25zLFxuICBVc2VySW5mbyxcbn0gZnJvbSBcIi4uLy4uL2ludGVyZmFjZXMvaW1hZ2UtZXhwb3J0LWludGVyZmFjZXNcIjtcblxuZXhwb3J0IGNsYXNzIFRleHRSZW5kZXJpbmdTZXJ2aWNlIGltcGxlbWVudHMgSVRleHRSZW5kZXJpbmdTZXJ2aWNlIHtcbiAgLy8gRm9udCBjb25zdGFudHMgbWF0Y2hpbmcgZGVza3RvcCBhcHBsaWNhdGlvblxuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBXT1JEX0ZPTlRfRkFNSUxZID0gXCJHZW9yZ2lhXCI7XG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFdPUkRfQkFTRV9GT05UX1NJWkUgPSAxNzU7XG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFdPUkRfRk9OVF9XRUlHSFQgPSBcIjYwMFwiOyAvLyBEZW1pQm9sZFxuXG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFVTRVJfSU5GT19GT05UX0ZBTUlMWSA9IFwiR2VvcmdpYVwiO1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBVU0VSX0lORk9fQkFTRV9GT05UX1NJWkUgPSA1MDtcblxuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBESUZGSUNVTFRZX0ZPTlRfRkFNSUxZID0gXCJHZW9yZ2lhXCI7XG5cbiAgLy8gS2VybmluZyBjb25zdGFudCBtYXRjaGluZyBkZXNrdG9wXG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFdPUkRfS0VSTklOR19CQVNFID0gMjA7XG5cbiAgLyoqXG4gICAqIFJlbmRlciBzZXF1ZW5jZSB3b3JkL3RpdGxlIHRleHRcbiAgICogTWF0Y2hlcyBkZXNrdG9wIFdvcmREcmF3ZXIgZXhhY3RseVxuICAgKi9cbiAgcmVuZGVyV29yZFRleHQoXG4gICAgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCxcbiAgICB3b3JkOiBzdHJpbmcsXG4gICAgb3B0aW9uczogVGV4dFJlbmRlck9wdGlvbnNcbiAgKTogdm9pZCB7XG4gICAgaWYgKCF3b3JkIHx8ICF3b3JkLnRyaW0oKSkge1xuICAgICAgcmV0dXJuOyAvLyBObyB3b3JkIHRvIHJlbmRlclxuICAgIH1cblxuICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgaWYgKCFjdHgpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbnZhcyBjb250ZXh0IG5vdCBhdmFpbGFibGVcIik7XG4gICAgfVxuXG4gICAgLy8gQ2FsY3VsYXRlIGluaXRpYWwgZm9udCBzaXplIGFuZCBrZXJuaW5nIHdpdGggc2NhbGluZ1xuICAgIGxldCBmb250U2l6ZSA9IE1hdGguZmxvb3IoXG4gICAgICBUZXh0UmVuZGVyaW5nU2VydmljZS5XT1JEX0JBU0VfRk9OVF9TSVpFICogb3B0aW9ucy5iZWF0U2NhbGVcbiAgICApO1xuICAgIGNvbnN0IGtlcm5pbmcgPSBNYXRoLmZsb29yKFxuICAgICAgVGV4dFJlbmRlcmluZ1NlcnZpY2UuV09SRF9LRVJOSU5HX0JBU0UgKiBvcHRpb25zLmJlYXRTY2FsZVxuICAgICk7XG5cbiAgICAvLyBDcmVhdGUgaW5pdGlhbCBmb250XG4gICAgbGV0IGZvbnQgPSB0aGlzLmNyZWF0ZUZvbnQoXG4gICAgICBUZXh0UmVuZGVyaW5nU2VydmljZS5XT1JEX0ZPTlRfRkFNSUxZLFxuICAgICAgZm9udFNpemUsXG4gICAgICBUZXh0UmVuZGVyaW5nU2VydmljZS5XT1JEX0ZPTlRfV0VJR0hUXG4gICAgKTtcblxuICAgIGN0eC5mb250ID0gZm9udDtcblxuICAgIC8vIENhbGN1bGF0ZSB0ZXh0IHdpZHRoIHdpdGgga2VybmluZ1xuICAgIGxldCB0ZXh0V2lkdGggPSB0aGlzLm1lYXN1cmVUZXh0V2l0aEtlcm5pbmcoY3R4LCB3b3JkLCBrZXJuaW5nKTtcblxuICAgIC8vIEF1dG8tc2NhbGUgZm9udCB0byBmaXQgd2lkdGggKG1hdGNoIGRlc2t0b3AgbG9naWMgZXhhY3RseSlcbiAgICBjb25zdCBtYXhXaWR0aCA9IGNhbnZhcy53aWR0aCAtIGNhbnZhcy53aWR0aCAvIDQ7IC8vIFNhbWUgYXMgZGVza3RvcFxuICAgIGNvbnN0IG1hcmdpbiA9IG9wdGlvbnMubWFyZ2luO1xuXG4gICAgd2hpbGUgKHRleHRXaWR0aCArIDIgKiBtYXJnaW4gPiBtYXhXaWR0aCAmJiBmb250U2l6ZSA+IDEwKSB7XG4gICAgICBmb250U2l6ZS0tO1xuICAgICAgZm9udCA9IHRoaXMuY3JlYXRlRm9udChcbiAgICAgICAgVGV4dFJlbmRlcmluZ1NlcnZpY2UuV09SRF9GT05UX0ZBTUlMWSxcbiAgICAgICAgZm9udFNpemUsXG4gICAgICAgIFRleHRSZW5kZXJpbmdTZXJ2aWNlLldPUkRfRk9OVF9XRUlHSFRcbiAgICAgICk7XG4gICAgICBjdHguZm9udCA9IGZvbnQ7XG4gICAgICB0ZXh0V2lkdGggPSB0aGlzLm1lYXN1cmVUZXh0V2l0aEtlcm5pbmcoY3R4LCB3b3JkLCBrZXJuaW5nKTtcbiAgICB9XG5cbiAgICAvLyBQb3NpdGlvbiB0ZXh0IGluIHRvcCBtYXJnaW4gYXJlYSAobWF0Y2ggZGVza3RvcClcbiAgICBjb25zdCBhZGRpdGlvbmFsSGVpZ2h0VG9wID0gb3B0aW9ucy5hZGRpdGlvbmFsSGVpZ2h0VG9wIHx8IDA7XG4gICAgY29uc3QgdGV4dEhlaWdodCA9IGZvbnRTaXplO1xuXG4gICAgLy8gQ2VudGVyIHZlcnRpY2FsbHkgaW4gdGhlIGFkZGl0aW9uYWwgaGVpZ2h0IGFyZWFcbiAgICBjb25zdCB5ID0gYWRkaXRpb25hbEhlaWdodFRvcCAvIDIgKyB0ZXh0SGVpZ2h0IC8gMiAtIHRleHRIZWlnaHQgLyAxMDtcblxuICAgIC8vIENlbnRlciBob3Jpem9udGFsbHkgd2l0aCBrZXJuaW5nIGNvbnNpZGVyYXRpb25cbiAgICBjb25zdCB0b3RhbFRleHRXaWR0aCA9IHRleHRXaWR0aCArIGtlcm5pbmcgKiAod29yZC5sZW5ndGggLSAxKTtcbiAgICBjb25zdCB4ID0gKGNhbnZhcy53aWR0aCAtIHRvdGFsVGV4dFdpZHRoKSAvIDI7XG5cbiAgICAvLyBSZW5kZXIgdGV4dCB3aXRoIGN1c3RvbSBrZXJuaW5nXG4gICAgY3R4LmZpbGxTdHlsZSA9IFwiYmxhY2tcIjtcbiAgICBjdHgudGV4dEJhc2VsaW5lID0gXCJtaWRkbGVcIjtcbiAgICBjdHgudGV4dEFsaWduID0gXCJsZWZ0XCI7XG5cbiAgICB0aGlzLnJlbmRlclRleHRXaXRoS2VybmluZyhjdHgsIHdvcmQsIHgsIHksIGtlcm5pbmcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbmRlciB1c2VyIGluZm9ybWF0aW9uIChuYW1lLCBkYXRlLCBub3RlcylcbiAgICogTWF0Y2hlcyBkZXNrdG9wIFVzZXJJbmZvRHJhd2VyIGV4YWN0bHkgd2l0aCAzLWNvbHVtbiBsYXlvdXRcbiAgICovXG4gIHJlbmRlclVzZXJJbmZvKFxuICAgIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsXG4gICAgdXNlckluZm86IFVzZXJJbmZvLFxuICAgIG9wdGlvbnM6IFRleHRSZW5kZXJPcHRpb25zXG4gICk6IHZvaWQge1xuICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgaWYgKCFjdHgpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbnZhcyBjb250ZXh0IG5vdCBhdmFpbGFibGVcIik7XG4gICAgfVxuXG4gICAgY29uc3QgbWFyZ2luID0gb3B0aW9ucy5tYXJnaW47XG4gICAgY29uc3QgYm90dG9tWSA9IGNhbnZhcy5oZWlnaHQgLSBtYXJnaW47XG5cbiAgICAvLyBDYWxjdWxhdGUgc2NhbGVkIGZvbnQgc2l6ZXNcbiAgICBjb25zdCBiYXNlRm9udFNpemUgPSBUZXh0UmVuZGVyaW5nU2VydmljZS5VU0VSX0lORk9fQkFTRV9GT05UX1NJWkU7XG4gICAgY29uc3QgeyBmb250U2l6ZSB9ID0gdGhpcy5hZGp1c3RGb250QW5kTWFyZ2luKFxuICAgICAgYmFzZUZvbnRTaXplLFxuICAgICAgbWFyZ2luLFxuICAgICAgMyxcbiAgICAgIG9wdGlvbnMuYmVhdFNjYWxlXG4gICAgKTtcblxuICAgIC8vIEZvcm1hdCBleHBvcnQgZGF0ZSAobWF0Y2ggZGVza3RvcCBmb3JtYXR0aW5nKVxuICAgIGNvbnN0IGZvcm1hdHRlZERhdGUgPSB0aGlzLmZvcm1hdEV4cG9ydERhdGUodXNlckluZm8uZXhwb3J0RGF0ZSk7XG4gICAgY29uc3Qgbm90ZXMgPSB1c2VySW5mby5ub3RlcyB8fCBcIkNyZWF0ZWQgdXNpbmcgVGhlIEtpbmV0aWMgQWxwaGFiZXRcIjtcblxuICAgIC8vIExlZnQ6IFVzZXIgbmFtZSAoYm9sZCBpdGFsaWMpXG4gICAgY3R4LmZvbnQgPSB0aGlzLmNyZWF0ZUZvbnQoXG4gICAgICBUZXh0UmVuZGVyaW5nU2VydmljZS5VU0VSX0lORk9fRk9OVF9GQU1JTFksXG4gICAgICBmb250U2l6ZSxcbiAgICAgIFwiYm9sZFwiLFxuICAgICAgdHJ1ZSAvLyBpdGFsaWNcbiAgICApO1xuICAgIGN0eC5maWxsU3R5bGUgPSBcImJsYWNrXCI7XG4gICAgY3R4LnRleHRBbGlnbiA9IFwibGVmdFwiO1xuICAgIGN0eC50ZXh0QmFzZWxpbmUgPSBcImJvdHRvbVwiO1xuICAgIGN0eC5maWxsVGV4dCh1c2VySW5mby51c2VyTmFtZSwgbWFyZ2luLCBib3R0b21ZKTtcblxuICAgIC8vIENlbnRlcjogTm90ZXMgKGl0YWxpYylcbiAgICBjdHguZm9udCA9IHRoaXMuY3JlYXRlRm9udChcbiAgICAgIFRleHRSZW5kZXJpbmdTZXJ2aWNlLlVTRVJfSU5GT19GT05UX0ZBTUlMWSxcbiAgICAgIGZvbnRTaXplLFxuICAgICAgXCJub3JtYWxcIixcbiAgICAgIHRydWUgLy8gaXRhbGljXG4gICAgKTtcbiAgICBjdHgudGV4dEFsaWduID0gXCJjZW50ZXJcIjtcbiAgICBjdHguZmlsbFRleHQobm90ZXMsIGNhbnZhcy53aWR0aCAvIDIsIGJvdHRvbVkpO1xuXG4gICAgLy8gUmlnaHQ6IEV4cG9ydCBkYXRlIChpdGFsaWMpXG4gICAgY3R4LnRleHRBbGlnbiA9IFwicmlnaHRcIjtcbiAgICBjdHguZmlsbFRleHQoZm9ybWF0dGVkRGF0ZSwgY2FudmFzLndpZHRoIC0gbWFyZ2luLCBib3R0b21ZKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXIgZGlmZmljdWx0eSBsZXZlbCBiYWRnZVxuICAgKiBNYXRjaGVzIGRlc2t0b3AgSW1hZ2VFeHBvcnREaWZmaWN1bHR5TGV2ZWxEcmF3ZXIgZXhhY3RseVxuICAgKi9cbiAgcmVuZGVyRGlmZmljdWx0eUJhZGdlKFxuICAgIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsXG4gICAgbGV2ZWw6IG51bWJlcixcbiAgICBwb3NpdGlvbjogW251bWJlciwgbnVtYmVyXSxcbiAgICBzaXplOiBudW1iZXJcbiAgKTogdm9pZCB7XG4gICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcbiAgICBpZiAoIWN0eCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FudmFzIGNvbnRleHQgbm90IGF2YWlsYWJsZVwiKTtcbiAgICB9XG5cbiAgICBpZiAobGV2ZWwgPCAxIHx8IGxldmVsID4gNSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIGRpZmZpY3VsdHkgbGV2ZWw6ICR7bGV2ZWx9YCk7XG4gICAgfVxuXG4gICAgY29uc3QgW3gsIHldID0gcG9zaXRpb247XG5cbiAgICAvLyBDcmVhdGUgZ3JhZGllbnQgYmFja2dyb3VuZCAobWF0Y2ggZGVza3RvcCBncmFkaWVudHMpXG4gICAgY29uc3QgZ3JhZGllbnQgPSB0aGlzLmNyZWF0ZURpZmZpY3VsdHlHcmFkaWVudChjdHgsIGxldmVsLCB4LCB5LCBzaXplKTtcblxuICAgIC8vIERyYXcgY2lyY2xlIHdpdGggZ3JhZGllbnRcbiAgICBjdHguZmlsbFN0eWxlID0gZ3JhZGllbnQ7XG4gICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgIGN0eC5hcmMoeCArIHNpemUgLyAyLCB5ICsgc2l6ZSAvIDIsIHNpemUgLyAyLCAwLCAyICogTWF0aC5QSSk7XG4gICAgY3R4LmZpbGwoKTtcblxuICAgIC8vIERyYXcgYm9yZGVyXG4gICAgY3R4LnN0cm9rZVN0eWxlID0gXCJibGFja1wiO1xuICAgIGN0eC5saW5lV2lkdGggPSBNYXRoLm1heCgxLCBzaXplIC8gNTApOyAvLyBNYXRjaCBkZXNrdG9wIGJvcmRlciBjYWxjdWxhdGlvblxuICAgIGN0eC5zdHJva2UoKTtcblxuICAgIC8vIERyYXcgbGV2ZWwgbnVtYmVyXG4gICAgY29uc3QgZm9udFNpemUgPSBNYXRoLmZsb29yKHNpemUgLyAxLjc1KTsgLy8gTWF0Y2ggZGVza3RvcCBmb250IGNhbGN1bGF0aW9uXG4gICAgY3R4LmZvbnQgPSB0aGlzLmNyZWF0ZUZvbnQoXG4gICAgICBUZXh0UmVuZGVyaW5nU2VydmljZS5ESUZGSUNVTFRZX0ZPTlRfRkFNSUxZLFxuICAgICAgZm9udFNpemUsXG4gICAgICBcImJvbGRcIlxuICAgICk7XG4gICAgY3R4LmZpbGxTdHlsZSA9IFwiYmxhY2tcIjtcbiAgICBjdHgudGV4dEFsaWduID0gXCJjZW50ZXJcIjtcbiAgICBjdHgudGV4dEJhc2VsaW5lID0gXCJtaWRkbGVcIjtcblxuICAgIC8vIEFwcGx5IFkgb2Zmc2V0IGZvciBwb3NpdGlvbmluZyAobWF0Y2ggZGVza3RvcClcbiAgICBjb25zdCB5T2Zmc2V0ID0gbGV2ZWwgPT09IDMgPyAtMjUgOiAtMTU7XG4gICAgY29uc3QgdGV4dFkgPSB5ICsgc2l6ZSAvIDIgKyB5T2Zmc2V0O1xuXG4gICAgY3R4LmZpbGxUZXh0KGxldmVsLnRvU3RyaW5nKCksIHggKyBzaXplIC8gMiwgdGV4dFkpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSB0ZXh0IGRpbWVuc2lvbnMgZm9yIGxheW91dCBwbGFubmluZ1xuICAgKi9cbiAgbWVhc3VyZVRleHQoXG4gICAgdGV4dDogc3RyaW5nLFxuICAgIGZvbnRGYW1pbHk6IHN0cmluZyxcbiAgICBmb250U2l6ZTogbnVtYmVyLFxuICAgIGZvbnRXZWlnaHQ6IHN0cmluZyA9IFwibm9ybWFsXCJcbiAgKTogeyB3aWR0aDogbnVtYmVyOyBoZWlnaHQ6IG51bWJlciB9IHtcbiAgICAvLyBDcmVhdGUgdGVtcG9yYXJ5IGNhbnZhcyBmb3IgbWVhc3VyZW1lbnRcbiAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xuICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgaWYgKCFjdHgpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBnZXQgMkQgY29udGV4dCBmb3IgdGV4dCBtZWFzdXJlbWVudFwiKTtcbiAgICB9XG5cbiAgICBjdHguZm9udCA9IHRoaXMuY3JlYXRlRm9udChmb250RmFtaWx5LCBmb250U2l6ZSwgZm9udFdlaWdodCk7XG4gICAgY29uc3QgbWV0cmljcyA9IGN0eC5tZWFzdXJlVGV4dCh0ZXh0KTtcblxuICAgIHJldHVybiB7XG4gICAgICB3aWR0aDogbWV0cmljcy53aWR0aCxcbiAgICAgIGhlaWdodDogZm9udFNpemUsIC8vIEFwcHJveGltYXRpb25cbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEFwcGx5IGN1c3RvbSBrZXJuaW5nIHRvIHRleHRcbiAgICogTWF0Y2hlcyBkZXNrdG9wIGtlcm5pbmcgaW1wbGVtZW50YXRpb24gZXhhY3RseVxuICAgKi9cbiAgcmVuZGVyVGV4dFdpdGhLZXJuaW5nKFxuICAgIGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELFxuICAgIHRleHQ6IHN0cmluZyxcbiAgICB4OiBudW1iZXIsXG4gICAgeTogbnVtYmVyLFxuICAgIGtlcm5pbmc6IG51bWJlclxuICApOiB2b2lkIHtcbiAgICBsZXQgY3VycmVudFggPSB4O1xuXG4gICAgZm9yIChjb25zdCBsZXR0ZXIgb2YgdGV4dCkge1xuICAgICAgY3R4LmZpbGxUZXh0KGxldHRlciwgY3VycmVudFgsIHkpO1xuICAgICAgY29uc3QgbGV0dGVyV2lkdGggPSBjdHgubWVhc3VyZVRleHQobGV0dGVyKS53aWR0aDtcbiAgICAgIGN1cnJlbnRYICs9IGxldHRlcldpZHRoICsga2VybmluZztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGZvbnQgc3RyaW5nIGZvciBjYW52YXMgY29udGV4dFxuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVGb250KFxuICAgIGZhbWlseTogc3RyaW5nLFxuICAgIHNpemU6IG51bWJlcixcbiAgICB3ZWlnaHQ6IHN0cmluZyA9IFwibm9ybWFsXCIsXG4gICAgaXRhbGljOiBib29sZWFuID0gZmFsc2VcbiAgKTogc3RyaW5nIHtcbiAgICBjb25zdCBzdHlsZSA9IGl0YWxpYyA/IFwiaXRhbGljXCIgOiBcIm5vcm1hbFwiO1xuICAgIHJldHVybiBgJHtzdHlsZX0gJHt3ZWlnaHR9ICR7c2l6ZX1weCAke2ZhbWlseX1gO1xuICB9XG5cbiAgLyoqXG4gICAqIE1lYXN1cmUgdGV4dCB3aWR0aCBpbmNsdWRpbmcga2VybmluZ1xuICAgKi9cbiAgcHJpdmF0ZSBtZWFzdXJlVGV4dFdpdGhLZXJuaW5nKFxuICAgIGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELFxuICAgIHRleHQ6IHN0cmluZyxcbiAgICBrZXJuaW5nOiBudW1iZXJcbiAgKTogbnVtYmVyIHtcbiAgICBsZXQgdG90YWxXaWR0aCA9IDA7XG5cbiAgICBmb3IgKGNvbnN0IGxldHRlciBvZiB0ZXh0KSB7XG4gICAgICB0b3RhbFdpZHRoICs9IGN0eC5tZWFzdXJlVGV4dChsZXR0ZXIpLndpZHRoO1xuICAgIH1cblxuICAgIC8vIEFkZCBrZXJuaW5nIGZvciBzcGFjZXMgYmV0d2VlbiBsZXR0ZXJzXG4gICAgdG90YWxXaWR0aCArPSBrZXJuaW5nICogKHRleHQubGVuZ3RoIC0gMSk7XG5cbiAgICByZXR1cm4gdG90YWxXaWR0aDtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGp1c3QgZm9udCBzaXplIGFuZCBtYXJnaW4gYmFzZWQgb24gYmVhdCBjb3VudFxuICAgKiBNYXRjaGVzIGRlc2t0b3AgRm9udE1hcmdpbkhlbHBlci5hZGp1c3RfZm9udF9hbmRfbWFyZ2luIGV4YWN0bHlcbiAgICovXG4gIHByaXZhdGUgYWRqdXN0Rm9udEFuZE1hcmdpbihcbiAgICBiYXNlRm9udFNpemU6IG51bWJlcixcbiAgICBiYXNlTWFyZ2luOiBudW1iZXIsXG4gICAgYmVhdENvdW50OiBudW1iZXIsXG4gICAgYmVhdFNjYWxlOiBudW1iZXJcbiAgKTogeyBmb250U2l6ZTogbnVtYmVyOyBtYXJnaW46IG51bWJlciB9IHtcbiAgICBsZXQgZm9udFNjYWxlOiBudW1iZXI7XG4gICAgbGV0IG1hcmdpblNjYWxlOiBudW1iZXI7XG5cbiAgICAvLyBNYXRjaCBkZXNrdG9wIHNjYWxpbmcgbG9naWMgZXhhY3RseVxuICAgIGlmIChiZWF0Q291bnQgPD0gMSkge1xuICAgICAgZm9udFNjYWxlID0gMSAvIDIuMztcbiAgICAgIG1hcmdpblNjYWxlID0gMSAvIDM7XG4gICAgfSBlbHNlIGlmIChiZWF0Q291bnQgPT09IDIpIHtcbiAgICAgIGZvbnRTY2FsZSA9IDEgLyAxLjU7XG4gICAgICBtYXJnaW5TY2FsZSA9IDEgLyAyO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb250U2NhbGUgPSAxLjA7XG4gICAgICBtYXJnaW5TY2FsZSA9IDEuMDtcbiAgICB9XG5cbiAgICBjb25zdCBmb250U2l6ZSA9IE1hdGgubWF4KFxuICAgICAgMSxcbiAgICAgIE1hdGguZmxvb3IoYmFzZUZvbnRTaXplICogZm9udFNjYWxlICogYmVhdFNjYWxlKVxuICAgICk7XG4gICAgY29uc3QgbWFyZ2luID0gTWF0aC5tYXgoXG4gICAgICAxLFxuICAgICAgTWF0aC5mbG9vcihiYXNlTWFyZ2luICogbWFyZ2luU2NhbGUgKiBiZWF0U2NhbGUpXG4gICAgKTtcblxuICAgIHJldHVybiB7IGZvbnRTaXplLCBtYXJnaW4gfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3JtYXQgZXhwb3J0IGRhdGUgdG8gbWF0Y2ggZGVza3RvcCBmb3JtYXR0aW5nXG4gICAqIE1hdGNoZXMgZGVza3RvcCBfZm9ybWF0X2V4cG9ydF9kYXRlIGV4YWN0bHlcbiAgICovXG4gIHByaXZhdGUgZm9ybWF0RXhwb3J0RGF0ZShkYXRlU3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIC8vIENvbnZlcnQgXCJNTS1ERC1ZWVlZXCIgdG8gXCJNLUQtWVlZWVwiIChyZW1vdmUgbGVhZGluZyB6ZXJvcylcbiAgICByZXR1cm4gZGF0ZVN0clxuICAgICAgLnNwbGl0KFwiLVwiKVxuICAgICAgLm1hcCgocGFydCkgPT4gcGFyc2VJbnQocGFydCkudG9TdHJpbmcoKSlcbiAgICAgIC5qb2luKFwiLVwiKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgZGlmZmljdWx0eSBsZXZlbCBncmFkaWVudFxuICAgKiBNYXRjaGVzIGRlc2t0b3AgRGlmZmljdWx0eUxldmVsR3JhZGllbnRzIGV4YWN0bHlcbiAgICovXG4gIHByaXZhdGUgY3JlYXRlRGlmZmljdWx0eUdyYWRpZW50KFxuICAgIGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELFxuICAgIGxldmVsOiBudW1iZXIsXG4gICAgeDogbnVtYmVyLFxuICAgIHk6IG51bWJlcixcbiAgICBzaXplOiBudW1iZXJcbiAgKTogQ2FudmFzR3JhZGllbnQge1xuICAgIGNvbnN0IGdyYWRpZW50ID0gY3R4LmNyZWF0ZUxpbmVhckdyYWRpZW50KHgsIHksIHggKyBzaXplLCB5ICsgc2l6ZSk7XG5cbiAgICAvLyBNYXRjaCBkZXNrdG9wIGdyYWRpZW50IGRlZmluaXRpb25zIGV4YWN0bHlcbiAgICBzd2l0Y2ggKGxldmVsKSB7XG4gICAgICBjYXNlIDE6XG4gICAgICAgIGdyYWRpZW50LmFkZENvbG9yU3RvcCgwLCBcIiNmNWY1ZjVcIik7IC8vIExpZ2h0IGdyYXlcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgMjpcbiAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAsIFwiI2FhYWFhYVwiKTtcbiAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAuMTUsIFwiI2QyZDJkMlwiKTtcbiAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAuMywgXCIjNzg3ODc4XCIpO1xuICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMC40LCBcIiNiNGI0YjRcIik7XG4gICAgICAgIGdyYWRpZW50LmFkZENvbG9yU3RvcCgwLjU1LCBcIiNiZWJlYmVcIik7XG4gICAgICAgIGdyYWRpZW50LmFkZENvbG9yU3RvcCgwLjc1LCBcIiM4MjgyODJcIik7XG4gICAgICAgIGdyYWRpZW50LmFkZENvbG9yU3RvcCgxLCBcIiM2ZTZlNmVcIik7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIDM6XG4gICAgICAgIGdyYWRpZW50LmFkZENvbG9yU3RvcCgwLCBcIiNmZmQ3MDBcIik7IC8vIEdvbGRcbiAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAuMiwgXCIjZWVjOTAwXCIpOyAvLyBHb2xkZW5yb2RcbiAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAuNCwgXCIjZGFhNTIwXCIpOyAvLyBHb2xkZW5yb2QgZGFya2VyXG4gICAgICAgIGdyYWRpZW50LmFkZENvbG9yU3RvcCgwLjYsIFwiI2I4ODYwYlwiKTsgLy8gRGFyayBnb2xkZW5yb2RcbiAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAuOCwgXCIjOGI0NTEzXCIpOyAvLyBTYWRkbGUgYnJvd25cbiAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDEsIFwiIzU1NmIyZlwiKTsgLy8gRGFyayBvbGl2ZSBncmVlblxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSA0OlxuICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMCwgXCIjYzhhMmM4XCIpO1xuICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMC4zLCBcIiNhYTg0YWFcIik7XG4gICAgICAgIGdyYWRpZW50LmFkZENvbG9yU3RvcCgwLjYsIFwiIzk0MDBkM1wiKTtcbiAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDEsIFwiIzY0MDA5NlwiKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgNTpcbiAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAsIFwiI2ZmNDUwMFwiKTtcbiAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAuNCwgXCIjZmYwMDAwXCIpO1xuICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMC44LCBcIiM4YjAwMDBcIik7XG4gICAgICAgIGdyYWRpZW50LmFkZENvbG9yU3RvcCgxLCBcIiM2NDAwMDBcIik7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMCwgXCJ3aGl0ZVwiKTtcbiAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDEsIFwid2hpdGVcIik7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHJldHVybiBncmFkaWVudDtcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBmb250IGxvYWRpbmcgYW5kIGF2YWlsYWJpbGl0eVxuICAgKiBFbnN1cmVzIGZvbnRzIGFyZSByZWFkeSBmb3IgcmVuZGVyaW5nXG4gICAqL1xuICBhc3luYyB2YWxpZGF0ZUZvbnRzKCk6IFByb21pc2U8eyBhdmFpbGFibGU6IGJvb2xlYW47IG1pc3Npbmc6IHN0cmluZ1tdIH0+IHtcbiAgICBjb25zdCByZXF1aXJlZEZvbnRzID0gW1xuICAgICAgVGV4dFJlbmRlcmluZ1NlcnZpY2UuV09SRF9GT05UX0ZBTUlMWSxcbiAgICAgIFRleHRSZW5kZXJpbmdTZXJ2aWNlLlVTRVJfSU5GT19GT05UX0ZBTUlMWSxcbiAgICAgIFRleHRSZW5kZXJpbmdTZXJ2aWNlLkRJRkZJQ1VMVFlfRk9OVF9GQU1JTFksXG4gICAgXTtcblxuICAgIGNvbnN0IG1pc3Npbmc6IHN0cmluZ1tdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IGZvbnQgb2YgcmVxdWlyZWRGb250cykge1xuICAgICAgaWYgKCF0aGlzLmlzRm9udEF2YWlsYWJsZShmb250KSkge1xuICAgICAgICBtaXNzaW5nLnB1c2goZm9udCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGF2YWlsYWJsZTogbWlzc2luZy5sZW5ndGggPT09IDAsXG4gICAgICBtaXNzaW5nLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgZm9udCBpcyBhdmFpbGFibGUgaW4gdGhlIGJyb3dzZXJcbiAgICovXG4gIHByaXZhdGUgaXNGb250QXZhaWxhYmxlKGZvbnRGYW1pbHk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIC8vIENyZWF0ZSBhIHRlbXBvcmFyeSBjYW52YXMgdG8gdGVzdCBmb250IGF2YWlsYWJpbGl0eVxuICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG4gICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcbiAgICBpZiAoIWN0eCkge1xuICAgICAgcmV0dXJuIGZhbHNlOyAvLyBJZiB3ZSBjYW4ndCBnZXQgY29udGV4dCwgYXNzdW1lIGZvbnQgaXMgbm90IGF2YWlsYWJsZVxuICAgIH1cblxuICAgIC8vIFRlc3Qgd2l0aCBmYWxsYmFjayBmb250XG4gICAgY3R4LmZvbnQgPSBgMTJweCAke2ZvbnRGYW1pbHl9LCBtb25vc3BhY2VgO1xuICAgIGNvbnN0IHRlc3RXaWR0aDEgPSBjdHgubWVhc3VyZVRleHQoXCJ0ZXN0XCIpLndpZHRoO1xuXG4gICAgLy8gVGVzdCB3aXRoIGp1c3QgbW9ub3NwYWNlXG4gICAgY3R4LmZvbnQgPSBcIjEycHggbW9ub3NwYWNlXCI7XG4gICAgY29uc3QgdGVzdFdpZHRoMiA9IGN0eC5tZWFzdXJlVGV4dChcInRlc3RcIikud2lkdGg7XG5cbiAgICAvLyBJZiB3aWR0aHMgYXJlIGRpZmZlcmVudCwgdGhlIGZvbnQgaXMgYXZhaWxhYmxlXG4gICAgcmV0dXJuIHRlc3RXaWR0aDEgIT09IHRlc3RXaWR0aDI7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHJlY29tbWVuZGVkIHRleHQgc2V0dGluZ3MgZm9yIGRpZmZlcmVudCBjb250ZXh0c1xuICAgKi9cbiAgZ2V0UmVjb21tZW5kZWRUZXh0U2V0dGluZ3MoXG4gICAgY29udGV4dDogXCJ3b3JkXCIgfCBcInVzZXJJbmZvXCIgfCBcImRpZmZpY3VsdHlcIixcbiAgICBiZWF0Q291bnQ6IG51bWJlcixcbiAgICBiZWF0U2NhbGU6IG51bWJlclxuICApOiB7XG4gICAgZm9udEZhbWlseTogc3RyaW5nO1xuICAgIGZvbnRTaXplOiBudW1iZXI7XG4gICAgZm9udFdlaWdodDogc3RyaW5nO1xuICAgIGl0YWxpYzogYm9vbGVhbjtcbiAgfSB7XG4gICAgc3dpdGNoIChjb250ZXh0KSB7XG4gICAgICBjYXNlIFwid29yZFwiOiB7XG4gICAgICAgIGNvbnN0IHdvcmRGb250U2l6ZSA9IE1hdGguZmxvb3IoXG4gICAgICAgICAgVGV4dFJlbmRlcmluZ1NlcnZpY2UuV09SRF9CQVNFX0ZPTlRfU0laRSAqIGJlYXRTY2FsZVxuICAgICAgICApO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGZvbnRGYW1pbHk6IFRleHRSZW5kZXJpbmdTZXJ2aWNlLldPUkRfRk9OVF9GQU1JTFksXG4gICAgICAgICAgZm9udFNpemU6IHdvcmRGb250U2l6ZSxcbiAgICAgICAgICBmb250V2VpZ2h0OiBUZXh0UmVuZGVyaW5nU2VydmljZS5XT1JEX0ZPTlRfV0VJR0hULFxuICAgICAgICAgIGl0YWxpYzogZmFsc2UsXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIGNhc2UgXCJ1c2VySW5mb1wiOiB7XG4gICAgICAgIGNvbnN0IHsgZm9udFNpemUgfSA9IHRoaXMuYWRqdXN0Rm9udEFuZE1hcmdpbihcbiAgICAgICAgICBUZXh0UmVuZGVyaW5nU2VydmljZS5VU0VSX0lORk9fQkFTRV9GT05UX1NJWkUsXG4gICAgICAgICAgNTAsXG4gICAgICAgICAgYmVhdENvdW50LFxuICAgICAgICAgIGJlYXRTY2FsZVxuICAgICAgICApO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGZvbnRGYW1pbHk6IFRleHRSZW5kZXJpbmdTZXJ2aWNlLlVTRVJfSU5GT19GT05UX0ZBTUlMWSxcbiAgICAgICAgICBmb250U2l6ZSxcbiAgICAgICAgICBmb250V2VpZ2h0OiBcIm5vcm1hbFwiLFxuICAgICAgICAgIGl0YWxpYzogdHJ1ZSxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgY2FzZSBcImRpZmZpY3VsdHlcIjpcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBmb250RmFtaWx5OiBUZXh0UmVuZGVyaW5nU2VydmljZS5ESUZGSUNVTFRZX0ZPTlRfRkFNSUxZLFxuICAgICAgICAgIGZvbnRTaXplOiAyNCwgLy8gV2lsbCBiZSBjYWxjdWxhdGVkIGJhc2VkIG9uIGJhZGdlIHNpemVcbiAgICAgICAgICBmb250V2VpZ2h0OiBcImJvbGRcIixcbiAgICAgICAgICBpdGFsaWM6IGZhbHNlLFxuICAgICAgICB9O1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gY29udGV4dDogJHtjb250ZXh0fWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEZWJ1ZyBtZXRob2QgdG8gdGVzdCB0ZXh0IHJlbmRlcmluZ1xuICAgKi9cbiAgZGVidWdUZXh0UmVuZGVyaW5nKFxuICAgIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsXG4gICAgdGVzdFRleHQ6IHN0cmluZyA9IFwiVGVzdFwiXG4gICk6IHZvaWQge1xuICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgaWYgKCFjdHgpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBnZXQgMkQgY29udGV4dCBmb3IgZm9udCB0ZXN0aW5nXCIpO1xuICAgIH1cblxuICAgIC8vIENsZWFyIGNhbnZhc1xuICAgIGN0eC5maWxsU3R5bGUgPSBcIndoaXRlXCI7XG4gICAgY3R4LmZpbGxSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG5cbiAgICAvLyBUZXN0IHdvcmQgcmVuZGVyaW5nXG4gICAgdGhpcy5yZW5kZXJXb3JkVGV4dChjYW52YXMsIHRlc3RUZXh0LCB7XG4gICAgICBtYXJnaW46IDUwLFxuICAgICAgYmVhdFNjYWxlOiAxLFxuICAgICAgYWRkaXRpb25hbEhlaWdodFRvcDogMzAwLFxuICAgIH0pO1xuXG4gICAgLy8gVGVzdCB1c2VyIGluZm8gcmVuZGVyaW5nXG4gICAgdGhpcy5yZW5kZXJVc2VySW5mbyhcbiAgICAgIGNhbnZhcyxcbiAgICAgIHtcbiAgICAgICAgdXNlck5hbWU6IFwiVGVzdCBVc2VyXCIsXG4gICAgICAgIG5vdGVzOiBcIlRlc3QgTm90ZXNcIixcbiAgICAgICAgZXhwb3J0RGF0ZTogXCIxLTEtMjAyNFwiLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbWFyZ2luOiA1MCxcbiAgICAgICAgYmVhdFNjYWxlOiAxLFxuICAgICAgfVxuICAgICk7XG5cbiAgICAvLyBUZXN0IGRpZmZpY3VsdHkgYmFkZ2VcbiAgICB0aGlzLnJlbmRlckRpZmZpY3VsdHlCYWRnZShjYW52YXMsIDMsIFs1MCwgNTBdLCAxMDApO1xuICB9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiQUFpQk8sYUFBTSxxQkFBc0Q7QUFBQTtBQUFBLEVBRWpFLE9BQXdCLG1CQUFtQjtBQUFBLEVBQzNDLE9BQXdCLHNCQUFzQjtBQUFBLEVBQzlDLE9BQXdCLG1CQUFtQjtBQUFBO0FBQUEsRUFFM0MsT0FBd0Isd0JBQXdCO0FBQUEsRUFDaEQsT0FBd0IsMkJBQTJCO0FBQUEsRUFFbkQsT0FBd0IseUJBQXlCO0FBQUE7QUFBQSxFQUdqRCxPQUF3QixvQkFBb0I7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTTVDLGVBQ0UsUUFDQSxNQUNBLFNBQ007QUFDTixRQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssS0FBSyxHQUFHO0FBQ3pCO0FBQUEsSUFDRjtBQUVBLFVBQU0sTUFBTSxPQUFPLFdBQVcsSUFBSTtBQUNsQyxRQUFJLENBQUMsS0FBSztBQUNSLFlBQU0sSUFBSSxNQUFNLDhCQUE4QjtBQUFBLElBQ2hEO0FBR0EsUUFBSSxXQUFXLEtBQUs7QUFBQSxNQUNsQixxQkFBcUIsc0JBQXNCLFFBQVE7QUFBQSxJQUNyRDtBQUNBLFVBQU0sVUFBVSxLQUFLO0FBQUEsTUFDbkIscUJBQXFCLG9CQUFvQixRQUFRO0FBQUEsSUFDbkQ7QUFHQSxRQUFJLE9BQU8sS0FBSztBQUFBLE1BQ2QscUJBQXFCO0FBQUEsTUFDckI7QUFBQSxNQUNBLHFCQUFxQjtBQUFBLElBQ3ZCO0FBRUEsUUFBSSxPQUFPO0FBR1gsUUFBSSxZQUFZLEtB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
