import {
  MotionType,
  Orientation,
  RotationDirection,
  Location,
  MotionColor
} from "/src/lib/domain/enums.ts";
export class MotionParameterService {
  // Helper function to determine motion type based on start/end locations
  getMotionType(startLocation, endLocation) {
    const start = startLocation.toLowerCase();
    const end = endLocation.toLowerCase();
    if (start === end) {
      return MotionType.STATIC;
    }
    const opposites = [
      ["n", "s"],
      ["s", "n"],
      ["e", "w"],
      ["w", "e"]
    ];
    for (const [startOpp, endOpp] of opposites) {
      if (start === startOpp && end === endOpp) {
        return MotionType.DASH;
      }
    }
    return "pro";
  }
  // Helper function to get available motion types for a start/end pair
  getAvailableMotionTypes(startLocation, endLocation) {
    const motionType = this.getMotionType(startLocation, endLocation);
    if (motionType === "static") {
      return ["static"];
    } else if (motionType === "dash") {
      return ["dash"];
    } else {
      return ["pro", "anti", "float"];
    }
  }
  // Helper function to calculate rotation direction based on motion type and locations
  calculateRotationDirection(motionType, startLocation, endLocation) {
    const locationOrder = ["n", "e", "s", "w"];
    const startIndex = locationOrder.indexOf(startLocation.toLowerCase());
    const endIndex = locationOrder.indexOf(endLocation.toLowerCase());
    if (startIndex === -1 || endIndex === -1) {
      return "cw";
    }
    if (motionType === "static") {
      return "noRotation";
    }
    if (motionType === "dash") {
      return "noRotation";
    }
    const clockwiseDistance = (endIndex - startIndex + 4) % 4;
    const counterClockwiseDistance = (startIndex - endIndex + 4) % 4;
    const handPathIsClockwise = clockwiseDistance < counterClockwiseDistance;
    let result;
    if (motionType === "pro") {
      result = handPathIsClockwise ? "cw" : "ccw";
    } else if (motionType === "anti") {
      result = handPathIsClockwise ? "ccw" : "cw";
    } else {
      result = "cw";
    }
    console.log(
      `ðŸ”„ Rotation direction for ${startLocation}â†’${endLocation} (${motionType}): ${result}`
    );
    console.log(
      `   handPathIsClockwise: ${handPathIsClockwise}, clockwiseDistance: ${clockwiseDistance}, counterClockwiseDistance: ${counterClockwiseDistance}`
    );
    return result;
  }
  // Helper function to map string values to enum values
  mapMotionTypeToEnum(motionType) {
    switch (motionType.toLowerCase()) {
      case "pro":
        return MotionType.PRO;
      case "anti":
        return MotionType.ANTI;
      case "static":
        return MotionType.STATIC;
      case "dash":
        return MotionType.DASH;
      case "fl":
      case "float":
        return MotionType.FLOAT;
      default:
        return MotionType.PRO;
    }
  }
  mapOrientationToEnum(orientation) {
    switch (orientation.toLowerCase()) {
      case "in":
        return Orientation.IN;
      case "out":
        return Orientation.OUT;
      case "clock":
        return Orientation.CLOCK;
      case "counter":
        return Orientation.COUNTER;
      case "n":
        return Orientation.IN;
      // Map cardinal directions to in/out for now
      case "e":
        return Orientation.IN;
      case "s":
        return Orientation.IN;
      case "w":
        return Orientation.IN;
      default:
        return Orientation.IN;
    }
  }
  mapRotationDirectionToEnum(rotationDirection) {
    switch (rotationDirection.toLowerCase()) {
      case "cw":
      case "clockwise":
        return RotationDirection.CLOCKWISE;
      case "ccw":
      case "counter_clockwise":
      case "counterclockwise":
        return RotationDirection.COUNTER_CLOCKWISE;
      default:
        return RotationDirection.CLOCKWISE;
    }
  }
  mapLocationToEnum(location) {
    switch (location.toLowerCase()) {
      case "n":
        return Location.NORTH;
      case "e":
        return Location.EAST;
      case "s":
        return Location.SOUTH;
      case "w":
        return Location.WEST;
      case "ne":
        return Location.NORTHEAST;
      case "se":
        return Location.SOUTHEAST;
      case "sw":
        return Location.SOUTHWEST;
      case "nw":
        return Location.NORTHWEST;
      default:
        return Location.NORTH;
    }
  }
  // Helper function to convert MotionTestParams to PropAttributes
  convertMotionTestParamsToPropAttributes(params) {
    return {
      startLocation: params.startLocation,
      endLocation: params.endLocation,
      motionType: params.motionType,
      turns: params.turns,
      rotationDirection: params.rotationDirection,
      startOrientation: params.startOrientation,
      endOrientation: params.endOrientation
    };
  }
  // Create default motion parameters
  createDefaultParams() {
    return {
      startLocation: Location.NORTH,
      endLocation: Location.EAST,
      motionType: MotionType.PRO,
      turns: 0,
      rotationDirection: RotationDirection.CLOCKWISE,
      startOrientation: Orientation.IN,
      endOrientation: Orientation.IN
    };
  }
  // Update motion type when locations change
  updateMotionTypeForLocations(params) {
    const availableTypes = this.getAvailableMotionTypes(
      params.startLocation,
      params.endLocation
    );
    if (!availableTypes.includes(params.motionType)) {
      return {
        ...params,
        motionType: availableTypes[0]
      };
    }
    return params;
  }
  // Convert MotionTestParams to MotionData (moved from state layer)
  convertToMotionData(params) {
    return {
      motionType: this.mapMotionTypeToEnum(params.motionType),
      rotationDirection: this.mapRotationDirectionToEnum(
        params.rotationDirection
      ),
      startLocation: this.mapLocationToEnum(params.startLocation),
      endLocation: this.mapLocationToEnum(params.endLocation),
      turns: params.turns,
      startOrientation: this.mapOrientationToEnum(params.startOrientation),
      endOrientation: this.mapOrientationToEnum(params.endOrientation),
      isVisible: true,
      color: MotionColor.BLUE,
      // Default color for motion tester
      prefloatMotionType: null,
      prefloatRotationDirection: null
    };
  }
}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiQzovVEtBL3dlYi9zcmMvcm91dGVzL21vdGlvbi10ZXN0ZXIvc2VydmljZXMvTW90aW9uUGFyYW1ldGVyU2VydmljZS50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHtcbiAgTW90aW9uVHlwZSxcbiAgT3JpZW50YXRpb24sXG4gIFJvdGF0aW9uRGlyZWN0aW9uLFxuICBMb2NhdGlvbixcbiAgTW90aW9uQ29sb3IsXG59IGZyb20gXCIkbGliL2RvbWFpbi9lbnVtc1wiO1xuaW1wb3J0IHR5cGUgeyBNb3Rpb25EYXRhIH0gZnJvbSBcIiRsaWIvZG9tYWluL01vdGlvbkRhdGFcIjtcbmltcG9ydCB0eXBlIHsgSU1vdGlvblBhcmFtZXRlclNlcnZpY2UgfSBmcm9tIFwiLi9pbnRlcmZhY2VzXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTW90aW9uVGVzdFBhcmFtcyB7XG4gIHN0YXJ0TG9jYXRpb246IHN0cmluZztcbiAgZW5kTG9jYXRpb246IHN0cmluZztcbiAgbW90aW9uVHlwZTogc3RyaW5nO1xuICB0dXJuczogbnVtYmVyIHwgXCJmbFwiOyAvLyBTdXBwb3J0IGJvdGggbnVtZXJpYyB0dXJucyBhbmQgZmxvYXRcbiAgcm90YXRpb25EaXJlY3Rpb246IHN0cmluZztcbiAgc3RhcnRPcmllbnRhdGlvbjogc3RyaW5nO1xuICBlbmRPcmllbnRhdGlvbjogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgTW90aW9uUGFyYW1ldGVyU2VydmljZSBpbXBsZW1lbnRzIElNb3Rpb25QYXJhbWV0ZXJTZXJ2aWNlIHtcbiAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGRldGVybWluZSBtb3Rpb24gdHlwZSBiYXNlZCBvbiBzdGFydC9lbmQgbG9jYXRpb25zXG4gIGdldE1vdGlvblR5cGUoc3RhcnRMb2NhdGlvbjogc3RyaW5nLCBlbmRMb2NhdGlvbjogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyBOb3JtYWxpemUgdG8gbG93ZXJjYXNlIGZvciBjYXNlLWluc2Vuc2l0aXZlIGNvbXBhcmlzb25cbiAgICBjb25zdCBzdGFydCA9IHN0YXJ0TG9jYXRpb24udG9Mb3dlckNhc2UoKTtcbiAgICBjb25zdCBlbmQgPSBlbmRMb2NhdGlvbi50b0xvd2VyQ2FzZSgpO1xuXG4gICAgaWYgKHN0YXJ0ID09PSBlbmQpIHtcbiAgICAgIHJldHVybiBNb3Rpb25UeXBlLlNUQVRJQzsgLy8gU2FtZSBsb2NhdGlvbiA9IHN0YXRpY1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIGl0J3MgYSBkYXNoIG1vdGlvbiAob3Bwb3NpdGUgbG9jYXRpb25zKVxuICAgIGNvbnN0IG9wcG9zaXRlcyA9IFtcbiAgICAgIFtcIm5cIiwgXCJzXCJdLFxuICAgICAgW1wic1wiLCBcIm5cIl0sXG4gICAgICBbXCJlXCIsIFwid1wiXSxcbiAgICAgIFtcIndcIiwgXCJlXCJdLFxuICAgIF07XG5cbiAgICBmb3IgKGNvbnN0IFtzdGFydE9wcCwgZW5kT3BwXSBvZiBvcHBvc2l0ZXMpIHtcbiAgICAgIGlmIChzdGFydCA9PT0gc3RhcnRPcHAgJiYgZW5kID09PSBlbmRPcHApIHtcbiAgICAgICAgcmV0dXJuIE1vdGlvblR5cGUuREFTSDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBZGphY2VudCBsb2NhdGlvbnMgPSBzaGlmdCBtb3Rpb24gKHByby9hbnRpL2Zsb2F0KVxuICAgIHJldHVybiBcInByb1wiOyAvLyBUT0RPIC0gZml4IHRoaXMgc28gaXQgYWN0dWFsbHkgcmVjZWl2ZXMgdGhlIHJlYWwgaW5mbyByZXF1aXJlZCB0byBnZXQgdGhlIG1vdGlvbiB0eXBlLCBwcm8gYXMgZGVmYXVsdCBpcyBiYWRcbiAgfVxuXG4gIC8vIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgYXZhaWxhYmxlIG1vdGlvbiB0eXBlcyBmb3IgYSBzdGFydC9lbmQgcGFpclxuICBnZXRBdmFpbGFibGVNb3Rpb25UeXBlcyhcbiAgICBzdGFydExvY2F0aW9uOiBzdHJpbmcsXG4gICAgZW5kTG9jYXRpb246IHN0cmluZ1xuICApOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgbW90aW9uVHlwZSA9IHRoaXMuZ2V0TW90aW9uVHlwZShzdGFydExvY2F0aW9uLCBlbmRMb2NhdGlvbik7XG5cbiAgICBpZiAobW90aW9uVHlwZSA9PT0gXCJzdGF0aWNcIikge1xuICAgICAgcmV0dXJuIFtcInN0YXRpY1wiXTtcbiAgICB9IGVsc2UgaWYgKG1vdGlvblR5cGUgPT09IFwiZGFzaFwiKSB7XG4gICAgICByZXR1cm4gW1wiZGFzaFwiXTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gU2hpZnQgbW90aW9ucyBjYW4gYmUgcHJvLCBhbnRpLCBvciBmbG9hdFxuICAgICAgcmV0dXJuIFtcInByb1wiLCBcImFudGlcIiwgXCJmbG9hdFwiXTtcbiAgICB9XG4gIH1cblxuICAvLyBIZWxwZXIgZnVuY3Rpb24gdG8gY2FsY3VsYXRlIHJvdGF0aW9uIGRpcmVjdGlvbiBiYXNlZCBvbiBtb3Rpb24gdHlwZSBhbmQgbG9jYXRpb25zXG4gIGNhbGN1bGF0ZVJvdGF0aW9uRGlyZWN0aW9uKFxuICAgIG1vdGlvblR5cGU6IHN0cmluZyxcbiAgICBzdGFydExvY2F0aW9uOiBzdHJpbmcsXG4gICAgZW5kTG9jYXRpb246IHN0cmluZ1xuICApOiBzdHJpbmcge1xuICAgIC8vIExvY2F0aW9uIG9yZGVyIGZvciBjbG9ja3dpc2UgbW92ZW1lbnQ6IG4gLT4gZSAtPiBzIC0+IHcgLT4gblxuICAgIGNvbnN0IGxvY2F0aW9uT3JkZXIgPSBbXCJuXCIsIFwiZVwiLCBcInNcIiwgXCJ3XCJdO1xuICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBsb2NhdGlvbk9yZGVyLmluZGV4T2Yoc3RhcnRMb2NhdGlvbi50b0xvd2VyQ2FzZSgpKTtcbiAgICBjb25zdCBlbmRJbmRleCA9IGxvY2F0aW9uT3JkZXIuaW5kZXhPZihlbmRMb2NhdGlvbi50b0xvd2VyQ2FzZSgpKTtcblxuICAgIGlmIChzdGFydEluZGV4ID09PSAtMSB8fCBlbmRJbmRleCA9PT0gLTEpIHtcbiAgICAgIHJldHVybiBcImN3XCI7IC8vIERlZmF1bHQgdG8gY2xvY2t3aXNlIGZvciB1bmtub3duIGxvY2F0aW9uc1xuICAgIH1cblxuICAgIC8vIEZvciBzdGF0aWMgbW90aW9ucywgbm8gcm90YXRpb25cbiAgICBpZiAobW90aW9uVHlwZSA9PT0gXCJzdGF0aWNcIikge1xuICAgICAgcmV0dXJuIFwibm9Sb3RhdGlvblwiO1xuICAgIH1cblxuICAgIC8vIEZvciBkYXNoIG1vdGlvbnMsIHR5cGljYWxseSBubyByb3RhdGlvbiB1bmxlc3Mgc3BlY2lmaWVkXG4gICAgaWYgKG1vdGlvblR5cGUgPT09IFwiZGFzaFwiKSB7XG4gICAgICByZXR1cm4gXCJub1JvdGF0aW9uXCI7XG4gICAgfVxuXG4gICAgLy8gQ2FsY3VsYXRlIHRoZSBoYW5kIHBhdGggZGlyZWN0aW9uIChjbG9ja3dpc2Ugb3IgY291bnRlcmNsb2Nrd2lzZSlcbiAgICBjb25zdCBjbG9ja3dpc2VEaXN0YW5jZSA9IChlbmRJbmRleCAtIHN0YXJ0SW5kZXggKyA0KSAlIDQ7XG4gICAgY29uc3QgY291bnRlckNsb2Nrd2lzZURpc3RhbmNlID0gKHN0YXJ0SW5kZXggLSBlbmRJbmRleCArIDQpICUgNDtcblxuICAgIC8vIERldGVybWluZSBoYW5kIHBhdGggZGlyZWN0aW9uIChzaG9ydGVyIGRpc3RhbmNlIHdpbnMpXG4gICAgY29uc3QgaGFuZFBhdGhJc0Nsb2Nrd2lzZSA9IGNsb2Nrd2lzZURpc3RhbmNlIDwgY291bnRlckNsb2Nrd2lzZURpc3RhbmNlO1xuXG4gICAgLy8gRm9yIFBSTzogcHJvcCByb3RhdGlvbiBtYXRjaGVzIGhhbmQgcGF0aCBkaXJlY3Rpb25cbiAgICAvLyBGb3IgQU5USTogcHJvcCByb3RhdGlvbiBvcHBvc2VzIGhhbmQgcGF0aCBkaXJlY3Rpb25cbiAgICBsZXQgcmVzdWx0O1xuICAgIGlmIChtb3Rpb25UeXBlID09PSBcInByb1wiKSB7XG4gICAgICByZXN1bHQgPSBoYW5kUGF0aElzQ2xvY2t3aXNlID8gXCJjd1wiIDogXCJjY3dcIjtcbiAgICB9IGVsc2UgaWYgKG1vdGlvblR5cGUgPT09IFwiYW50aVwiKSB7XG4gICAgICByZXN1bHQgPSBoYW5kUGF0aElzQ2xvY2t3aXNlID8gXCJjY3dcIiA6IFwiY3dcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0ID0gXCJjd1wiOyAvLyBEZWZhdWx0IGZvciBvdGhlciBtb3Rpb24gdHlwZXNcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhcbiAgICAgIGDwn5SEIFJvdGF0aW9uIGRpcmVjdGlvbiBmb3IgJHtzdGFydExvY2F0aW9ufeKGkiR7ZW5kTG9jYXRpb259ICgke21vdGlvblR5cGV9KTogJHtyZXN1bHR9YFxuICAgICk7XG4gICAgY29uc29sZS5sb2coXG4gICAgICBgICAgaGFuZFBhdGhJc0Nsb2Nrd2lzZTogJHtoYW5kUGF0aElzQ2xvY2t3aXNlfSwgY2xvY2t3aXNlRGlzdGFuY2U6ICR7Y2xvY2t3aXNlRGlzdGFuY2V9LCBjb3VudGVyQ2xvY2t3aXNlRGlzdGFuY2U6ICR7Y291bnRlckNsb2Nrd2lzZURpc3RhbmNlfWBcbiAgICApO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8vIEhlbHBlciBmdW5jdGlvbiB0byBtYXAgc3RyaW5nIHZhbHVlcyB0byBlbnVtIHZhbHVlc1xuICBtYXBNb3Rpb25UeXBlVG9FbnVtKG1vdGlvblR5cGU6IHN0cmluZyk6IE1vdGlvblR5cGUge1xuICAgIHN3aXRjaCAobW90aW9uVHlwZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICBjYXNlIFwicHJvXCI6XG4gICAgICAgIHJldHVybiBNb3Rpb25UeXBlLlBSTztcbiAgICAgIGNhc2UgXCJhbnRpXCI6XG4gICAgICAgIHJldHVybiBNb3Rpb25UeXBlLkFOVEk7XG4gICAgICBjYXNlIFwic3RhdGljXCI6XG4gICAgICAgIHJldHVybiBNb3Rpb25UeXBlLlNUQVRJQztcbiAgICAgIGNhc2UgXCJkYXNoXCI6XG4gICAgICAgIHJldHVybiBNb3Rpb25UeXBlLkRBU0g7XG4gICAgICBjYXNlIFwiZmxcIjpcbiAgICAgIGNhc2UgXCJmbG9hdFwiOlxuICAgICAgICByZXR1cm4gTW90aW9uVHlwZS5GTE9BVDtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBNb3Rpb25UeXBlLlBSTztcbiAgICB9XG4gIH1cblxuICBtYXBPcmllbnRhdGlvblRvRW51bShvcmllbnRhdGlvbjogc3RyaW5nKTogT3JpZW50YXRpb24ge1xuICAgIHN3aXRjaCAob3JpZW50YXRpb24udG9Mb3dlckNhc2UoKSkge1xuICAgICAgY2FzZSBcImluXCI6XG4gICAgICAgIHJldHVybiBPcmllbnRhdGlvbi5JTjtcbiAgICAgIGNhc2UgXCJvdXRcIjpcbiAgICAgICAgcmV0dXJuIE9yaWVudGF0aW9uLk9VVDtcbiAgICAgIGNhc2UgXCJjbG9ja1wiOlxuICAgICAgICByZXR1cm4gT3JpZW50YXRpb24uQ0xPQ0s7XG4gICAgICBjYXNlIFwiY291bnRlclwiOlxuICAgICAgICByZXR1cm4gT3JpZW50YXRpb24uQ09VTlRFUjtcbiAgICAgIGNhc2UgXCJuXCI6XG4gICAgICAgIHJldHVybiBPcmllbnRhdGlvbi5JTjsgLy8gTWFwIGNhcmRpbmFsIGRpcmVjdGlvbnMgdG8gaW4vb3V0IGZvciBub3dcbiAgICAgIGNhc2UgXCJlXCI6XG4gICAgICAgIHJldHVybiBPcmllbnRhdGlvbi5JTjtcbiAgICAgIGNhc2UgXCJzXCI6XG4gICAgICAgIHJldHVybiBPcmllbnRhdGlvbi5JTjtcbiAgICAgIGNhc2UgXCJ3XCI6XG4gICAgICAgIHJldHVybiBPcmllbnRhdGlvbi5JTjtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBPcmllbnRhdGlvbi5JTjtcbiAgICB9XG4gIH1cblxuICBtYXBSb3RhdGlvbkRpcmVjdGlvblRvRW51bShyb3RhdGlvbkRpcmVjdGlvbjogc3RyaW5nKTogUm90YXRpb25EaXJlY3Rpb24ge1xuICAgIHN3aXRjaCAocm90YXRpb25EaXJlY3Rpb24udG9Mb3dlckNhc2UoKSkge1xuICAgICAgY2FzZSBcImN3XCI6XG4gICAgICBjYXNlIFwiY2xvY2t3aXNlXCI6XG4gICAgICAgIHJldHVybiBSb3RhdGlvbkRpcmVjdGlvbi5DTE9DS1dJU0U7XG4gICAgICBjYXNlIFwiY2N3XCI6XG4gICAgICBjYXNlIFwiY291bnRlcl9jbG9ja3dpc2VcIjpcbiAgICAgIGNhc2UgXCJjb3VudGVyY2xvY2t3aXNlXCI6XG4gICAgICAgIHJldHVybiBSb3RhdGlvbkRpcmVjdGlvbi5DT1VOVEVSX0NMT0NLV0lTRTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBSb3RhdGlvbkRpcmVjdGlvbi5DTE9DS1dJU0U7XG4gICAgfVxuICB9XG5cbiAgbWFwTG9jYXRpb25Ub0VudW0obG9jYXRpb246IHN0cmluZyk6IExvY2F0aW9uIHtcbiAgICBzd2l0Y2ggKGxvY2F0aW9uLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgIGNhc2UgXCJuXCI6XG4gICAgICAgIHJldHVybiBMb2NhdGlvbi5OT1JUSDtcbiAgICAgIGNhc2UgXCJlXCI6XG4gICAgICAgIHJldHVybiBMb2NhdGlvbi5FQVNUO1xuICAgICAgY2FzZSBcInNcIjpcbiAgICAgICAgcmV0dXJuIExvY2F0aW9uLlNPVVRIO1xuICAgICAgY2FzZSBcIndcIjpcbiAgICAgICAgcmV0dXJuIExvY2F0aW9uLldFU1Q7XG4gICAgICBjYXNlIFwibmVcIjpcbiAgICAgICAgcmV0dXJuIExvY2F0aW9uLk5PUlRIRUFTVDtcbiAgICAgIGNhc2UgXCJzZVwiOlxuICAgICAgICByZXR1cm4gTG9jYXRpb24uU09VVEhFQVNUO1xuICAgICAgY2FzZSBcInN3XCI6XG4gICAgICAgIHJldHVybiBMb2NhdGlvbi5TT1VUSFdFU1Q7XG4gICAgICBjYXNlIFwibndcIjpcbiAgICAgICAgcmV0dXJuIExvY2F0aW9uLk5PUlRIV0VTVDtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBMb2NhdGlvbi5OT1JUSDtcbiAgICB9XG4gIH1cblxuICAvLyBIZWxwZXIgZnVuY3Rpb24gdG8gY29udmVydCBNb3Rpb25UZXN0UGFyYW1zIHRvIFByb3BBdHRyaWJ1dGVzXG4gIGNvbnZlcnRNb3Rpb25UZXN0UGFyYW1zVG9Qcm9wQXR0cmlidXRlcyhwYXJhbXM6IE1vdGlvblRlc3RQYXJhbXMpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3RhcnRMb2NhdGlvbjogcGFyYW1zLnN0YXJ0TG9jYXRpb24sXG4gICAgICBlbmRMb2NhdGlvbjogcGFyYW1zLmVuZExvY2F0aW9uLFxuICAgICAgbW90aW9uVHlwZTogcGFyYW1zLm1vdGlvblR5cGUgYXMgTW90aW9uVHlwZSxcbiAgICAgIHR1cm5zOiBwYXJhbXMudHVybnMsXG4gICAgICByb3RhdGlvbkRpcmVjdGlvbjogcGFyYW1zLnJvdGF0aW9uRGlyZWN0aW9uIGFzIFJvdGF0aW9uRGlyZWN0aW9uLFxuICAgICAgc3RhcnRPcmllbnRhdGlvbjogcGFyYW1zLnN0YXJ0T3JpZW50YXRpb24gYXMgT3JpZW50YXRpb24sXG4gICAgICBlbmRPcmllbnRhdGlvbjogcGFyYW1zLmVuZE9yaWVudGF0aW9uIGFzIE9yaWVudGF0aW9uLFxuICAgIH07XG4gIH1cblxuICAvLyBDcmVhdGUgZGVmYXVsdCBtb3Rpb24gcGFyYW1ldGVyc1xuICBjcmVhdGVEZWZhdWx0UGFyYW1zKCk6IE1vdGlvblRlc3RQYXJhbXMge1xuICAgIHJldHVybiB7XG4gICAgICBzdGFydExvY2F0aW9uOiBMb2NhdGlvbi5OT1JUSCxcbiAgICAgIGVuZExvY2F0aW9uOiBMb2NhdGlvbi5FQVNULFxuICAgICAgbW90aW9uVHlwZTogTW90aW9uVHlwZS5QUk8sXG4gICAgICB0dXJuczogMCxcbiAgICAgIHJvdGF0aW9uRGlyZWN0aW9uOiBSb3RhdGlvbkRpcmVjdGlvbi5DTE9DS1dJU0UsXG4gICAgICBzdGFydE9yaWVudGF0aW9uOiBPcmllbnRhdGlvbi5JTixcbiAgICAgIGVuZE9yaWVudGF0aW9uOiBPcmllbnRhdGlvbi5JTixcbiAgICB9O1xuICB9XG5cbiAgLy8gVXBkYXRlIG1vdGlvbiB0eXBlIHdoZW4gbG9jYXRpb25zIGNoYW5nZVxuICB1cGRhdGVNb3Rpb25UeXBlRm9yTG9jYXRpb25zKHBhcmFtczogTW90aW9uVGVzdFBhcmFtcyk6IE1vdGlvblRlc3RQYXJhbXMge1xuICAgIGNvbnN0IGF2YWlsYWJsZVR5cGVzID0gdGhpcy5nZXRBdmFpbGFibGVNb3Rpb25UeXBlcyhcbiAgICAgIHBhcmFtcy5zdGFydExvY2F0aW9uLFxuICAgICAgcGFyYW1zLmVuZExvY2F0aW9uXG4gICAgKTtcblxuICAgIC8vIElmIGN1cnJlbnQgbW90aW9uIHR5cGUgaXMgbm90IGF2YWlsYWJsZSwgc3dpdGNoIHRvIHRoZSBmaXJzdCBhdmFpbGFibGVcbiAgICBpZiAoIWF2YWlsYWJsZVR5cGVzLmluY2x1ZGVzKHBhcmFtcy5tb3Rpb25UeXBlKSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4ucGFyYW1zLFxuICAgICAgICBtb3Rpb25UeXBlOiBhdmFpbGFibGVUeXBlc1swXSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhcmFtcztcbiAgfVxuXG4gIC8vIENvbnZlcnQgTW90aW9uVGVzdFBhcmFtcyB0byBNb3Rpb25EYXRhIChtb3ZlZCBmcm9tIHN0YXRlIGxheWVyKVxuICBjb252ZXJ0VG9Nb3Rpb25EYXRhKHBhcmFtczogTW90aW9uVGVzdFBhcmFtcyk6IE1vdGlvbkRhdGEge1xuICAgIHJldHVybiB7XG4gICAgICBtb3Rpb25UeXBlOiB0aGlzLm1hcE1vdGlvblR5cGVUb0VudW0ocGFyYW1zLm1vdGlvblR5cGUpLFxuICAgICAgcm90YXRpb25EaXJlY3Rpb246IHRoaXMubWFwUm90YXRpb25EaXJlY3Rpb25Ub0VudW0oXG4gICAgICAgIHBhcmFtcy5yb3RhdGlvbkRpcmVjdGlvblxuICAgICAgKSxcbiAgICAgIHN0YXJ0TG9jYXRpb246IHRoaXMubWFwTG9jYXRpb25Ub0VudW0ocGFyYW1zLnN0YXJ0TG9jYXRpb24pLFxuICAgICAgZW5kTG9jYXRpb246IHRoaXMubWFwTG9jYXRpb25Ub0VudW0ocGFyYW1zLmVuZExvY2F0aW9uKSxcbiAgICAgIHR1cm5zOiBwYXJhbXMudHVybnMsXG4gICAgICBzdGFydE9yaWVudGF0aW9uOiB0aGlzLm1hcE9yaWVudGF0aW9uVG9FbnVtKHBhcmFtcy5zdGFydE9yaWVudGF0aW9uKSxcbiAgICAgIGVuZE9yaWVudGF0aW9uOiB0aGlzLm1hcE9yaWVudGF0aW9uVG9FbnVtKHBhcmFtcy5lbmRPcmllbnRhdGlvbiksXG4gICAgICBpc1Zpc2libGU6IHRydWUsXG4gICAgICBjb2xvcjogTW90aW9uQ29sb3IuQkxVRSwgLy8gRGVmYXVsdCBjb2xvciBmb3IgbW90aW9uIHRlc3RlclxuICAgICAgcHJlZmxvYXRNb3Rpb25UeXBlOiBudWxsLFxuICAgICAgcHJlZmxvYXRSb3RhdGlvbkRpcmVjdGlvbjogbnVsbCxcbiAgICB9O1xuICB9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiQUFBQTtBQUFBLEVBQ0U7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsT0FDSztBQWNBLGFBQU0sdUJBQTBEO0FBQUE7QUFBQSxFQUVyRSxjQUFjLGVBQXVCLGFBQTZCO0FBRWhFLFVBQU0sUUFBUSxjQUFjLFlBQVk7QUFDeEMsVUFBTSxNQUFNLFlBQVksWUFBWTtBQUVwQyxRQUFJLFVBQVUsS0FBSztBQUNqQixhQUFPLFdBQVc7QUFBQSxJQUNwQjtBQUdBLFVBQU0sWUFBWTtBQUFBLE1BQ2hCLENBQUMsS0FBSyxHQUFHO0FBQUEsTUFDVCxDQUFDLEtBQUssR0FBRztBQUFBLE1BQ1QsQ0FBQyxLQUFLLEdBQUc7QUFBQSxNQUNULENBQUMsS0FBSyxHQUFHO0FBQUEsSUFDWDtBQUVBLGVBQVcsQ0FBQyxVQUFVLE1BQU0sS0FBSyxXQUFXO0FBQzFDLFVBQUksVUFBVSxZQUFZLFFBQVEsUUFBUTtBQUN4QyxlQUFPLFdBQVc7QUFBQSxNQUNwQjtBQUFBLElBQ0Y7QUFHQSxXQUFPO0FBQUEsRUFDVDtBQUFBO0FBQUEs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
