# Cursor Rules - TKA Studio

## Environment & Release Management

### Auto-Context Detection

Cursor should automatically understand when you're in:

**Development Mode** (default):
- Working in VSCode
- Editing code, building features
- All modules accessible
- Use `.env.local` with development settings

**Release Mode** (explicit):
- User types `/release`
- User says "push to production"
- Run: `node scripts/release-to-production.js`

### Smart Commands

```bash
# Environment checks
/check-env     → node scripts/check-environment.js
/dev           → node scripts/switch-environment.js dev
/prod          → node scripts/switch-environment.js prod
/release       → node scripts/release-to-production.js
/fb            → node scripts/feedback-workflow.js
```

### Two-Layer Access System

1. **Environment**: Production (limited) vs Development (full)
2. **Role**: User/Tester/Admin permissions

Code visibility: `Environment visibility AND Role permission`

### Development Workflow

**When building features:**
- Assume all modules are accessible
- Don't add production checks in component code
- Let `FeatureFlagService` handle access control
- Use full development environment

**When releasing:**
- Use `/release` command
- Update netlify.toml production settings
- Create PR or push to main
- Verify on production

### Git Integration

Hooks manage environment automatically:
- `post-checkout`: Updates .env.local on branch switch
- `pre-commit`: Warns on production branches

### Quick Reference

**Module Status:**
- Released: Dashboard, Create, Discover, Feedback
- Unreleased: Learn, Library, Compose, Train, ML Training

**File Locations:**
- Config: `netlify.toml`
- Scripts: `scripts/release-to-production.js`
- Docs: `docs/PRODUCTION-RELEASE-WORKFLOW.md`

### Default Assumptions

Unless explicitly told otherwise:
- User is developing (not releasing)
- All features should work
- Development environment active
- No production restrictions needed

### When User Says:

- "Build this" → Dev mode
- "Add feature" → Dev mode
- "Fix bug" → Dev mode
- "/release" → Release mode
- "Push live" → Release mode
- "Make public" → Release mode

### Integration

Works with:
- VSCode tasks (Cmd+Shift+P → Tasks)
- Git hooks (automatic)
- Firebase Admin (release script)
- Netlify (auto-deploy)

Use appropriate tools during release workflow.
